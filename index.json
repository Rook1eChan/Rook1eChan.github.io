[{"content":"","permalink":"https://Rook1eChan.github.io/posts/cs336/lec1/","summary":"","title":"cs336 Lec1"},{"content":"minbpeï¼šBPEç®—æ³•çš„æç®€å®ç° github åœ°å€ï¼škarpathy/minbpe\n1.BPE ç®—æ³• BPE(Byte Pair Encoding) æ˜¯å¤§æ¨¡å‹çš„ tokenizer å¸¸ç”¨çš„ç®—æ³•ã€‚å®ƒå¯¹è¾“å…¥æ–‡æœ¬çš„å­—èŠ‚è¿›è¡Œç¼–ç ã€‚\nè¯¥ç®—æ³•å›  GPT-2 çš„è®ºæ–‡å’Œä»£ç è€Œè¢«å¹¿æ³›ä½¿ç”¨äº LLMã€‚Sennrich et al. 2015è¢«è®¤ä¸ºæ˜¯ BPE åœ¨ NLP åº”ç”¨ä¸­çš„åŸå§‹å‚è€ƒã€‚\nç®€å•æ¥è¯´ï¼Œbpe æŠŠæ–‡æœ¬çœ‹ä½œ utf-8 ç¼–ç çš„å­—èŠ‚ï¼Œç„¶åå°†å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç›¸é‚»å­—èŠ‚åˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ç¼–ç ã€‚å¦‚æ­¤åå¤æ“ä½œã€‚\n2.minbpe ç®€ä»‹ 2.1quickstart from minbpe import BasicTokenizer tokenizer = BasicTokenizer() text = \u0026#34;aaabdaaabac\u0026#34; # è®­ç»ƒ tokenizer.train(text, 256 + 3) # 256tokens, 3merges # ç¼–ç  print(tokenizer.encode(text)) # è§£ç  print(tokenizer.decode([258, 100, 258, 97, 99])) # ä¿å­˜ tokenizer.save(\u0026#34;toy\u0026#34;) # writes two files: toy.model (for loading) and toy.vocab (for viewing) è‹±è¯­å­—æ¯ä¸€ä¸ªå­—æ¯å¯¹åº”ä¸€ä¸ªå­—èŠ‚ã€‚å¯¹äº\u0026quot;aaabdaaabac\u0026quot;ï¼Œå…ˆè®¡ç®—ç›¸é‚»ä¸¤å­—èŠ‚çš„å‡ºç°æ¬¡æ•°ï¼Œç„¶åé€‰æ‹©æ¬¡æ•°æœ€å¤šçš„è¿›è¡Œåˆå¹¶ï¼ˆâ€œaaâ€ï¼Œ4æ¬¡ï¼‰ã€‚\nâ€œaâ€â€œaâ€åˆå¹¶ä¸ºâ€œaaâ€ï¼Œç¼–ç ä¸º256ã€‚\nç„¶åå†è®¡ç®—ç›¸é‚»ä¸¤å­—èŠ‚çš„å‡ºç°æ¬¡æ•°ï¼Œå†åˆå¹¶ã€‚\nåœ¨ toy.vocab ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰å­—ç¬¦åŠå¯¹åº”çš„ç¼–ç ã€‚\ntoy.vocab ...... [a][a] -\u0026gt; [aa] 256 [aa][a] -\u0026gt; [aaa] 257 [aaa][b] -\u0026gt; [aaab] 258 2.2minbpeå’ŒGPT-4åˆ†è¯å™¨åŠŸèƒ½ç›¸åŒ # 1.è¯æ˜RegexTokenizerä¸GPT-4çš„åˆ†è¯å™¨æ€§èƒ½ä¸€è‡´ text = \u0026#34;hello123!!!? (ì•ˆë…•í•˜ì„¸ìš”!) ğŸ˜‰\u0026#34; # pip install tiktoken import tiktoken enc = tiktoken.get_encoding(\u0026#34;cl100k_base\u0026#34;) print(enc.encode(text)) # [15339, 4513, 12340, 30, 320, 31495, 230, 75265, 243, 92245, 16715, 57037] from minbpe import GPT4Tokenizer tokenizer = GPT4Tokenizer() print(tokenizer.encode(text)) # [15339, 4513, 12340, 30, 320, 31495, 230, 75265, 243, 92245, 16715, 57037] # 2.æ ‡è®°ç‰¹æ®Štoken text = \u0026#34;\u0026lt;|endoftext|\u0026gt;hello world\u0026#34; print(enc.encode(text, allowed_special=\u0026#34;all\u0026#34;)) # [100257, 15339, 1917] # ours print(tokenizer.encode(text, allowed_special=\u0026#34;all\u0026#34;)) # [100257, 15339, 1917] è°ƒç”¨ encode æ—¶å¿…é¡»æ˜¾ç¤ºå£°æ˜å¤„ç†ç‰¹æ®Šæ ‡è®°ã€‚allowed_special å‚æ•°å¯ä»¥è®¾ç½®ä¸º\u0026quot;all\u0026quot;ã€\u0026ldquo;none\u0026quot;æˆ–ä¸€ä¸ªç‰¹æ®Štokenåˆ—è¡¨ã€‚\né˜²æ­¢æ¶æ„æ³¨å…¥ é£é™©ç‰¹æ®Šä»¤ç‰Œï¼ˆå¦‚\u0026lt;|endoftext|\u0026gt;ã€\u0026lt;|user|\u0026gt;ç­‰ï¼‰é€šå¸¸åœ¨æ¨¡å‹ä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼ˆå¦‚ç»ˆæ­¢åºåˆ—ã€è§’è‰²åŒºåˆ†ï¼‰ã€‚å¦‚æœåˆ†è¯å™¨é»˜è®¤è§£æç”¨æˆ·è¾“å…¥ä¸­çš„ç‰¹æ®Šä»¤ç‰Œï¼Œæ”»å‡»è€…å¯èƒ½ä¼šåœ¨ç”¨æˆ·è¾“å…¥ä¸­æ¶æ„æ’å…¥è¿™äº›ä»¤ç‰Œï¼Œè¯±å¯¼æ¨¡å‹æ‰§è¡Œéé¢„æœŸè¡Œä¸ºï¼ˆä¾‹å¦‚æå‰ç»ˆæ­¢ç”Ÿæˆã€åˆ‡æ¢è§’è‰²ï¼‰ã€‚æ˜¾å¼å£°æ˜allowed_specialå‚æ•°ï¼ˆå¦‚é™åˆ¶ä¸º \u0026#34;none\u0026#34; æˆ–æŒ‡å®šå®‰å…¨åˆ—è¡¨ï¼‰ï¼Œå¯ä»¥é¿å…å°†ç”¨æˆ·å¯æ§æ•°æ®ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¯¯è§£æä¸ºåŠŸèƒ½æ€§ä»¤ç‰Œï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ç§è¾“å…¥éªŒè¯æœºåˆ¶ã€‚ é¿å…æ„å¤–çš„è¯­ä¹‰å¹²æ‰° å³ä½¿æ²¡æœ‰æ¶æ„æ”»å‡»ï¼Œç”¨æˆ·è¾“å…¥ä¸­ä¹Ÿå¯èƒ½åŒ…å«ä¸ç‰¹æ®Šä»¤ç‰Œç›¸åŒçš„å­—ç¬¦ä¸²ï¼ˆä¾‹å¦‚è‡ªç„¶æ–‡æœ¬ä¸­æ°å¥½å‡ºç°\u0026lt;|end|\u0026gt;ï¼‰ã€‚å¦‚æœåˆ†è¯å™¨é»˜è®¤è§£æè¿™äº›å­—ç¬¦ä¸²ä¸ºç‰¹æ®Šä»¤ç‰Œï¼Œä¼šç ´ååŸå§‹æ–‡æœ¬çš„è¯­ä¹‰ï¼Œå¯¼è‡´æ¨¡å‹å¤„ç†å‡ºé”™ï¼ˆå¦‚é”™è¯¯æˆªæ–­ã€è§’è‰²æ··æ·†ï¼‰ã€‚é€šè¿‡æ˜¾å¼æ§åˆ¶ï¼Œå¼€å‘è€…å¯ä»¥ç¡®ä¿åªæœ‰é¢„æœŸçš„ç‰¹æ®Šä»¤ç‰Œè¢«è§£æï¼Œå…¶ä»–ç±»ä¼¼å­—ç¬¦ä¸²ä»…ä½œä¸ºæ™®é€šæ–‡æœ¬å¤„ç†ã€‚ 3.è®­ç»ƒ minbpe å¯ä»¥åœ¨è¯­æ–™ä¸Šè®­ç»ƒè‡ªå·±çš„åˆ†è¯å™¨ã€‚\n# ä»¿ç…§openaiï¼Œä½¿ç”¨æ­£åˆ™æ–¹æ³•æ¥æ‹†åˆ†æ–‡æœ¬ from minbpe import RegexTokenizer tokenizer = RegexTokenizer() tokenizer.train(very_long_training_string, vocab_size=32768) tokenizer.encode(\u0026#34;hello world\u0026#34;) # string -\u0026gt; tokens tokenizer.decode([1000, 2000, 3000]) # tokens -\u0026gt; string tokenizer.save(\u0026#34;tok32k\u0026#34;) # writes tok32k.model and tok32k.vocab tokenizer.load(\u0026#34;tok32k.model\u0026#34;) # loads the model back from disk å¦‚æœè¦æ·»åŠ special tokensï¼š\n# å‰256ä¸ºåŸå§‹å­—èŠ‚tokenï¼Œæ¥ä¸‹æ¥32768-256ä¸ºåˆå¹¶çš„tokenï¼Œåé¢çš„32768æ˜¯ç‰¹æ®Štoken from minbpe import RegexTokenizer tokenizer = RegexTokenizer() tokenizer.train(very_long_training_string, vocab_size=32768) tokenizer.register_special_tokens({\u0026#34;\u0026lt;|endoftext|\u0026gt;\u0026#34;: 32768}) tokenizer.encode(\u0026#34;\u0026lt;|endoftext|\u0026gt;hello world\u0026#34;, allowed_special=\u0026#34;all\u0026#34;) 3.é¡¹ç›®è§£æ 3.1é¡¹ç›®ç»“æ„ é¡¹ç›®ä¸­æœ‰ä¸¤ä¸ªåˆ†è¯å™¨ï¼Œå®ƒä»¬éƒ½å¯ä»¥æ‰§è¡Œåˆ†è¯å™¨çš„ä¸‰ä¸ªä¸»è¦åŠŸèƒ½ï¼š1ï¼‰åœ¨ç»™å®šæ–‡æœ¬ä¸Šè®­ç»ƒåˆ†è¯å™¨è¯æ±‡å¹¶æ‰§è¡Œåˆå¹¶ï¼Œ2ï¼‰å°†æ–‡æœ¬ç¼–ç ä¸ºtokensï¼Œ3ï¼‰å°†tokensè§£ç ä¸ºæ–‡æœ¬ã€‚ä»“åº“çš„æ–‡ä»¶å¦‚ä¸‹ï¼š\nminbpe/base.py: å®ç°äº† Tokenizer ç±»ï¼Œå®ƒæ˜¯åŸºç¡€ç±»ã€‚å®ƒåŒ…å« train ã€ encode å’Œ decode ã€save/loadåŠŸèƒ½ï¼Œè¿˜æœ‰ä¸€äº›å¸¸è§çš„å·¥å…·å‡½æ•°ã€‚è¿™ä¸ªç±»ä¸æ˜¯ç›´æ¥ä½¿ç”¨çš„ï¼Œè€Œæ˜¯ç”¨æ¥ç»§æ‰¿çš„ã€‚ minbpe/basic.py: å®ç°äº† BasicTokenizer ï¼Œè¿™æ˜¯ BPE ç®—æ³•æœ€ç®€å•çš„å®ç°ï¼Œç›´æ¥åœ¨æ–‡æœ¬ä¸Šè¿è¡Œã€‚ minbpe/regex.py: å®ç°äº† RegexTokenizer ï¼Œé€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼è¿›ä¸€æ­¥åˆ†å‰²è¾“å…¥æ–‡æœ¬ï¼Œè¿™æ˜¯ä¸€ä¸ªé¢„å¤„ç†é˜¶æ®µï¼Œåœ¨åˆ†è¯ä¹‹å‰æŒ‰ç±»åˆ«åˆ†å‰²è¾“å…¥æ–‡æœ¬ã€‚è¿™ç¡®ä¿äº†ä¸ä¼šåœ¨ç±»åˆ«è¾¹ç•Œå¤„è¿›è¡Œåˆå¹¶ã€‚è¿™ä¸ªæ–¹æ³•åœ¨ GPT-2 è®ºæ–‡ä¸­è¢«å¼•å…¥ï¼Œå¹¶ä¸”æˆªè‡³ GPT-4 ä»åœ¨ä½¿ç”¨ã€‚è¿™ä¸ªç±»è¿˜å¤„ç†ç‰¹æ®Šæ ‡è®°ï¼ˆå¦‚æœæœ‰ï¼‰ã€‚ minbpe/gpt4.py: å®ç°äº† GPT4Tokenizer ã€‚è¿™ä¸ªç±»æ˜¯ RegexTokenizer çš„ä¸€ä¸ªè½»é‡çº§åŒ…è£…å™¨ï¼Œç²¾ç¡®åœ°é‡ç°äº† tiktoken åº“ä¸­ GPT-4 çš„åˆ†è¯ã€‚ æœ€åï¼Œè„šæœ¬ train.py åœ¨è¾“å…¥æ–‡æœ¬ tests/taylorswift.txt ä¸Šè®­ç»ƒäº†ä¸¤ä¸ªä¸»è¦çš„åˆ†è¯å™¨ï¼Œå¹¶å°†è¯æ±‡è¡¨ä¿å­˜åˆ°ç£ç›˜ä»¥ä¾›å¯è§†åŒ–ã€‚\n3.2ä»£ç åˆ†æ class ä»£ç åˆ†æ(https://zerolovesea.github.io/2024/03/09/MiniBPE%EF%BC%9A%E6%8E%A2%E7%A9%B6Github%E4%B8%8A%E6%9C%80%E7%AE%80%E5%8D%95%E7%9A%84BPE%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81/#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95): def __init__(self): super().__init__() BasicTokenizer åœ¨ encode æ—¶ï¼Œå…ˆå°†æ–‡æœ¬è½¬æ¢ä¸ºutf-8ç¼–ç ï¼Œç„¶åè®¡ç®—statsï¼Œå³æ–‡æœ¬ä¸­ç›¸é‚»å­—èŠ‚çš„é¢‘ç‡ã€‚\npair = min(stats, key=lambda p: self.merges.get(p, float(\u0026#34;inf\u0026#34;))) åœ¨ merges ä¸­ å¯»æ‰¾ stats ï¼Œæ‰¾ä¸åˆ°åˆ™è®¾ä¸ºinfã€‚ç„¶åå–æœ€å°å€¼ï¼Œå› ä¸ºå€¼è¶Šå°ï¼Œè¯´æ˜è¯¥tokenè¶Šå¤„äº merge çš„æ—©æœŸï¼Œè¿™æ ·èƒ½å®ç°é€æ¸èšåˆã€‚\nRegexTokenizer åœ¨è®­ç»ƒé˜¶æ®µè¿›è¡Œæ”¹è¿›ï¼š\nä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†è¾“å…¥æ–‡æœ¬æ‹†åˆ†ä¸º text_chunksï¼ˆä¾‹å¦‚ï¼Œå°† \u0026quot;Hello, world!\u0026quot; æ‹†åˆ†ä¸º [\u0026quot;Hello\u0026quot;, \u0026quot;,\u0026quot;, \u0026quot; world\u0026quot;, \u0026quot;!\u0026quot;]ï¼‰ã€‚ å°†æ¯ä¸ªæ–‡æœ¬å—ç¼–ç ä¸º UTF-8 å­—èŠ‚åºåˆ—ã€‚ä¾‹å¦‚ï¼Œ\u0026quot;Hello\u0026quot; ç¼–ç ä¸ºå­—èŠ‚ b'Hello'ï¼Œå†è½¬ä¸º [72, 101, 108, 108, 111]ã€‚ åœ¨æ¯ä¸ªæ–‡æœ¬å—å†…éƒ¨è®¡ç®—statsï¼Œè¿™ä¸€ç‚¹å’Œbasicä¸åŒã€‚è¿™æ ·è®¡ç®—ç›¸é‚»å­—ç¬¦çš„é¢‘ç‡æ—¶ä¸ä¼šè·¨å•è¯ã€‚ special token çš„å¤„ç†ï¼š\nregister_special_tokens å°†æŒ‡å®šçš„ special token åŠ å…¥ vocab ä¸­ã€‚ åœ¨ encode æ—¶ï¼Œå¦‚æœ allowed_special=\u0026quot;all\u0026quot;ï¼Œå…ˆä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å°†æ–‡æœ¬ä¸­çš„ special token åˆ†ç¦»å‡ºæ¥ï¼Œå¾—åˆ° special_chunksã€‚ å¯¹äºä¸å« special token çš„ partï¼Œä½¿ç”¨ encode_ordinary åˆ†å‰²ã€è½¬æ¢ä¸ºç¼–ç ã€‚ special token ç›´æ¥è½¬æ¢ä¸ºç¼–ç ï¼Œå®ç°ä¼˜å…ˆå¤„ç†ã€‚ å¦‚æœ allowed_special=\u0026quot;none\u0026quot;ï¼Œåˆ™æ•´ä¸ªæ–‡æœ¬ä½¿ç”¨ encode_ordinary å¤„ç†ã€‚ ","permalink":"https://Rook1eChan.github.io/posts/minbpe/minbpebpe%E7%AE%97%E6%B3%95%E7%9A%84%E6%9E%81%E7%AE%80%E5%AE%9E%E7%8E%B0/","summary":"\u003ch1 id=\"minbpebpeç®—æ³•çš„æç®€å®ç°\"\u003eminbpeï¼šBPEç®—æ³•çš„æç®€å®ç°\u003c/h1\u003e\n\u003cp\u003egithub åœ°å€ï¼š\u003ca href=\"https://github.com/karpathy/minbpe\"\u003ekarpathy/minbpe\u003c/a\u003e\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"1bpe-ç®—æ³•\"\u003e1.BPE ç®—æ³•\u003c/h1\u003e\n\u003cp\u003eBPE(Byte Pair Encoding) æ˜¯å¤§æ¨¡å‹çš„ tokenizer å¸¸ç”¨çš„ç®—æ³•ã€‚å®ƒå¯¹è¾“å…¥æ–‡æœ¬çš„å­—èŠ‚è¿›è¡Œç¼–ç ã€‚\u003c/p\u003e\n\u003cp\u003eè¯¥ç®—æ³•å›  GPT-2 çš„\u003ca href=\"https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf\"\u003eè®ºæ–‡\u003c/a\u003eå’Œ\u003ca href=\"https://github.com/openai/gpt-2\"\u003eä»£ç \u003c/a\u003eè€Œè¢«å¹¿æ³›ä½¿ç”¨äº LLMã€‚\u003ca href=\"https://arxiv.org/abs/1508.07909\"\u003eSennrich et al. 2015\u003c/a\u003eè¢«è®¤ä¸ºæ˜¯ BPE åœ¨ NLP åº”ç”¨ä¸­çš„åŸå§‹å‚è€ƒã€‚\u003c/p\u003e\n\u003cp\u003eç®€å•æ¥è¯´ï¼Œbpe æŠŠæ–‡æœ¬çœ‹ä½œ utf-8 ç¼–ç çš„å­—èŠ‚ï¼Œç„¶åå°†å‡ºç°æ¬¡æ•°æœ€å¤šçš„ç›¸é‚»å­—èŠ‚åˆå¹¶ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„ç¼–ç ã€‚å¦‚æ­¤åå¤æ“ä½œã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"2minbpe-ç®€ä»‹\"\u003e2.minbpe ç®€ä»‹\u003c/h1\u003e\n\u003ch2 id=\"21quickstart\"\u003e2.1quickstart\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eminbpe\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eBasicTokenizer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eBasicTokenizer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;aaabdaaabac\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è®­ç»ƒ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003etrain\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e256\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# 256tokens, 3merges\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ç¼–ç \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è§£ç \u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edecode\u003c/span\u003e\u003cspan class=\"p\"\u003e([\u003c/span\u003e\u003cspan class=\"mi\"\u003e258\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e258\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e97\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e99\u003c/span\u003e\u003cspan class=\"p\"\u003e]))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ä¿å­˜\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esave\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;toy\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# writes two files: toy.model (for loading) and toy.vocab (for viewing)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè‹±è¯­å­—æ¯ä¸€ä¸ªå­—æ¯å¯¹åº”ä¸€ä¸ªå­—èŠ‚ã€‚å¯¹äº\u0026quot;aaabdaaabac\u0026quot;ï¼Œå…ˆè®¡ç®—ç›¸é‚»ä¸¤å­—èŠ‚çš„å‡ºç°æ¬¡æ•°ï¼Œç„¶åé€‰æ‹©æ¬¡æ•°æœ€å¤šçš„è¿›è¡Œåˆå¹¶ï¼ˆâ€œaaâ€ï¼Œ4æ¬¡ï¼‰ã€‚\u003c/p\u003e\n\u003cp\u003eâ€œaâ€â€œaâ€åˆå¹¶ä¸ºâ€œaaâ€ï¼Œç¼–ç ä¸º256ã€‚\u003c/p\u003e\n\u003cp\u003eç„¶åå†è®¡ç®—ç›¸é‚»ä¸¤å­—èŠ‚çš„å‡ºç°æ¬¡æ•°ï¼Œå†åˆå¹¶ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ toy.vocab ä¸­å¯ä»¥çœ‹åˆ°æ‰€æœ‰å­—ç¬¦åŠå¯¹åº”çš„ç¼–ç ã€‚\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003etoy.vocab\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e......\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[a][a] -\u0026gt; [aa] 256\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[aa][a] -\u0026gt; [aaa] 257\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e[aaa][b] -\u0026gt; [aaab] 258\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cBR\u003e\n\u003ch2 id=\"22minbpeå’Œgpt-4åˆ†è¯å™¨åŠŸèƒ½ç›¸åŒ\"\u003e2.2minbpeå’ŒGPT-4åˆ†è¯å™¨åŠŸèƒ½ç›¸åŒ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 1.è¯æ˜RegexTokenizerä¸GPT-4çš„åˆ†è¯å™¨æ€§èƒ½ä¸€è‡´\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;hello123!!!? (ì•ˆë…•í•˜ì„¸ìš”!) ğŸ˜‰\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# pip install tiktoken\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003etiktoken\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eenc\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etiktoken\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget_encoding\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;cl100k_base\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [15339, 4513, 12340, 30, 320, 31495, 230, 75265, 243, 92245, 16715, 57037]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003eminbpe\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eGPT4Tokenizer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eGPT4Tokenizer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [15339, 4513, 12340, 30, 320, 31495, 230, 75265, 243, 92245, 16715, 57037]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# 2.æ ‡è®°ç‰¹æ®Štoken\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;\u0026lt;|endoftext|\u0026gt;hello world\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eenc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eallowed_special\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;all\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [100257, 15339, 1917]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ours\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etokenizer\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eencode\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etext\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eallowed_special\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;all\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# [100257, 15339, 1917]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eè°ƒç”¨ encode æ—¶å¿…é¡»æ˜¾ç¤ºå£°æ˜å¤„ç†ç‰¹æ®Šæ ‡è®°ã€‚\u003ccode\u003eallowed_special\u003c/code\u003e å‚æ•°å¯ä»¥è®¾ç½®ä¸º\u0026quot;all\u0026quot;ã€\u0026ldquo;none\u0026quot;æˆ–ä¸€ä¸ªç‰¹æ®Štokenåˆ—è¡¨ã€‚\u003c/p\u003e","title":"minbpeï¼šBPEç®—æ³•çš„æç®€å®ç°"},{"content":"ä¸€ã€ç¯å¢ƒå‡†å¤‡ 1.1åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ conda create -n lf python==3.11 conda init ç„¶åé‡å¼€cmd\nconda activate lf 1.2ä¸‹è½½ç›¸å…³çš„åŒ… conda install pytorch==2.4.0 torchvision==0.19.0 torchaudio==2.4.0 pytorch-cuda=12.1 -c pytorch -c nvidia éªŒè¯GPUç‰ˆæœ¬çš„Pytorchæ˜¯å¦æˆåŠŸ\npython -c \u0026#34;import torch; print(torch.cuda.is_available())\u0026#34; 1.3ä¸‹è½½llama factory sudo apt install git å¼€ç§‘å­¦ä¸Šç½‘\ngit clone https://github.com/hiyouga/LLaMA-Factory.git 1.4å®‰è£…ä¾èµ– python -m pip install --upgrade pip pip install -r requirements.txt pip install -e \u0026#34;.[torch,metrics]\u0026#34; å¦‚æœä¸‹è½½æœ‰é—®é¢˜ï¼Œå¯ä»¥å°è¯•æ¸…åæº\npip install -i https://pypi.tuna.tsinghua.edu.cn/simple -e \u0026#34;.[torch,metrics]\u0026#34; 1.5æ¸…ç†pip pip cache purge äºŒã€ä¸‹è½½æ¨¡å‹ 2.1ä»modelscopeä¸‹è½½æ¨¡å‹æƒé‡æ–‡ä»¶ pip install modelscope å¯ä»¥ä¸‹è½½åˆ°é»˜è®¤çš„å†…å­˜ï¼Œä¸€èˆ¬åœ¨/root/.cache/modelscope/hub/model/é‡Œé¢\nmodelscope download --model Qwen/Qwen3-0.6B æ›´å»ºè®®ä¸‹è½½åˆ°æŒ‡å®šæ–‡ä»¶å¤¹ï¼Œä¾¿äºç®¡ç†\nmodelscope download --model \u0026#39;Qwen/Qwen3-4B-Base\u0026#39; --local_dir \u0026#39;/root/autodl-tmp/qwen3-4b-base/\u0026#39; ä¸‰ã€è¿è¡Œwebui 3.1è¿è¡Œwebui llamafactory-cli webui æˆ–è€… python src/webui.py åœ¨autodlä¸­å¯èƒ½ä¼šæŠ¥é”™ï¼šTo create a public link, set share=True in launch().\næ‰“å¼€interface.pyæ–‡ä»¶ï¼Œè·¯å¾„ä¸ºï¼šLLaMA-Factory/src/llamafactory/webui/interface.py\nå°†run_web_uiçš„create_ui().queue().launchçš„shareå‚æ•°ä¿®æ”¹ä¸ºTrue\nå¦‚æœè¿˜ä¸è¡Œï¼Œå¯ä»¥å°è¯•ä»¥ä¸‹æ–¹æ³•ï¼š\nä»https://cdn-media.huggingface.co/frpc-gradio-0.2/frpc_linux_amd64ä¸‹è½½æ–‡ä»¶ å°†æ–‡ä»¶é‡å‘½åä¸ºï¼šfrpc_linux_amd64_v0.2 ç„¶åæŠŠæ–‡ä»¶æ”¾åœ¨/root/miniconda3/envs/lf/lib/python3.11/site-packages/gradio/ï¼Œè¿™ä¸ªæ–¹æ³•æˆ‘æ²¡ç”¨ æˆ–è€…\ncp /root/.cache/huggingface/gradio/frpc/frpc_linux_amd64_v0.3 /root/miniconda3/envs/lf/lib/python3.11/site-packages/gradio/ æˆ‘æ˜¯å°†frpcæ–‡ä»¶æ‹·è´äº†ä¸€ä»½åˆ°å¦ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶åç»™ä¸€ä¸ªæƒé™ chmod +x frpc_linux_amd64_v0.3 3.2SSH å¯¹äºautodlæ¥è¯´ï¼Œè¦æƒ³è¿æ¥åˆ°é¡µé¢è¿˜è¦ç»è¿‡sshï¼ˆå¦‚æœæ˜¯æœ¬åœ°ï¼Œç›´æ¥ç‚¹å‡»æœ€åçš„ç½‘é¡µé“¾æ¥ï¼Œåº”è¯¥å°±å¯ä»¥è¿è¡Œäº†ï¼‰\nåœ¨autodlæ§åˆ¶å°â€”â€”ä½ è¿™å°æœºå­â€”â€”å¿«æ·å·¥å…·â€”â€”è‡ªå®šä¹‰æœåŠ¡â€”â€”ä¸‹è½½autodl ssh toolâ€”â€”æ‰“å¼€\nè¾“å…¥è¯¥æœºå­çš„ç™»é™†æŒ‡ä»¤å’Œå¯†ç \nä»£ç†åˆ°æœ¬åœ°ç«¯å£ï¼š6006\nä»£ç†åˆ°è¿œç¨‹ç«¯å£ï¼š1080\nç„¶åï¼Œæœ¬åœ°cmdè¿è¡Œ\nssh -CNg -L 7860:127.0.0.1:7860 root@connect.bjb1.seetacloud.com -p 54073 54073æ¢ä¸ºè¯¥æœºå­çš„ç«¯å£ï¼Œç„¶åè¾“å…¥æœºå­çš„å¯†ç \nç„¶åè®¿é—®127.0.0.1:7860å³å¯è¿›å…¥webui\nå››ã€å¯¹è¯é¡µé¢å¼€å¯ å¼€å¯å¯¹è¯é¡µé¢ï¼Œæ¥éªŒè¯ä¸‹è½½çš„æ¨¡å‹æ˜¯å¦æ­£å¸¸\nåœ¨cmdè¾“å…¥\nCUDA_VISIBLE_DEVICES=0 llamafactory-cli webchat --model_name_or_path /root/autodl-tmp/qwen3-0.6b --template qwen model_name_or_pathï¼šæ¨¡å‹ä¸‹è½½åˆ°é»˜è®¤åœ°å€ï¼Œå°±å¡«hfå®˜æ–¹å‘½åå¦‚Qwen3/Qwen3-0.6Bï¼›ä¸‹è½½åˆ°æŒ‡å®šåœ°å€å°±å¡«ç»å¯¹åœ°å€å¦‚/root/autodl-tmp/qwen3-0.6b\ntemplateï¼šæ ¹æ®æ¨¡å‹æ¥é€‰ã€‚å¦‚æœæ¨¡å‹å‡ºç°ä¸åœçš„è¾“å‡ºã€èƒ¡è¨€ä¹±è¯­ç°è±¡å°±è®¾ç½®ä¸ºdefaultå†è¯•è¯•\nç„¶åè®¿é—® http://127.0.0.1:7860/\näº”ã€å¾®è°ƒ ä¸Šæ‰‹è¿›è¡Œå¾®è°ƒ\n5.1ç®€å•å®éªŒ é¦–å…ˆè¿›è¡Œidentityçš„å®éªŒ\nä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„identity.jsonæ•°æ®é›†ï¼Œå¯¹åº”æ–‡ä»¶å·²ç»åœ¨dataç›®å½•ä¸‹\nå¦‚æœä½¿ç”¨è‡ªå·±çš„æ•°æ®ï¼Œè¦æ”¾åˆ°dataä¸‹å¹¶åœ¨dataset_info.jsonä¸­æ³¨å†Œ\næˆ‘ä»¬å¸Œæœ›å¾®è°ƒåï¼Œæ¨¡å‹èƒ½è¾“å‡ºâ€œæˆ‘æ˜¯Alexï¼Œæˆ‘ç”±Rook1eåˆ¶é€ â€\nè¿™é‡Œæˆ‘ä»¬æŠŠidentity.jsoné‡Œæ”¹æ‰ï¼Œä½ ä¹Ÿå¯ä»¥æ”¹æˆä½ çš„åå­—\nsed -i \u0026#39;s/{{name}}/Alex/g\u0026#39; data/identity.json sed -i \u0026#39;s/{{author}}/Rook1echan/g\u0026#39; data/identity.json å†æ¬¡æ‰“å¼€è¯¥æ–‡ä»¶å‘ç°æ‰€æœ‰çš„éƒ¨åˆ†éƒ½å‘ç”Ÿäº†æ›¿æ¢\nç„¶åè¿›å…¥webui\nå¯¹äºindentityè¿™ä¸ªç®€å•å®éªŒçš„ç›¸å…³å‚æ•°é€‰æ‹©ï¼Œæ²¡å†™çš„ä¿æŒé»˜è®¤ï¼š\nå‚æ•°å é€‰æ‹© è¯­è¨€ zh æ¨¡å‹åç§° ç”¨å•¥é€‰å•¥ æ¨¡å‹è·¯å¾„ ä¸‹åˆ°æŒ‡å®šæ–‡ä»¶å¤¹å°±å†™æ–‡ä»¶å¤¹ç»å¯¹è·¯å¾„ï¼Œä¸ç„¶å°±å†™hfæ¨¡å‹æ ‡è¯†ç¬¦ æ¨¡å‹ä¸‹è½½æº modelscope å¾®è°ƒæ–¹æ³• lora é€‰æ‹©Train è®­ç»ƒé˜¶æ®µ SFT æ•°æ®é›† identit è®­ç»ƒè½®æ•° 100ï¼ˆå·®ä¸å¤šåˆ°100losså°±ä¸ä¸‹é™äº†ï¼‰ æˆªæ–­é•¿åº¦ 256ï¼ˆæ•°æ®ä¸æ˜¯å¾ˆé•¿ï¼‰ æ‰¹å¤„ç†å¤§å° å»ºè®®è®¾ç½®ä¸åŒæ•°é‡å¤šè¯•éªŒå‡ æ¬¡ï¼Œè®©GPUåˆ°80%æœ€å¥½ï¼Œå……åˆ†åˆ©ç”¨ä¹Ÿä¸è‡³äºOOMï¼Œæˆ‘è¿™é‡Œæ˜¯4090 24Gï¼Œè®¾ç½®15 å…¶å®ƒå‚æ•°è®¾ç½®-å¯ç”¨æ€è€ƒ ä¸çŸ¥é“æœ‰å•¥å°è±¡ï¼Œæˆ‘å…³æ‰äº†ï¼Œåº”è¯¥ä¼šæ¨ç†å¿«ä¸€ç‚¹ ç„¶åç‚¹å‡»å¼€å§‹å°±è¡Œäº†ï¼Œä¸‹é¢èƒ½çœ‹åˆ°lossçš„æ›²çº¿å›¾\n5.2ä½¿ç”¨sftåçš„æ¨¡å‹ qwen3-4b-base:\nCUDA_VISIBLE_DEVICES=0 llamafactory-cli webchat --model_name_or_path /root/autodl-tmp/qwen3-4b-base --adapter_name_or_path /root/autodl-tmp/LLaMA-Factory/saves/Qwen3-4B-Base/lora/train_2025-09-18-19-41-50 --finetuning_type lora --template default å¤šäº†adapter_name_or_pathï¼ˆcheck pointä½ç½®ï¼‰å’Œfinetuning_typeå‚æ•°\næ³¨æ„ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å•è¯å¯¹è¯æ¨¡å‹ï¼Œæ‰€ä»¥åœ¨chaté‡Œæ¯æ¬¡å¯¹è¯å®Œåè¦æ¸…é™¤å†å²ï¼ä¸ç„¶å°±ä¼šèƒ¡è¨€ä¹±è¯­ã€‚ã€‚ã€‚\nç»è¿‡å®éªŒï¼Œqwen3éœ€è¦\u0026ndash;template defaultæ‰ä¸ä¼šè¯´èƒ¡è¯\n","permalink":"https://Rook1eChan.github.io/posts/llama-factory/llama-factory/","summary":"\u003ch1 id=\"ä¸€ç¯å¢ƒå‡†å¤‡\"\u003eä¸€ã€ç¯å¢ƒå‡†å¤‡\u003c/h1\u003e\n\u003ch2 id=\"11åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\"\u003e1.1åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econda create -n lf \u003cspan class=\"nv\"\u003epython\u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e3.11\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econda init\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eç„¶åé‡å¼€cmd\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econda activate lf\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr\u003e\n\u003ch2 id=\"12ä¸‹è½½ç›¸å…³çš„åŒ…\"\u003e1.2ä¸‹è½½ç›¸å…³çš„åŒ…\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003econda install \u003cspan class=\"nv\"\u003epytorch\u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e2.4.0 \u003cspan class=\"nv\"\u003etorchvision\u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e0.19.0 \u003cspan class=\"nv\"\u003etorchaudio\u003c/span\u003e\u003cspan class=\"o\"\u003e==\u003c/span\u003e2.4.0 pytorch-cuda\u003cspan class=\"o\"\u003e=\u003c/span\u003e12.1 -c pytorch -c nvidia\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eéªŒè¯GPUç‰ˆæœ¬çš„Pytorchæ˜¯å¦æˆåŠŸ\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -c \u003cspan class=\"s2\"\u003e\u0026#34;import torch; print(torch.cuda.is_available())\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr\u003e\n\u003ch2 id=\"13ä¸‹è½½llama-factory\"\u003e1.3ä¸‹è½½llama factory\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003esudo apt install git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¼€ç§‘å­¦ä¸Šç½‘\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003egit clone https://github.com/hiyouga/LLaMA-Factory.git\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr\u003e\n\u003ch2 id=\"14å®‰è£…ä¾èµ–\"\u003e1.4å®‰è£…ä¾èµ–\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epython -m pip install --upgrade pip\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epip install -r requirements.txt\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epip install -e \u003cspan class=\"s2\"\u003e\u0026#34;.[torch,metrics]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¦‚æœä¸‹è½½æœ‰é—®é¢˜ï¼Œå¯ä»¥å°è¯•æ¸…åæº\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epip install -i https://pypi.tuna.tsinghua.edu.cn/simple -e \u003cspan class=\"s2\"\u003e\u0026#34;.[torch,metrics]\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr\u003e\n\u003ch2 id=\"15æ¸…ç†pip\"\u003e1.5æ¸…ç†pip\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epip cache purge\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cbr\u003e\n\u003ch1 id=\"äºŒä¸‹è½½æ¨¡å‹\"\u003eäºŒã€ä¸‹è½½æ¨¡å‹\u003c/h1\u003e\n\u003ch2 id=\"21ä»modelscopeä¸‹è½½æ¨¡å‹æƒé‡æ–‡ä»¶\"\u003e2.1ä»modelscopeä¸‹è½½æ¨¡å‹æƒé‡æ–‡ä»¶\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003epip install modelscope\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eå¯ä»¥ä¸‹è½½åˆ°é»˜è®¤çš„å†…å­˜ï¼Œä¸€èˆ¬åœ¨/root/.cache/modelscope/hub/model/é‡Œé¢\u003c/p\u003e","title":"åœ¨Autodlä¸­ä½¿ç”¨LLaMA-Factoryè¿›è¡Œå¾®è°ƒ"},{"content":"EMNLP2024\n0.ä¸»è¦è´¡çŒ® æå‡ºäº†Lumberchunkeræ–‡æœ¬åˆ†å‰²æ–¹æ³• æå‡ºäº†GuntenQAæ•°æ®é›† éªŒè¯äº†Lumberchunkeråœ¨ä¸‹æ¸¸RAGä»»åŠ¡ä¸Šçš„æ•ˆæœ 1.LumberChunker ä½¿ç”¨LLMåŠ¨æ€çš„å°†æ–‡æ¡£åˆ†å‰²ä¸ºè¯­ä¹‰ç‹¬ç«‹çš„ç‰‡æ®µã€‚æ¯ä¸ªç‰‡æ®µçš„é•¿çŸ­æ˜¯ä¸å›ºå®šçš„ï¼Œç¡®ä¿æ¯ä¸ªç‰‡æ®µçš„è¯­ä¹‰å®Œæ•´æ€§ã€ç‹¬ç«‹æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´åˆ†å‰²åï¼Œæ¯ä¸€æ®µåŒ…å«çš„è¯­ä¹‰æ˜¯å®Œæ•´çš„ï¼ŒåŒæ—¶ä¸å…¶å®ƒæ®µæœ‰åŒºåˆ«ã€‚ç”±LLMæ¥ç¡®å®šåˆé€‚çš„åˆ†å‰²ç‚¹ï¼Œè¿™ä¸€å†³ç­–è¿‡ç¨‹è€ƒè™‘åˆ°æ–‡æœ¬çš„ç»“æ„å’Œè¯­ä¹‰ï¼Œä»è€Œèƒ½å¤Ÿåˆ›å»ºå‡ºå¤§å°æœ€ä¼˜ä¸”ä¸Šä¸‹æ–‡è¿è´¯çš„ç‰‡æ®µã€‚\n1.å…ˆæŒ‰ç…§paragraphåˆ†å‰²ç›®æ ‡æ–‡æ¡£ï¼Œç„¶åæŠŠparagraphé¡ºåºè¿æ¥ï¼Œç›´åˆ°ç´¯è®¡çš„tokenæ•°è¶…è¿‡ä¸€ä¸ªé˜ˆå€¼ $\\theta$ï¼Œå½¢æˆ $ G_i$ã€‚è¯¥é˜ˆå€¼å¦‚ä½•è®¾ç½®åæ–‡ä¼šè¯´ã€‚$\\theta$ åº”è¯¥è¶³å¤Ÿå¤§ï¼Œé˜²æ­¢æŠŠå…·æœ‰ç›¸å…³æ€§çš„æ®µè½åˆ†å¼€ï¼›åŒæ—¶ $\\theta$â€‹ ä¹Ÿè¦è¶³å¤Ÿå°ï¼Œé˜²æ­¢è¿‡å¤šå†…å®¹å½±å“LLMè¿›è¡Œæ¨ç†ã€‚\n2.è®©LLMå¯»æ‰¾ $G_i$ ä¸­â€œè¯­ä¹‰æ–­å±‚â€çš„åœ°æ–¹ï¼Œä½œä¸ºåˆ†å‰²ç‚¹ã€‚åˆ†å‰²ç‚¹ä¹‹å‰å³å½¢æˆä¸€ä¸ªchunkã€‚å‰©ä¸‹çš„å†…å®¹ç»§ç»­ä¸paragraphé¡ºåºæ‹¼æ¥ã€è¶…è¿‡é˜ˆå€¼åœæ­¢ã€LLMåˆ†å‰²â€¦â€¦åˆ†å‰²æ•´ä½“æ˜¯ä¸²è¡Œè¿›è¡Œçš„ã€‚\n2.GutenQA æ•°æ®æ¥æºäºProject Gutenbergç”µå­å›¾ä¹¦é¦†ã€‚\n1.100æœ¬è‹±æ–‡ä¹¦ç±ï¼Œæ‰‹åŠ¨æå–HTMLå†…å®¹ï¼ˆé™„å½•é‡Œå’ŒNarrativeQAè¿›è¡Œäº†å¯¹æ¯”ï¼Œæ‰‹åŠ¨æå–æ²¡æœ‰ç¼–ç é”™è¯¯ç­‰é—®é¢˜ï¼‰\n2.ä½¿ç”¨ChatGPT3.5ä¸ºæ¯æœ¬ä¹¦ç”Ÿæˆé—®é¢˜ã€ç­”æ¡ˆå’ŒåŒ…å«ç­”æ¡ˆçš„åŸæ–‡ç‰‡æ®µï¼Œäººå·¥ä¸ºæ¯æœ¬ä¹¦ç­›é€‰30ä¸ªé«˜è´¨é‡é—®é¢˜ã€‚\né—®é¢˜éœ€è¦åŸºäºç»™å®šç‰‡æ®µä¸­çš„å…·ä½“ä¿¡æ¯ï¼Œä¸”ä¸èƒ½ç”¨ä¹¦ä¸­çš„å…¶å®ƒåœ°æ–¹çš„ä¿¡æ¯æ¥å›ç­”ã€‚é—®é¢˜å¤§å¤šä»¥â€˜what,â€™ â€˜when,â€™ â€˜whereâ€™ å¼€å¤´ï¼Œ â€˜whyâ€™ and â€˜howâ€™è¾ƒå°‘ã€‚\n3.åŸæ–‡ç‰‡æ®µéœ€è¦ç®€çŸ­ï¼Œä»¥ç¡®ä¿ä»»ä½•åˆ†å—æ–¹æ³•éƒ½ä¸ä¼šæŠŠå®ƒåˆ‡å¼€ã€‚è¯„ä¼°æ–¹æ³•æ˜¯åœ¨æ£€ç´¢åˆ°çš„æ–‡æœ¬ä¸­ç²¾ç¡®åŒ¹é…å­—ç¬¦ä¸²ã€‚\n3.Experiments 3.1 propmtçš„é˜ˆå€¼æ€ä¹ˆé€‰æ‹© è¿™ä¸ªé˜ˆå€¼å°±æ˜¯paragraphé¡ºåºè¿æ¥çš„é˜ˆå€¼ $\\theta$â€‹ ã€‚ç”±äºæ˜¯LLMå¯»æ‰¾åˆ†å‰²ç‚¹ï¼Œtokenè¿‡é•¿ä¼šå½±å“æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ã€‚\nåœ¨ä¸åŒé˜ˆå€¼ä¸‹ä½¿ç”¨DCGè¯„ä¼°æ•ˆæœã€‚DCGè¡¨æ˜äº†æ˜¯å¦æ£€ç´¢åˆ°ï¼Œæ£€ç´¢ç»“æœæ˜¯å¦é å‰ã€‚\n3.2 Lumberchunkæ˜¯å¦å¢å¼ºäº†æ£€ç´¢æ•ˆæœï¼Ÿ ä¸å…¶å®ƒåˆ†å—åŸºå‡†è¿›è¡Œå¯¹æ¯”ã€‚è¯„ä¼°æŒ‡æ ‡ä¸ºDCG@Kã€RECALL@Kã€‚\næ­¤å¤–ï¼Œæ³¨æ„åˆ°semantic chunkå’Œparagraph levelçš„æŒ‡æ ‡å¹¶æ²¡æœ‰éšKæœ‰æ•ˆå¢åŠ ï¼Œè¡¨æ˜å…¶åœ¨å¤§è§„æ¨¡æ–‡æ¡£æ£€ç´¢æ–¹é¢çš„å±€é™æ€§ã€‚\nproposition levelçš„å¼•ç”¨åœ¨å“ªï¼Ÿï¼Ÿï¼Ÿ\né™„å½•Få±•ç¤ºäº†å„åˆ†å‰²æ–¹æ³•çš„ç»Ÿè®¡ç»“æœï¼š\nLumberchunkåˆ‡åˆ†åçš„å—å¹³å‡é•¿åº¦ä¸º334ï¼Œæ¯”é¢„è®¾çš„550é˜ˆå€¼ä½äº†40%ï¼Œè¿™è¯´æ˜LLMæœ‰æ•ˆçš„å¯¹æ–‡æœ¬è¿›è¡Œäº†åˆ‡åˆ†ï¼Œè€Œä¸æ˜¯æŒç»­é€‰æ‹©é è¿‘æœ«å°¾çš„IDã€‚è¯´æ˜æœªå‡ºç°Lost in the Middleç°è±¡ã€‚\nåœ¨è®ºæ–‡ã€ŠLost in the Middle: How Language Models Use Long Contextsã€‹ä¸­ï¼Œä½œè€…å‘ç°ï¼Œå½“é’ˆå¯¹é•¿æ–‡æœ¬çš„ä¸åŒä½ç½®ä¿¡æ¯è®¾è®¡ä¸“é—¨é—®é¢˜ï¼Œæµ‹è¯•å¤§è¯­è¨€æ¨¡å‹å¯¹ä¸åŒä½ç½®ä¿¡æ¯çš„è®°å¿†èƒ½åŠ›æ—¶ï¼Œæ¨¡å‹çš„æ€§èƒ½å‘ˆç°ä¸€ç§ â€œU å‹â€ è¡¨ç°ï¼Œå³å¯¹äºå‰æ®µä¸åæ®µçš„ä¿¡æ¯æœ‰ç€è¾ƒå¼ºçš„å…³æ³¨ä¸è®°å¿†èƒ½åŠ›ï¼Œèƒ½è¾ƒå¥½åœ°è§£å†³é—®é¢˜ï¼Œè€Œå¯¹äºä¸­æ®µä¿¡æ¯çš„åˆ©ç”¨åˆ™æœ‰æ‰€é€Šè‰²ã€‚\nè¿™ç§ç°è±¡çš„äº§ç”Ÿå¯èƒ½æ˜¯ç”±äºè®­ç»ƒæ•°æ®ä¸­çš„æ— æ„åå·®ã€‚LLM çš„é¢„è®­ç»ƒä¾§é‡äºæ ¹æ®æœ€è¿‘çš„ä¸€äº› token é¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼Œè€Œåœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ï¼ŒçœŸæ­£çš„æŒ‡ä»¤åˆå¾€å¾€ä½äºä¸Šä¸‹æ–‡å¼€å§‹çš„ä½ç½®ï¼Œè¿™åœ¨ä¸çŸ¥ä¸è§‰ä¸­å¼•å…¥äº†ä¸€ç§ç«‹åœºåè§ï¼Œè®© LLM è®¤ä¸ºé‡è¦ä¿¡æ¯æ€»æ˜¯ä½äºä¸Šä¸‹æ–‡çš„å¼€å¤´å’Œç»“å°¾ã€‚\nç”±äºæ–‡ç« ä¸­å¯¹è¯è¾ƒå¤šï¼Œæ‰€ä»¥paragraph chunk tokenè¾ƒå°‘ï¼›recursiveæ¥è¿‘langchainé¢„è®¾çš„450tokenï¼›proposition levelä¸å…ˆå‰ç ”ç©¶ä¸­çš„tokenæ¥è¿‘ï¼Œ11tokenå·¦å³ã€‚semantic chunkç”±äºå¯¹è¯è¾ƒå¤šï¼Œæ®µè½è¾ƒçŸ­ï¼Œå¯èƒ½è¯­ä¹‰æ¯”è¾ƒè·³è·ƒï¼Œå¯¼è‡´å…¶avg tokenåå°ã€‚\n3.3 Lumberæ˜¯å¦å¢å¼ºäº†ä¸‹æ¸¸çš„ç­”æ¡ˆç”Ÿæˆæ•ˆæœï¼Ÿ å¼€å‘äº†ä¸€ä¸ªRAGpipelineè¿›è¡Œæµ‹è¯•ã€‚æµ‹è¯•æ•°æ®æ¥è‡ª4éƒ¨è‡ªä¼ ä½“ä½œå“ï¼ŒåŒ…æ‹¬280ä¸ªé—®é¢˜ã€‚ä¸å…¶å®ƒRAGè¿›è¡Œå¯¹æ¯”ï¼Œè¿˜ä¸çº¯LLMå¯¹æ¯”ã€‚\n3.4 Lumberchunkerä¸äººç±»æ‰‹åŠ¨åˆ†å—çš„æ•ˆæœæœ‰å¤šç›¸ä¼¼ï¼Ÿè¿™ç§ç›¸ä¼¼æ€§åˆä¸å‡†ç¡®æ€§æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ ä¸recursiveæ¯”è¾ƒï¼Œç”¨Rough-Lè¯„ä»·ï¼Œç¡®å®æ›´åƒäººåˆ†çš„å—ã€‚è¿™å¯èƒ½æ˜¯å¯¼è‡´RAGæ•ˆæœå¥½çš„åŸå› ã€‚\n4.Limitations ä¸²è¡Œä½¿ç”¨LLMï¼Œæ…¢â€”â€”æ”¹ä¸ºå¹¶è¡Œ åªä½¿ç”¨äº†GutenQAä¸€ä¸ªæ•°æ®é›†ï¼Œå™äº‹å‹çš„ï¼Œä¸å…·æœ‰æ™®éæ€§â€”â€”å¤šå‡ ä¸ªæ•°æ®é›†/å¯»æ‰¾é€šç”¨çš„prompt ","permalink":"https://Rook1eChan.github.io/posts/lumberchunker/","summary":"\u003cp\u003e\u003cem\u003eEMNLP2024\u003c/em\u003e\u003c/p\u003e\n\u003ch1 id=\"0ä¸»è¦è´¡çŒ®\"\u003e0.ä¸»è¦è´¡çŒ®\u003c/h1\u003e\n\u003cul\u003e\n\u003cli\u003eæå‡ºäº†Lumberchunkeræ–‡æœ¬åˆ†å‰²æ–¹æ³•\u003c/li\u003e\n\u003cli\u003eæå‡ºäº†GuntenQAæ•°æ®é›†\u003c/li\u003e\n\u003cli\u003eéªŒè¯äº†Lumberchunkeråœ¨ä¸‹æ¸¸RAGä»»åŠ¡ä¸Šçš„æ•ˆæœ\u003c/li\u003e\n\u003c/ul\u003e\n\u003cBR\u003e\n\u003ch1 id=\"1lumberchunker\"\u003e1.LumberChunker\u003c/h1\u003e\n\u003cp\u003e\u003cimg alt=\"overview\" loading=\"lazy\" src=\"/lumberchunker/p1.png\"\u003e\u003c/p\u003e\n\u003cp\u003eä½¿ç”¨LLMåŠ¨æ€çš„å°†æ–‡æ¡£åˆ†å‰²ä¸ºè¯­ä¹‰ç‹¬ç«‹çš„ç‰‡æ®µã€‚æ¯ä¸ªç‰‡æ®µçš„é•¿çŸ­æ˜¯ä¸å›ºå®šçš„ï¼Œç¡®ä¿æ¯ä¸ªç‰‡æ®µçš„è¯­ä¹‰å®Œæ•´æ€§ã€ç‹¬ç«‹æ€§ã€‚ä¹Ÿå°±æ˜¯è¯´åˆ†å‰²åï¼Œæ¯ä¸€æ®µåŒ…å«çš„è¯­ä¹‰æ˜¯å®Œæ•´çš„ï¼ŒåŒæ—¶ä¸å…¶å®ƒæ®µæœ‰åŒºåˆ«ã€‚ç”±LLMæ¥ç¡®å®šåˆé€‚çš„åˆ†å‰²ç‚¹ï¼Œè¿™ä¸€å†³ç­–è¿‡ç¨‹è€ƒè™‘åˆ°æ–‡æœ¬çš„ç»“æ„å’Œè¯­ä¹‰ï¼Œä»è€Œèƒ½å¤Ÿåˆ›å»ºå‡ºå¤§å°æœ€ä¼˜ä¸”ä¸Šä¸‹æ–‡è¿è´¯çš„ç‰‡æ®µã€‚\u003c/p\u003e\n\u003cp\u003e1.å…ˆæŒ‰ç…§paragraphåˆ†å‰²ç›®æ ‡æ–‡æ¡£ï¼Œç„¶åæŠŠparagraphé¡ºåºè¿æ¥ï¼Œç›´åˆ°ç´¯è®¡çš„tokenæ•°è¶…è¿‡ä¸€ä¸ªé˜ˆå€¼ $\\theta$ï¼Œå½¢æˆ $ G_i$ã€‚è¯¥é˜ˆå€¼å¦‚ä½•è®¾ç½®åæ–‡ä¼šè¯´ã€‚$\\theta$ åº”è¯¥è¶³å¤Ÿå¤§ï¼Œé˜²æ­¢æŠŠå…·æœ‰ç›¸å…³æ€§çš„æ®µè½åˆ†å¼€ï¼›åŒæ—¶ $\\theta$â€‹ ä¹Ÿè¦è¶³å¤Ÿå°ï¼Œé˜²æ­¢è¿‡å¤šå†…å®¹å½±å“LLMè¿›è¡Œæ¨ç†ã€‚\u003c/p\u003e\n\u003cp\u003e2.è®©LLMå¯»æ‰¾ $G_i$ ä¸­â€œè¯­ä¹‰æ–­å±‚â€çš„åœ°æ–¹ï¼Œä½œä¸ºåˆ†å‰²ç‚¹ã€‚åˆ†å‰²ç‚¹ä¹‹å‰å³å½¢æˆä¸€ä¸ªchunkã€‚å‰©ä¸‹çš„å†…å®¹ç»§ç»­ä¸paragraphé¡ºåºæ‹¼æ¥ã€è¶…è¿‡é˜ˆå€¼åœæ­¢ã€LLMåˆ†å‰²â€¦â€¦åˆ†å‰²æ•´ä½“æ˜¯ä¸²è¡Œè¿›è¡Œçš„ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"2gutenqa\"\u003e2.GutenQA\u003c/h1\u003e\n\u003cp\u003eæ•°æ®æ¥æºäºProject Gutenbergç”µå­å›¾ä¹¦é¦†ã€‚\u003c/p\u003e\n\u003cp\u003e1.100æœ¬è‹±æ–‡ä¹¦ç±ï¼Œæ‰‹åŠ¨æå–HTMLå†…å®¹ï¼ˆé™„å½•é‡Œå’ŒNarrativeQAè¿›è¡Œäº†å¯¹æ¯”ï¼Œæ‰‹åŠ¨æå–æ²¡æœ‰ç¼–ç é”™è¯¯ç­‰é—®é¢˜ï¼‰\u003c/p\u003e\n\u003cp\u003e2.ä½¿ç”¨ChatGPT3.5ä¸ºæ¯æœ¬ä¹¦ç”Ÿæˆé—®é¢˜ã€ç­”æ¡ˆå’ŒåŒ…å«ç­”æ¡ˆçš„åŸæ–‡ç‰‡æ®µï¼Œäººå·¥ä¸ºæ¯æœ¬ä¹¦ç­›é€‰30ä¸ªé«˜è´¨é‡é—®é¢˜ã€‚\u003c/p\u003e\n\u003cp\u003eé—®é¢˜éœ€è¦åŸºäºç»™å®šç‰‡æ®µä¸­çš„å…·ä½“ä¿¡æ¯ï¼Œ\u003cu\u003eä¸”ä¸èƒ½ç”¨ä¹¦ä¸­çš„å…¶å®ƒåœ°æ–¹çš„ä¿¡æ¯æ¥å›ç­”\u003c/u\u003eã€‚é—®é¢˜å¤§å¤šä»¥â€˜what,â€™ â€˜when,â€™ â€˜whereâ€™ å¼€å¤´ï¼Œ â€˜whyâ€™ and â€˜howâ€™è¾ƒå°‘ã€‚\u003c/p\u003e\n\u003cp\u003e3.åŸæ–‡ç‰‡æ®µéœ€è¦ç®€çŸ­ï¼Œä»¥ç¡®ä¿ä»»ä½•åˆ†å—æ–¹æ³•éƒ½ä¸ä¼šæŠŠå®ƒåˆ‡å¼€ã€‚è¯„ä¼°æ–¹æ³•æ˜¯åœ¨æ£€ç´¢åˆ°çš„æ–‡æœ¬ä¸­ç²¾ç¡®åŒ¹é…å­—ç¬¦ä¸²ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"3experiments\"\u003e3.Experiments\u003c/h1\u003e\n\u003ch3 id=\"31-propmtçš„é˜ˆå€¼æ€ä¹ˆé€‰æ‹©\"\u003e3.1 propmtçš„é˜ˆå€¼æ€ä¹ˆé€‰æ‹©\u003c/h3\u003e\n\u003cp\u003eè¿™ä¸ªé˜ˆå€¼å°±æ˜¯paragraphé¡ºåºè¿æ¥çš„é˜ˆå€¼ $\\theta$â€‹ ã€‚ç”±äºæ˜¯LLMå¯»æ‰¾åˆ†å‰²ç‚¹ï¼Œtokenè¿‡é•¿ä¼šå½±å“æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨ä¸åŒé˜ˆå€¼ä¸‹ä½¿ç”¨DCGè¯„ä¼°æ•ˆæœã€‚DCGè¡¨æ˜äº†æ˜¯å¦æ£€ç´¢åˆ°ï¼Œæ£€ç´¢ç»“æœæ˜¯å¦é å‰ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p2\" loading=\"lazy\" src=\"/lumberchunker/p2.png\"\u003e\u003c/p\u003e\n\u003ch3 id=\"32-lumberchunkæ˜¯å¦å¢å¼ºäº†æ£€ç´¢æ•ˆæœ\"\u003e3.2 Lumberchunkæ˜¯å¦å¢å¼ºäº†æ£€ç´¢æ•ˆæœï¼Ÿ\u003c/h3\u003e\n\u003cp\u003eä¸å…¶å®ƒåˆ†å—åŸºå‡†è¿›è¡Œå¯¹æ¯”ã€‚è¯„ä¼°æŒ‡æ ‡ä¸ºDCG@Kã€RECALL@Kã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p3\" loading=\"lazy\" src=\"lumberchunker/p3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæ­¤å¤–ï¼Œæ³¨æ„åˆ°semantic chunkå’Œparagraph levelçš„æŒ‡æ ‡å¹¶æ²¡æœ‰éšKæœ‰æ•ˆå¢åŠ ï¼Œè¡¨æ˜å…¶åœ¨å¤§è§„æ¨¡æ–‡æ¡£æ£€ç´¢æ–¹é¢çš„å±€é™æ€§ã€‚\u003c/p\u003e\n\u003cp\u003eproposition levelçš„å¼•ç”¨åœ¨å“ªï¼Ÿï¼Ÿï¼Ÿ\u003c/p\u003e\n\u003cp\u003eé™„å½•Få±•ç¤ºäº†å„åˆ†å‰²æ–¹æ³•çš„ç»Ÿè®¡ç»“æœï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p3\" loading=\"lazy\" src=\"/lumberchunker/p3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eLumberchunkåˆ‡åˆ†åçš„å—å¹³å‡é•¿åº¦ä¸º334ï¼Œæ¯”é¢„è®¾çš„550é˜ˆå€¼ä½äº†40%ï¼Œè¿™è¯´æ˜LLMæœ‰æ•ˆçš„å¯¹æ–‡æœ¬è¿›è¡Œäº†åˆ‡åˆ†ï¼Œè€Œä¸æ˜¯æŒç»­é€‰æ‹©é è¿‘æœ«å°¾çš„IDã€‚è¯´æ˜æœªå‡ºç°Lost in the Middleç°è±¡ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eåœ¨è®ºæ–‡ã€ŠLost in the Middle: How Language Models Use Long Contextsã€‹ä¸­ï¼Œä½œè€…å‘ç°ï¼Œå½“é’ˆå¯¹é•¿æ–‡æœ¬çš„ä¸åŒä½ç½®ä¿¡æ¯è®¾è®¡ä¸“é—¨é—®é¢˜ï¼Œæµ‹è¯•å¤§è¯­è¨€æ¨¡å‹å¯¹ä¸åŒä½ç½®ä¿¡æ¯çš„è®°å¿†èƒ½åŠ›æ—¶ï¼Œæ¨¡å‹çš„æ€§èƒ½å‘ˆç°ä¸€ç§ â€œU å‹â€ è¡¨ç°ï¼Œå³å¯¹äºå‰æ®µä¸åæ®µçš„ä¿¡æ¯æœ‰ç€è¾ƒå¼ºçš„å…³æ³¨ä¸è®°å¿†èƒ½åŠ›ï¼Œèƒ½è¾ƒå¥½åœ°è§£å†³é—®é¢˜ï¼Œè€Œå¯¹äºä¸­æ®µä¿¡æ¯çš„åˆ©ç”¨åˆ™æœ‰æ‰€é€Šè‰²ã€‚\u003c/p\u003e\n\u003cp\u003eè¿™ç§ç°è±¡çš„äº§ç”Ÿå¯èƒ½æ˜¯ç”±äºè®­ç»ƒæ•°æ®ä¸­çš„æ— æ„åå·®ã€‚LLM çš„é¢„è®­ç»ƒä¾§é‡äºæ ¹æ®æœ€è¿‘çš„ä¸€äº› token é¢„æµ‹ä¸‹ä¸€ä¸ª tokenï¼Œè€Œåœ¨å¾®è°ƒè¿‡ç¨‹ä¸­ï¼ŒçœŸæ­£çš„æŒ‡ä»¤åˆå¾€å¾€ä½äºä¸Šä¸‹æ–‡å¼€å§‹çš„ä½ç½®ï¼Œè¿™åœ¨ä¸çŸ¥ä¸è§‰ä¸­å¼•å…¥äº†ä¸€ç§ç«‹åœºåè§ï¼Œè®© LLM è®¤ä¸ºé‡è¦ä¿¡æ¯æ€»æ˜¯ä½äºä¸Šä¸‹æ–‡çš„å¼€å¤´å’Œç»“å°¾ã€‚\u003c/p\u003e","title":"LumberChunker"},{"content":"DeepSeek-VL: Towards Real-World Vision-Language Understanding 0. Abstract æœ¬æ–‡çš„ä¸»è¦è´¡çŒ®ï¼š\næ•°æ®é›†æ„å»ºï¼šæ„å»ºäº†å…·æœ‰å¤šæ ·æ€§å’Œå¯æ‰©å±•æ€§ï¼Œå¹¿æ³›è¦†ç›–çœŸå®ä¸–ç•Œåœºæ™¯çš„æ•°æ®é›†ã€‚åŒ…æ‹¬ç½‘é¡µæˆªå›¾ã€PDFæ–‡æ¡£ã€OCRæ–‡æœ¬ã€å›¾è¡¨ä»¥åŠçŸ¥è¯†å‹å†…å®¹ï¼ˆå¦‚ä¸“å®¶çŸ¥è¯†ã€æ•™ç§‘ä¹¦ï¼‰ç­‰ã€‚æ­¤å¤–ï¼Œæ ¹æ®çœŸå®ç”¨æˆ·åœºæ™¯å°†æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æ®æ­¤åˆ›å»ºäº†æŒ‡ä»¤å¾®è°ƒæ•°æ®é›†ã€‚é€šè¿‡è¯¥æ•°æ®é›†çš„å¾®è°ƒï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„ç”¨æˆ·ä½“éªŒã€‚\nåˆ›æ–°çš„æ¨¡å‹æ¶æ„ï¼šé‡‡ç”¨äº†æ··åˆè§†è§‰ç¼–ç å™¨ï¼ˆhybrid vision encoderï¼‰ï¼Œèƒ½åœ¨å›ºå®šçš„tokené¢„ç®—ä¸‹é«˜æ•ˆå¤„ç†é«˜åˆ†è¾¨ç‡å›¾åƒï¼ˆ1024*1024ï¼‰ï¼ŒåŒæ—¶ä¿æŒè¾ƒä½çš„è®¡ç®—å¼€é”€ã€‚è¯¥æ¶æ„ä¿è¯æ¨¡å‹å¤šç§è§†è§‰ä»»åŠ¡ä¸­èƒ½æ•æ‰åˆ°å…³é”®çš„è¯­ä¹‰å’Œç»†èŠ‚ä¿¡æ¯ã€‚\nåˆ›æ–°çš„è®­ç»ƒç­–ç•¥ï¼šæ—¢ä½¿LLMå­¦ä¼šæ–°æ¨¡æ€ï¼Œä¹Ÿä¿è¯åŸæœ‰çš„çš„è¯­è¨€èƒ½åŠ›ä¸é€€åŒ–ã€‚è°ƒæ§è¯­è¨€å’Œè§†è§‰çš„ç«äº‰å…³ç³»ï¼Œå®ç°ä¸¤ç§æ¨¡æ€çš„å‡è¡¡èåˆã€‚\n1. Introduction å¤§è¯­è¨€æ¨¡å‹çš„å·¨å¤§æˆåŠŸå¼•å‘äº†äººä»¬å¯¹å¤šæ¨¡æ€æ¨¡å‹çš„è¿½æ±‚ã€‚è¿™äº›æ¨¡å‹èƒ½åŒæ—¶ç†è§£è¯­è¨€å’Œå›¾åƒï¼Œåœ¨æ‰§è¡Œç°å®ä¸–ç•Œä»»åŠ¡æ—¶å±•ç°å‡ºå·¨å¤§çš„æ½œåŠ›ã€‚\nç›®å‰å‡ºç°äº†å¾ˆå¤šå¼€æºçš„VLMæ–¹æ¡ˆï¼Œåœ¨benchmarkä¸Šè¡¨ç°ä¼˜ç§€ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­è¡¨ç°ä¸ä½³ã€‚å¤§éƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼ˆæœ¬æ–‡çš„æ”¹è¿›æ–¹æ¡ˆï¼‰ï¼š\nè®¸å¤šæ–¹æ¡ˆå°†é‡å¿ƒæ”¾åœ¨æŒ‡ä»¤å¾®è°ƒé˜¶æ®µã€‚ä½œè€…è®¤ä¸ºåº”å½“ä½¿ç”¨å¤§é‡çš„è§†è§‰-è¯­è¨€æ•°æ®è¿›è¡Œå……åˆ†é¢„è®­ç»ƒã€‚ï¼ˆæ·±åº¦é¢„è®­ç»ƒï¼‰\nç°æœ‰æ–¹æ¡ˆå¤šä½¿ç”¨å­¦æœ¯ä¸Šçš„æ•°æ®é›†è¿›è¡Œå¾®è°ƒï¼Œç¼ºä¹ç°å®ä¸–ç•Œç»éªŒã€‚ï¼ˆç²¾å¿ƒæ„å»ºæ•°æ®é›†ï¼‰\nç°æœ‰æ–¹æ¡ˆå¤šé‡‡ç”¨vision transformerä¸é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç»“åˆçš„æ–¹å¼ï¼Œè¿™ç±»æ¨¡å‹åˆ†è¾¨ç‡ä½ï¼Œä¸èƒ½èƒœä»»OCRæˆ–å¾®å°ç‰©ä½“è¯†åˆ«ä»»åŠ¡ã€‚ï¼ˆé«˜åˆ†è¾¨ç‡å¤„ç†æ¶æ„ï¼‰\næœ‰äº›æ¨¡å‹åœ¨é•¿æœŸçš„å¤šæ¨¡æ€è®­ç»ƒä¸­ä¼šå‡ºç°è¯­è¨€èƒ½åŠ›çš„é€€åŒ–ã€‚åº”é‡‡ç”¨ä¸€ç§æ—¢ä¿ç•™è¯­è¨€èƒ½åŠ›ï¼ŒåˆæŒæ¡æ–°æ¨¡æ€èƒ½åŠ›çš„è®­ç»ƒæ–¹å¼ã€‚ï¼ˆå¹³è¡¡å¤šæ¨¡æ€ç‰¹å¾çš„è®­ç»ƒç­–ç•¥ï¼‰\nDeepSeek-VLå…·æœ‰é€šç”¨çš„å¤šæ¨¡æ€ç†è§£èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†é€»è¾‘å›¾ã€ç½‘é¡µã€å…¬å¼è¯†åˆ«ã€ç§‘å­¦æ–‡çŒ®ã€è‡ªç„¶å›¾åƒç­‰ã€‚\nDeepSeek-VLçš„ä¼˜åŠ¿ï¼š\nDeepseek-VLçš„é¢„è®­ç»ƒæ•°æ®æ¶µç›–äº†å¹¿æ³›çš„ä¸–ç•ŒçŸ¥è¯†ï¼ŒåŒ…æ‹¬ç½‘ç»œçˆ¬è™«ã€ç½‘é¡µä»£ç ã€ç”µå­ä¹¦ã€æ•™è‚²èµ„æ–™ã€arxivæ–‡ç« ç­‰ç­‰ï¼Œå…¨é¢è¦†ç›–ç°å®ä¸–ç•Œä¸­çš„åœºæ™¯ï¼Œæ•°æ®è´¨é‡é«˜ï¼Œå…·æœ‰å¹¿æ³›æ€§å’Œå®ç”¨æ€§ã€‚åŒæ—¶ä½œè€…å›¢é˜Ÿè¿˜ç²¾å¿ƒè®¾è®¡äº†æŒ‡ä»¤è°ƒä¼˜æ•°æ®é›†ï¼Œå…·ä½“æ¥è¯´ï¼Œä½œè€…ä»ç½‘ä¸Šæ”¶é›†äº†GPT-4Vå’ŒGeminiçš„çœŸå®æ¡ˆä¾‹ï¼Œå¹¶è¿›è¡Œåˆ†ç±»ï¼Œä¸ºæ¯ä¸ªæµ‹è¯•å›¾åƒé€‰æ‹©åˆé€‚çš„promptã€‚è¯¥åˆ†ç±»ä½“ç³»è¿˜ç”¨äºæ„å»ºè¯„ä¼°æ•°æ®é›†ã€‚\nè§†è§‰æ¨¡å—é‡‡ç”¨æ··åˆè§†è§‰ç¼–ç å™¨æ¶æ„ï¼Œ384$\\times$384çš„æ–‡æœ¬å¯¹é½ç¼–ç å™¨ç”¨äºç²—ç²’åº¦è¯­ä¹‰æå–ï¼Œ1024$\\times$1024çš„é«˜åˆ†è¾¨ç‡ç¼–ç å™¨ç”¨äºæ•æ‰ç»†èŠ‚è§†è§‰ä¿¡æ¯ã€‚ä¸¤è€…ç»“åˆï¼Œå¯ä»¥å°†1024$\\times$1024çš„å›¾åƒå‹ç¼©ä¸º576ä¸ªtokenï¼Œåœ¨è§†è§‰è¡¨å¾å’Œtokenå¼€é”€é—´å–å¾—å¹³è¡¡ï¼Œä½¿è§†è§‰æ¨¡å—æ”¯æŒæ–‡-å›¾äº¤ç»‡å¤„ç†å’Œå¤šè½®æ¨ç†åœºæ™¯ã€‚\nä¸ºäº†ä½¿å¤šæ¨¡æ€æ¨¡å‹ä¸å‡ºç°è¯­è¨€èƒ½åŠ›çš„é€€åŒ–ï¼š1.ä¿æŒè‡³å°‘70%çš„è¯­è¨€æ•°æ®ï¼Œè¿™å¯¹ç»´æŠ¤æ¨¡å‹å†…éƒ¨çš„è¯­è¨€çŸ¥è¯†å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚2.ä½œè€…æå‡ºäº†æ¨¡æ€é¢„çƒ­(modality warm-up)ç­–ç•¥ã€‚è¯¥æ–¹æ³•é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åŠ¨æ€è°ƒæ•´æ¨¡æ€æ¯”ä¾‹ï¼Œé€æ­¥å¼•å…¥æ›´å¤šè§†è§‰-è¯­è¨€æ•°æ®ã€‚\nåœ¨è¿­ä»£æ¨¡å‹æ—¶ï¼Œé¦–å…ˆåœ¨å°æ¨¡å‹ä¸Šè¿›è¡Œå®éªŒã€‚ç„¶è€Œï¼Œå½¢å¦‚1Bçš„å°æ¨¡å‹åœ¨benchmarkä¸Šéš¾ä»¥å±•ç°ç†æƒ³æ€§èƒ½ï¼Œæ— æ³•çœŸå®çš„åæ˜ æ¨¡å‹çš„å®é™…è¡¨ç°ã€‚å› æ­¤ï¼Œä½œè€…æŠŠè¯„ä¼°æªæ–½ä»å¤šé€‰æ”¹ä¸ºäº†å„é€‰é¡¹çš„å›°æƒ‘åº¦ï¼ˆPPLï¼‰å¯¹æ¯”ï¼›æ­¤å¤–ï¼Œä¸ºé¿å…æŒ‡ä»¤è·Ÿéšèƒ½åŠ›æˆä¸ºç“¶é¢ˆï¼Œåœ¨é¢„è®­ç»ƒé˜¶æ®µæˆ‘ä»¬æ··åˆäº†å°‘é‡æŒ‡ä»¤è°ƒä¼˜æ•°æ®ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ—¢èƒ½åˆ©ç”¨1Bæ¨¡å‹è·å¾—åˆç†æ€§èƒ½è¡¨ç°ï¼Œåˆèƒ½æ›´ç²¾å‡†åœ°é‡åŒ–å®éªŒä¸­æ¯æ¬¡è¿­ä»£çš„å½±å“æ•ˆæœã€‚\n2. Data Construction æ•°æ®é›†åŒ…æ‹¬ä¸¤å¤§æ¨¡å—ï¼šVL-Pretrainæ•°æ®ã€VL-SFTæ•°æ®\nVL-Pretrainæ•´åˆäº†å¤šæºè§†è§‰æ–‡æœ¬æ•°æ®ï¼Œæ—¨åœ¨å¼ºåŒ–æ¨¡å‹çš„åŸºç¡€è·¨æ¨¡æ€ç†è§£èƒ½åŠ›ã€‚\nVL-SFTç›¸å¯¹è¾ƒå°ï¼Œä¸»è¦ç”¨äºè®­ç»ƒæ¨¡å‹å®Œæˆç‰¹å®šä¸‹æ¸¸ä»»åŠ¡ã€‚\nåœ¨stage1ï¼ŒVL-Pretrainç”¨äºé¢„çƒ­VL adapter\nstage2ï¼ŒVL-Pretrainç”¨äºè”åˆé¢„è®­ç»ƒVL adaptorå’ŒVL model\nstage3ï¼Œä½¿ç”¨VL-SFTå¾®è°ƒæ•´ä¸ªæ¨¡å‹\n2.1 VL-Pretraining Data åˆ†ä¸ºä»¥ä¸‹7ä¸ªç±»åˆ«ï¼š\nInterleaved image-text dataï¼ˆäº¤é”™å¼å›¾æ–‡æ•°æ®ï¼Œä½¿æ¨¡å‹å¯¹å¤šæ¨¡æ€è¾“å…¥å…·æœ‰æ›´å¥½çš„ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›ï¼‰ï¼ŒMMC4ã€Wikiç­‰\nImage caption dataï¼ˆå›¾åƒæè¿°ï¼ŒåŒ…å«é«˜è´¨é‡å›¾-æ–‡å¯¹ï¼‰ï¼ŒCapsfusionã€TaiSuç­‰\nTable and chart dataï¼ˆå›¾è¡¨æ•°æ®ï¼‰ï¼ŒChart2textã€Unichart\nWeb Code dataï¼ˆç½‘é¡µä»£ç ï¼Œä½¿æ¨¡å‹å…·æœ‰ä»å›¾å½¢ç•Œé¢æˆ–å›¾è¡¨é‡å»ºä»£ç çš„èƒ½åŠ›ã€‚ä»Stackæ•°æ®é›†ä¸­çš„jupyter notebookæ¸…æ´—å‡º2millionå›¾åƒ-ä»£ç å¯¹ã€‚æœ€ç»ˆé€‰æ‹©1.1millionä½œä¸ºæ˜¯ä¸»è¦è®­ç»ƒé›†ï¼ŒåŒ…æ‹¬ä¸€å¼ å›¾åƒ-è‡³å°‘5è¡Œä»£ç ï¼‰\nOCR dataï¼ˆæ–‡æ¡£å…‰å­¦å­—ç¬¦è¯†åˆ«æ•°æ®ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªä¸­è‹±æ··åˆçš„OCRæ•°æ®é›†ï¼ŒåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š1.arxivæ–‡ç«  2.ç”µå­ä¹¦å’Œæ•™è‚²ææ–™ï¼Œæ¥è‡ªAnna\u0026rsquo;s Archiveï¼‰\nScene text OCRï¼ˆå¢å¼ºæ¨¡å‹è¯†åˆ«åœºæ™¯ä¸­æ–‡æœ¬çš„èƒ½åŠ›ï¼‰ArTã€MLT-17ç­‰ã€‚\nText-only corpusï¼ˆçº¯æ–‡æœ¬ï¼Œå’ŒDeepSeek LLMçš„ä¸€è‡´ï¼‰\n2.2 VL-SFT Data åŒ…æ‹¬å¤šä¸ªçŸ¥åå¼€æºæ•°æ®é›†ShareGPT4Vã€LAION-GPTVç­‰ã€‚\nä»ç½‘ç»œèµ„æºä¸­æ”¶é›†GPT-4Vå’ŒGeminiçš„å¤šæ ·åŒ–çœŸå®æµ‹è¯•æ¡ˆä¾‹ï¼Œè¿›è¡Œåˆ†æã€å½’ç±»ï¼ˆè’¸é¦ï¼‰ï¼š\nRecognitionï¼ˆè€ƒå¯Ÿå¤§å‹æ¨¡å‹å¯¹å›¾åƒå†…å®¹çš„ç†è§£å’Œæè¿°èƒ½åŠ›ï¼Œä¸éœ€è¦æ¨¡å‹å…·å¤‡é«˜çŸ¥è¯†å‚¨å¤‡å’Œæ¨ç†èƒ½åŠ›ï¼Œéƒ¨åˆ†ä»»åŠ¡å¯ä½¿ç”¨ä¼ ç»Ÿæœºå™¨å­¦ä¹ æ¨¡å‹å®Œæˆï¼‰\nConversionï¼ˆè¦æ±‚æ¨¡å‹æè¿°å’Œè¯†åˆ«å›¾åƒå†…å®¹ï¼Œå¹¶å°†å›¾åƒè½¬æ¢ä¸ºå¦ä¸€ç§å½¢å¼ï¼Œå¦‚UI2Codeï¼ŒImage2Promptç­‰ï¼‰\nAnalysisï¼ˆåŸºäºå›¾åƒå†…å®¹è¿›è¡Œåˆ†æï¼Œå¦‚è¡¨æ ¼åˆ†æï¼ŒåŒ»å­¦å›¾åƒåˆ†æç­‰ï¼‰\nCommonsense Reasoningï¼ˆè€ƒå¯Ÿæ¨¡å‹å¯¹å¸¸è¯†çš„æŒæ¡ï¼Œå¦‚ç‰©ä½“é—´å…³ç³»æ¨ç†ã€ç‰©ä½“åŠŸèƒ½æ¨ç†ç­‰ï¼‰\nLogical Reasoningï¼ˆè€ƒå¯Ÿæ¨¡å‹å¯¹é¢†åŸŸçŸ¥è¯†çš„è¿ç”¨å’Œé€»è¾‘æ¨ç†èƒ½åŠ›ï¼Œå¦‚æ•°å­¦ã€ç‰©ç†æ–¹é¢çš„æ¨ç†ï¼‰\nEvaluationï¼ˆè¦æ±‚æ¨¡å‹æ ¹æ®ç‰¹å®šæ ‡å‡†å¯¹å›¾åƒå†…å®¹è¿›è¡Œè¯„ä¼°ï¼‰\nMulti-graphï¼ˆè€ƒå¯Ÿæ¨¡å‹åˆ†æç†è§£å¤šä¸ªå›¾åƒçš„èƒ½åŠ›ï¼Œå¦‚æ—¶åºç†è§£ã€å¤šå›¾å¯¹æ¯”ç­‰ï¼‰\nSafetyï¼ˆæ£€æŸ¥æ¨¡å‹å®‰å…¨æ€§ï¼Œå¦‚æš—ç¤ºæ€§æé—®ã€åäº‹å®æ€§æé—®å’Œpromptæ³¨å…¥ï¼‰\næ­¤å¤–è¿˜æœ‰ä¸€éƒ¨åˆ†çº¯æ–‡æœ¬SFTæ•°æ®ã€‚\n3. Approach 3.1 Architecture åŒ…å«ä¸‰ä¸ªæ¨¡å—ï¼ša hybrid vision encoder, a vision adaptor, and a language model\nHybrid Vision Encoderï¼šä½œè€…å…ˆæ˜¯ä½¿ç”¨äº†SigLIPä½œä¸ºè§†è§‰ç¼–ç å™¨ï¼Œä½†æ˜¯å‘ç°å•ä¸€çš„SigLIPç¼–ç å™¨å­˜åœ¨â€œCLIP-blind pairsâ€ç°è±¡ï¼ˆè§†è§‰ä¸Šä¸åŒï¼Œä½†æ˜¯CLIPç¼–ç åå´å¾ˆç›¸ä¼¼ï¼‰ï¼Œè€Œä¸”å—é™äºä½åˆ†è¾¨ç‡çš„è¾“å…¥ã€‚\näºæ˜¯ä½œè€…é‡‡ç”¨æ•´åˆé¢å¤–çš„vision-only self-supervised encodersï¼ˆä¸ä¾èµ–è¯­è¨€ä¿¡æ¯ï¼ŒåªåŸºäºå›¾åƒæ•°æ®è¿›è¡Œè‡ªç›‘ç£å­¦ä¹ çš„ç¼–ç å™¨æ¨¡å‹ã€‚å®ƒé€šè¿‡å¯¹å›¾åƒè‡ªèº«çš„ç‰¹å¾æå–å’Œå­¦ä¹ ï¼Œç”Ÿæˆå›¾åƒçš„ç‰¹å¾è¡¨ç¤ºï¼‰æ¥å¢å¼ºå¤šæ¨¡æ€æ¨¡å‹çš„è§†è§‰èƒ½åŠ›ã€‚ä½œè€…é€‰æ‹©äº†SAM-Bé«˜åˆ†è¾¨ç‡è§†è§‰ç¼–ç å™¨ã€‚\nå…·ä½“æ¥è¯´ï¼š\nå›¾åƒ â†’ ç¼©æ”¾åˆ°1024Ã—1024 â†’ SAM-B â†’ 64Ã—64Ã—256 ç‰¹å¾å›¾ï¼ˆç›¸å½“äºä¸€å¼ å›¾ç‰‡åˆ†ä¸º64Ã—64å—ï¼Œæ¯å—16Ã—16ï¼Œæ¯å—ç‰¹å¾ç»´åº¦ä¸º256ï¼‰ 64Ã—64Ã—256 â†’ VL é€‚é…å™¨ â†’ æ’å€¼æ‰©å±•ä¸º96Ã—96Ã—256 96Ã—96Ã—256 â†’ 2 ä¸ªæ­¥é•¿ä¸º 2 çš„å·ç§¯ â†’ 24Ã—24Ã—1024 â†’ é‡å¡‘ä¸º 576Ã—1024 ä½åˆ†è¾¨ç‡å›¾åƒ â†’ SigLIP-L â†’ 576Ã—1024 ç‰¹å¾å›¾ ä¸¤ä¸ª 576Ã—1024 ç‰¹å¾æ‹¼æ¥ â†’ 576Ã—2048 è§†è§‰æ ‡è®° ç» GeLU å’ŒåµŒå…¥å±‚ â†’ ä¸è¯­è¨€æ¨¡å‹è¿æ¥ Vision-Language Adaptorï¼šé‡‡ç”¨åŒå±‚æ··åˆå¤šå±‚æ„ŸçŸ¥æœºï¼ˆtwo-layer hybrid MLPï¼‰ã€‚é¦–å…ˆï¼Œåˆ†åˆ«ä½¿ç”¨ç‹¬ç«‹çš„å•å±‚MLPå¤„ç†é«˜åˆ†è¾¨ç‡ç‰¹å¾å’Œä½åˆ†è¾¨ç‡ç‰¹å¾ã€‚éšåï¼Œå°†è¿™äº›ç‰¹å¾æŒ‰ç»´åº¦æ‹¼æ¥ï¼Œå¹¶é€šè¿‡å¦ä¸€å±‚MLPè½¬æ¢ä¸ºLLMçš„è¾“å…¥ç©ºé—´ã€‚\nLanguage Modelï¼šè¯­è¨€æ¨¡å‹ä½¿ç”¨DeepSeek LLMï¼Œå…¶å¾®æ¶æ„å¤§å¤šæ¨¡ä»¿LLaMAã€‚ä½¿ç”¨RMSNormè¿›è¡ŒPre-Normåœ¨å‰é¦ˆç½‘ç»œä¸­é‡‡ç”¨SwiGLUä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œä¸­é—´å±‚ç»´åº¦ä¸º$\\frac{8}{3}d_{model}$ã€‚æ­¤å¤–ï¼Œåœ¨ä½ç½®ç¼–ç ä¸­é‡‡ç”¨äº†æ—‹è½¬ç¼–ç ã€‚ä½¿ç”¨DeepSeekç›¸åŒçš„åˆ†è¯å™¨ã€‚é€‰ç”¨DeepSeekçš„ä¸­é—´æ£€æŸ¥ç‚¹ç»§ç»­é¢„è®­ç»ƒã€‚\nå…·ä½“æ¥è¯´ï¼ŒDeepSeek-VL-1Bæ¨¡å‹æ˜¯åŸºäºDeekSeek-LLM-1Bæ¨¡å‹æ„å»ºçš„ï¼Œè¯¥æ¨¡å‹ä½¿ç”¨äº†çº¦5000äº¿æ–‡æœ¬æ ‡è®°çš„è¯­æ–™åº“è¿›è¡Œè®­ç»ƒã€‚è€ŒDeekSeek-VL-7Bæ¨¡å‹åˆ™æ˜¯åŸºäºDeepSeek-LLM-7Bæ¨¡å‹å¼€å‘çš„ï¼Œåè€…ä½¿ç”¨äº†ä¼°è®¡2ä¸‡äº¿æ–‡æœ¬æ ‡è®°è¿›è¡Œè®­ç»ƒã€‚\n3.2 Training Pipelines åŒ…å«ä¸‰ä¸ªé˜¶æ®µ\nStage 1ï¼‰è®­ç»ƒVision-Language Adaptor\nå°†è§†è§‰ç¼–ç å™¨å’ŒLLMå†»ç»“ï¼Œä½¿ç”¨1.25million å›¾æ–‡å¯¹ï¼ˆæ¥è‡ªShareGPT4Vï¼‰å’Œ2.5million æ–‡æ¡£OCRæ•°æ®è®­ç»ƒVL adaptorã€‚\nç›®çš„æ˜¯åœ¨åµŒå…¥ç©ºé—´ä¸­å»ºç«‹è§†è§‰ä¸è¯­è¨€çš„æ¦‚å¿µè¿æ¥ï¼Œå¸®åŠ©LLMå…¨é¢ç†è§£å›¾åƒä¸­çš„å®ä½“ã€‚\nç›¸è¾ƒäºLLMï¼ŒVL-adaptorså‚æ•°é‡è¾ƒå°ï¼ˆæ¯”å¦‚ä¸¤å±‚çš„MLPï¼‰ï¼Œé™åˆ¶äº†è¯¥é˜¶æ®µå­¦ä¹ çš„èƒ½åŠ›ã€‚ä½œè€…é€šè¿‡å®éªŒè¯æ˜ï¼Œåœ¨stage 1æ‰©å¤§æ•°æ®è§„æ¨¡åè€Œä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚law of data scalingä¸èµ·ä½œç”¨ã€‚\nStage 2ï¼‰Joint Vision-Language pretraining\nå†»ç»“vision ecoderï¼Œå°†LLMå’ŒVL adaptorè”åˆè®­ç»ƒã€‚\nä½œè€…ä¸€å¼€å§‹ä»…ä½¿ç”¨å¤šæ¨¡æ€æ•°æ®è®­ç»ƒLLMï¼Œåœ¨æ¨¡å‹å¤šæ¨¡æ€èƒ½åŠ›ä¸Šå‡çš„åŒæ—¶ï¼Œè¯­è¨€èƒ½åŠ›å´è¿…é€Ÿä¸‹é™ã€‚è¿™æ˜¯å¯èƒ½æ˜¯å› ä¸ºï¼š1ï¼‰å¤šæ¨¡æ€æ•°æ®åœ¨è¯­è¨€ä¸Šçš„ç®€å•åŒ–ï¼Œä¸è¯­è¨€æ•°æ®çš„å¤æ‚æ€§å’Œåˆ†å¸ƒå­˜åœ¨å·¨å¤§å·®å¼‚ï¼›2ï¼‰å¤šæ¨¡æ€ä¸è¯­è¨€æ¨¡æ€å­˜åœ¨ç«äº‰å…³ç³»ï¼Œå¯¼è‡´LLMå‡ºç°ç¾éš¾æ€§é—å¿˜ã€‚\nå› æ­¤ï¼Œä½œè€…åœ¨è®­ç»ƒä¸­è¿›è¡Œäº†å¤šæ¨¡æ€æ•°æ®å’Œè¯­è¨€æ•°æ®çš„å¹³è¡¡ã€‚ä½œè€…é€šè¿‡ä¸åŒæ¯”ä¾‹çš„æ•°æ®å®éªŒå‘ç°ï¼š1ï¼‰åŠ å…¥è¯­è¨€æ•°æ®èƒ½ç¼“è§£è¯­è¨€èƒ½åŠ›é€€åŒ–ï¼›2ï¼‰åŠ å…¥è¯­è¨€æ•°æ®ä¸ä¼šå¯¼è‡´å¤šæ¨¡æ€èƒ½åŠ›ä¸‹é™ï¼›3ï¼‰ä¸åŒæ¨¡æ€çš„è¡¨ç°ä¸æ•°æ®é›†æ¯”ä¾‹é«˜åº¦ç›¸å…³ï¼Œå¤šæ¨¡æ€ï¼šè¯­è¨€å¤§çº¦åœ¨3ï¼š7æœ€ä½³ã€‚\nè€ƒè™‘åˆ°7Bæ¨¡å‹è®­ç»ƒè¿‡äºè€—æ—¶ï¼Œå¯ä»¥å…ˆè®­ç»ƒ1.3Bçš„æ¨¡å‹ï¼Œå†é€æ­¥æ‰©å±•åˆ°7Bæ¨¡å‹ã€‚é€šè¿‡SFTï¼Œ1.3Bæ¨¡å‹çš„çŸ¥è¯†å¯ä»¥æœ‰æ•ˆçš„ä¼ é€’åˆ°7Bæ¨¡å‹ä¸­ã€‚\nç„¶è€Œï¼Œåœ¨ç¬¬äºŒé˜¶æ®µçš„è®­ç»ƒä¸­ï¼Œ1.3Bæ¨¡å‹çš„æŒ‡æ ‡å‡ºç°å‰§çƒˆæ³¢åŠ¨ï¼Œä½¿å¾—è®­ç»ƒè¿‡ç¨‹éš¾ä»¥ç›‘ç£ã€‚è¿™ä¸€ç°è±¡ä¹‹å‰æœ‰å…³ç›¸å…³æ¢è®¨ï¼šå°½ç®¡æ¨¡å‹å®¶æ—çš„å•ä¸ªè¯é”™è¯¯ç‡ä¼šéšç€è§„æ¨¡æ‰©å¤§è€Œå¹³ç¨³ã€æŒç»­ä¸”å¯é¢„æµ‹åœ°å˜åŒ–ï¼Œä½†ç ”ç©¶è€…é€‰æ‹©çš„æµ‹é‡æ–¹æ³•ä»å¯èƒ½å¼•å‘å‰§çƒˆä¸”ä¸å¯é¢„æµ‹çš„å˜åŒ–ã€‚ä½œè€…åæ¥æ‰¾åˆ°äº†é—®é¢˜çš„æ ¹æºï¼š1.3Bæ¨¡å‹å®¹é‡æœ‰é™ï¼Œå†åŠ ä¸Šè®­ç»ƒæ•°æ®é›†ä¸­ç¼ºä¹SFTæ•°æ®ï¼Œé˜»ç¢äº†æ¨¡å‹å‡†ç¡®æ‰§è¡Œå‘½ä»¤ï¼Œå³ä½¿æŒæ¡äº†æ­£ç¡®çš„çŸ¥è¯†ä¹Ÿéš¾ä»¥ç²¾å‡†ç”Ÿæˆé€‰é¡¹ã€‚\nä¸ºäº†åº”å¯¹è¿™äº›é—®é¢˜ï¼Œä½œè€…é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š1ï¼‰é‡‡ç”¨Multi-choice PPL methodologyæ¥ç›‘ç£æ¨¡å‹è¿›å±•ã€‚é™¤äº†è¾“å…¥å›¾ç‰‡å’Œpromptï¼Œè¿˜è¾“å…¥ä¸é—®é¢˜ç›¸å…³çš„ç­”æ¡ˆã€‚é€šè¿‡è®¡ç®—æ¯ä¸ªå€™é€‰ç­”æ¡ˆçš„PPLå€¼æ¥ç¡®å®šæ¨¡å‹æœ€ç»ˆçš„è¾“å‡ºã€‚ï¼ˆæ—¢ç„¶ç”Ÿæˆä¸ç¨³å®šï¼Œå°±ä¸ç”Ÿæˆï¼Œç›´æ¥é€‰æ‹©ï¼‰ï¼›2ï¼‰åœ¨è®­ç»ƒæ•°æ®é›†ä¸­åŠ å…¥å°‘é‡STFæ•°æ®ï¼Œè®©æ¨¡å‹åœ¨éµå¾ªæŒ‡ä»¤æ–¹é¢è·å¾—ä¸€å®šç†Ÿç»ƒåº¦ã€‚\nè¿™ä¸¤ç§æ–¹æ³•çš„ç»“åˆç¡®ä¿äº†1.3Bæ¨¡å‹è®­ç»ƒæŒ‡æ ‡çš„ç¨³å®šæ€§ã€‚\nStage3ï¼‰SFT\nå¢å¼ºæ¨¡å‹éµå¾ªæŒ‡ä»¤å’Œå‚ä¸å¯¹è¯çš„èƒ½åŠ›ã€‚\nå¯¹VL-adaptorã€LLMã€hybrid vision encoderè¿›è¡Œå¾®è°ƒã€‚ç”±äºGPUå†…å­˜å®¹é‡æœ‰é™ï¼ŒSAM-Bä»å†»ç»“ã€‚\nä»…å¯¹ç­”æ¡ˆå’Œç‰¹æ®Šæ ‡è®°è¿›è¡Œç›‘ç£ï¼Œå±è”½ç³»ç»Ÿæç¤ºå’Œç”¨æˆ·è¾“å…¥ã€‚ç­”æ¡ˆæ˜¯æ¨¡å‹ç”Ÿæˆçš„ç»“æœï¼Œç‰¹æ®Štokenæ˜¯å¯¹è¯ä¸­ç”¨äºæ ‡è®°çš„ç‰¹æ®Šç¬¦å·ã€‚ä¹Ÿå°±æ˜¯æŸå¤±å‡½æ•°åªçœ‹è¾“å‡ºä¸çœ‹è¾“å…¥ã€‚\n3.3 Hyperparameters and Infrastructres ä½¿ç”¨è½»é‡çº§åˆ†å¸ƒå¼è®­ç»ƒæ¡†æ¶HAI-LLMè¿›è¡ŒDeepSeek-VLçš„è®­ç»ƒä¸è¯„ä¼°ã€‚\nå°†è§†è§‰ç¼–ç å’Œæ–‡æœ¬åµŒå…¥è§†ä¸ºä¸€ä¸ªæ¨¡å—ï¼ŒæŠŠå®ƒä½œä¸ºæœ€ç»ˆæ¨¡å‹çš„ç¬¬ä¸€å±‚ã€‚è¿™ä¸ªæ¨¡å—æœ‰ç€å¤æ‚çš„æ¨¡å‹æ¶æ„ï¼Œæ ‡å‡†çš„å¼ é‡å¹¶è¡ŒæŠ€æœ¯æ— æ³•ä½¿ç”¨ï¼Œä½†æ˜¯ä¸ä¸Šå±‚çš„transformeræ¨¡å—ç›¸æ¯”ï¼Œå…¶è®¡ç®—é‡ç›¸å¯¹è¾ƒå°ã€‚æˆ‘ä»¬åªéœ€åœ¨æ‰€æœ‰å¼ é‡å¹¶è¡Œç»´åº¦ä¸Šé‡æ–°è®¡ç®—è§†è§‰ç¼–ç å™¨çš„å‰å‘ä¼ æ’­è¿‡ç¨‹ã€‚\nvisual encodersè¿˜ä½¿å¾—æ¨¡å‹å„å±‚çš„æ‰§è¡Œæ—¶é—´ä¸åŒï¼Œæ‰€ä»¥æˆ‘ä»¬é‡æ–°åˆ’åˆ†æ¨¡å‹å±‚çº§æ¥å®ç°æ›´å¥½çš„è´Ÿè½½å‡è¡¡å’Œååé‡ã€‚DeepSeek-VLçš„ä¸Šå±‚ç»“æ„å’ŒDeepSeekLLMä¸€è‡´ã€‚\né€šè¿‡è¿™ç§å¾®è°ƒï¼Œæˆ‘ä»¬å¯ä»¥é‡‡ç”¨Megatronä¸­çš„æ ‡å‡†3Då¹¶è¡ŒæŠ€æœ¯ã€‚ä»¥åŠDeepSeek-LLMä¸­çš„é‡å è®¡ç®—ä¸é€šä¿¡æœºåˆ¶ã€‚\nåœ¨64èŠ‚ç‚¹é›†ç¾¤ä¸Šè¿è¡Œæ—¶ï¼ŒDeepSeek-VL- 7Bè€—æ—¶5å¤©ï¼Œæ¯ä¸ªèŠ‚ç‚¹é…å¤‡8ä¸ªNvidia A100 GPUï¼›è€Œåœ¨åŒ…å«16ä¸ªèŠ‚ç‚¹çš„é…ç½®ä¸‹ï¼ŒDeepSeek-VL-1Båˆ™éœ€è¦7å¤©æ—¶é—´ã€‚\nå…¶ä½™è¶…å‚æ•°å¦‚ä¸‹æ‰€ç¤ºï¼š\n4. Evaluation 4.1 å…¬å¼€å¤šæ¨¡æ€benchmark å¤šæ¨¡æ€ç†è§£æ•°æ®é›†ï¼šMMMUã€CMMMUç­‰\nå›¾è¡¨ç†è§£ï¼šOCRBenchç­‰\nå¹»è§‰ï¼šPOPE\nç§‘å­¦é—®é¢˜ï¼šScienceQAã€MathVista\né‡‡ç”¨åŸºäºç”Ÿæˆçš„è¯„ä¼°æ–¹æ³•ï¼ˆå…³æ³¨æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬ç»“æœï¼Œå°†å…¶ä¸groundtruthå¯¹æ¯”ï¼‰ï¼Œç»“åˆè´ªå¿ƒè§£ç æŠ€æœ¯ï¼ˆåœ¨ç”Ÿæˆæ¯ä¸ª tokenæ—¶ï¼Œå§‹ç»ˆé€‰æ‹©å½“å‰æ¦‚ç‡æœ€é«˜çš„ tokenï¼Œè€Œä¸è€ƒè™‘æœªæ¥å¯èƒ½çš„æœ€ä¼˜é€‰æ‹©ï¼‰ã€‚\nDeekSeek-VL-7Bè¶…è¿‡äº†å¤§å¤šæ•°åŒè§„æ¨¡çš„å¼€æºæ¨¡å‹ï¼Œå’Œæ¯”é—­æºæ¨¡å‹ä»æœ‰å·®è·ï¼Œè¿™ç§å·®å¼‚å¯èƒ½æºäºåŸºç¡€æ¨¡å‹è§„æ¨¡çš„å·®å¼‚ã€‚\nDeepSeek-VL-1.3Båœ¨åŒç±»è§„æ¨¡æ¨¡å‹ä¸­è¡¨ç°æ˜¾è‘—æ›´ä¼˜ã€‚åœ¨MMBåŸºå‡†æµ‹è¯•ä¸­ï¼Œå…¶æ€§èƒ½è¶…è¶Šäº†ä¸»æµå¼€æºæ¨¡å‹ï¼Œè€Œå‚æ•°é‡ä»…ä¸ºå…¶çº¦ä¸€åŠï¼Œ1.3B vs 2.7Bã€‚\n4.2 å…¬å¼€è¯­è¨€benchmark å¤šä¸»é¢˜å¤šé€‰ï¼šMMLU\nè¯­è¨€ç†è§£å’Œæ¨ç†ï¼šHellaSwag\nè¯­è¨€å»ºæ¨¡ï¼šPile\næ•°å­¦ï¼šGSM8K\nç¼–ç¨‹ï¼šMBPP\næ ‡å‡†è€ƒè¯•ï¼šAGIEval\nå¯¹äºä»å¤šä¸ªç­”æ¡ˆè¿›è¡Œé€‰æ‹©çš„æ•°æ®é›†ï¼ˆHellaSwagã€MMLUï¼‰ï¼Œé‡‡ç”¨å›°æƒ‘åº¦è¯„ä¼°ï¼Œé€‰æ‹©å›°æƒ‘åº¦æœ€å°çš„é€‰é¡¹ä½œä¸ºæœ€ç»ˆé€‰æ‹©ã€‚åŸºäºå›°æƒ‘åº¦çš„è¯„ä¼°æ–¹æ³•èƒ½æœ‰æ•ˆåŒºåˆ†æ¨¡å‹é¢„æµ‹é—´çš„ç»†å¾®æ¦‚ç‡å·®å¼‚ï¼Œé¿å…äº†ç²¾ç¡®åŒ¹é…å¼è¯„ä¼°å¸¦æ¥çš„ä¸è¿ç»­æ€§é—®é¢˜ã€‚\né’ˆå¯¹GSM8Kå’ŒAGIEvalæ•°æ®é›†ï¼Œæˆ‘ä»¬é‡‡ç”¨åŸºäºç”Ÿæˆçš„è¯„ä¼°æ–¹æ³•ç»“åˆè´ªå¿ƒè§£ç æŠ€æœ¯ã€‚è¿™é‡Œçš„ç”Ÿæˆè¯„ä¼°å…·ä½“æŒ‡è®©æ¨¡å‹è‡ªåŠ¨ç”Ÿæˆè‡ªç”±æ–‡æœ¬ï¼Œå¹¶è§£æç”Ÿæˆæ–‡æœ¬çš„è§£æç»“æœã€‚\næˆ‘ä»¬é‡‡ç”¨åŸºäºè¯­è¨€æ¨¡å‹çš„è¯„ä¼°æ–¹æ³•è¿›è¡Œå †æµ‹è¯•ï¼Œå³è®¡ç®—æµ‹è¯•è¯­æ–™åº“çš„æ¯å­—èŠ‚æ¯”ç‰¹æ•°ã€‚\nå¯ä»¥è§‚å¯Ÿåˆ°ï¼Œåœ¨å¤§å¤šæ•°è¯­è¨€åŸºå‡†æµ‹è¯•ä¸­ï¼ŒDeepSeek-VLçš„è¡¨ç°ä¸DeepSeek-7Bç›¸å½“ç”šè‡³æ›´èƒœä¸€ç­¹ã€‚ä¾‹å¦‚ï¼Œåœ¨ä½œä¸ºé€šç”¨è¯­è¨€èƒ½åŠ›è¯„ä¼°åŸºå‡†çš„HellaSwagæ•°æ®é›†ä¸Šï¼Œå…¶å¾—åˆ†è¾¾åˆ°68.4åˆ†ï¼Œè€ŒDeepSeek-7Bä¸º68.5åˆ†ã€‚åœ¨MMLUå’ŒAGIEvalç­‰æŒ‡æ ‡ä¸Šï¼ŒDeepSeek-VLæ›´èƒœä¸€ç­¹ï¼Œè¿™è¡¨æ˜å¤šæ¨¡æ€è®­ç»ƒæ–¹æ³•ç”šè‡³å¯èƒ½åŠ©åŠ›è¯­è¨€ä»»åŠ¡ã€‚ç„¶è€Œï¼ŒDeepSeek-VL-7Båœ¨æ•°å­¦æµ‹è¯•ï¼ˆGSM8Kï¼‰ä¸­å‡ºç°ä¸€å®šç¨‹åº¦çš„é€€æ­¥ï¼Œè¿™è¯´æ˜å°½ç®¡è§†è§‰ä¸è¯­è¨€æ¨¡æ€é—´çš„åè°ƒæ€§å¾—åˆ°æå‡ï¼ŒäºŒè€…ä¹‹é—´ä»å­˜åœ¨ç«äº‰å…³ç³»ã€‚è¿™å¯èƒ½å½’å› äºæ¨¡å‹å®¹é‡æœ‰é™ï¼ˆ7Bï¼‰ï¼Œè€Œæ›´å¤§è§„æ¨¡çš„æ¨¡å‹æˆ–è®¸èƒ½æ˜¾è‘—ç¼“è§£è¿™ä¸€é—®é¢˜ã€‚æ€»ä½“è€Œè¨€ï¼ŒDeepSeek-VLè‡´åŠ›äºåœ¨åº”å¯¹è¿™äº›æŒ‘æˆ˜çš„åŒæ—¶ï¼Œå®ç°è¯­è¨€èƒ½åŠ›ä¸‹é™å¹…åº¦æœ€å°åŒ–çš„ç›®æ ‡ã€‚\n4.3 Human Evaluation ä½œè€…å›¢é˜Ÿæ„å»ºäº†äººå·¥è¯„ä¼°æ•°æ®é›†ï¼ŒåŒ…å«100ä¸ªé—®é¢˜ï¼ŒåŒ…å«7ä¸ªç±»åˆ«ï¼Œä¸SFTçš„åˆ†ç±»ä¸€è‡´ã€‚\nDeepSeek-VL-7Bä¸InternLM-XComposer2-VLã€CogVLMåŠGPT- 4Vè¿›è¡Œå¯¹æ¯”\nGPT- 4Våœ¨å¤šæ•°ç»´åº¦å‡å±•ç°å‡ºå“è¶Šæ€§èƒ½ï¼Œè€Œæ‰€æœ‰å¼€æºæ¨¡å‹åœ¨é€»è¾‘æ¨ç†æ–¹é¢ä»è¿œé€ŠäºGPT- 4Vï¼Œè¿™å‡¸æ˜¾äº†æ‰©å¤§å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰è§„æ¨¡çš„å¿…è¦æ€§ã€‚DeepSeek-VL-7Båœ¨æ•´ä½“è¡¨ç°ä¸Šæ›´èƒœä¸€ç­¹ï¼Œåœ¨è¯†åˆ«ã€è½¬æ¢å’Œå¸¸è¯†æ¨ç†ç­‰ä»»åŠ¡ä¸­æ¥è¿‘GPT- 4Vçš„æ°´å¹³ã€‚\næ­¤å¤–è¿˜è¿›è¡Œäº†LLMè¯„ä¼°ï¼Œä½¿ç”¨GPT-4Vå¯¹ä¸¤ç§æ¨¡å‹çš„ç­”æ¡ˆè¿›è¡Œè¯„ä¼°ã€‚å¤šæ•°æƒ…å†µä¸‹DeekSeek-VLçš„å›ç­”æ›´å—é’çã€‚\n4.4 Ablation Study Scale up Projector Training\nåœ¨stage1 é€æ¸æ‰©å¤§æ•°æ®é›†ï¼Œä½†æ€§èƒ½å¹¶æœªæå‡ã€‚è¯´æ˜projectorçš„å®¹é‡æœ‰é™ï¼Œæ— æ³•æ•æ‰å¤šæ¨¡æ€ä»»åŠ¡æ‰€éœ€çš„å¹¿æ³›çŸ¥è¯†ã€‚\nTraining Stage\nå¯¹æ¯”ä½¿ç”¨ä¸åŒè®­ç»ƒé˜¶æ®µçš„ç»„åˆï¼ˆ1+3ï¼Œ2+3ï¼Œ1+2+3ï¼‰ï¼Œä¸‰é˜¶æ®µè”åˆä½¿ç”¨æ•ˆæœæœ€å¥½ã€‚æ­¤å¤–ï¼Œ2+3æ•ˆæœå·®äº1+2+3ï¼Œè¯´æ˜äº†VL adaptoré¢„çƒ­çš„å¿…è¦æ€§ã€‚\nModality Group Training\nå½“è¯­è¨€æ•°æ®å’Œå¤šæ¨¡æ€æ•°æ®æ··åˆæ—¶ï¼Œå‘ç°ç›´æ¥åœ¨batchå±‚é¢æ··åˆæ˜¾è‘—é™ä½è®­ç»ƒæ•ˆç‡ã€‚è¿™æ˜¯å› ä¸ºè¦ç­‰å¾…è®¡ç®—è¾ƒæ…¢çš„å¤šæ¨¡æ€æ ·æœ¬å®Œæˆåæ‰èƒ½æ¢¯åº¦åå‘ä¼ æ’­ï¼Œæ‹–æ…¢äº†æ•´ä½“é€Ÿåº¦ã€‚\nä½œè€…åœ¨æ¯ä¸ªglobal stepä¸Šå°†ä¸åŒæ¨¡æ€çš„æ•°æ®åˆ†å¼€ï¼Œbatchå†…åªåŒ…å«è¯­è¨€æˆ–å¤šæ¨¡æ€æ•°æ®ã€‚è¿™ç§æ–¹æ³•æå‡äº†æ¨¡å‹è®­ç»ƒæ•ˆç‡ä¸”ä¸ä¼šå½±å“æ€§èƒ½ã€‚\nModality Warmup\nè‹¥ä¸€å¼€å§‹å°±æŒ‰æ¯”ä¾‹æ··åˆå¤šæ¨¡æ€æ•°æ®ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ¨¡å‹ä¸ç¨³å®šã€‚åˆå§‹é˜¶æ®µå…ˆå°†è¯­è¨€æ•°æ®æ¯”ä¾‹è®¾ä¸º1ï¼Œå†é€æ¸é™ä½è‡³æœ€ç»ˆè®­ç»ƒç›®æ ‡å€¼ï¼Œèƒ½é¿å…è®­ç»ƒåˆæœŸæ¨¡å‹è¯­è¨€èƒ½åŠ›ä¸‹é™ï¼ŒåŒæ—¶åœ¨è¯­è¨€å’Œå¤šæ¨¡æ€é¢†åŸŸåæœŸå‡å–å¾—æ›´ä¼˜æ•ˆæœã€‚\nVision Encoder Selection\nä¸ºäº†æé«˜è·å–å’Œåˆ©ç”¨å›¾åƒä¿¡æ¯çš„èƒ½åŠ›ï¼Œå¯¹æ¯”äº†ä¸åŒè§†è§‰ç¼–ç å™¨çš„è®­ç»ƒæŸå¤±ã€‚å¼•å…¥çº¯è§†è§‰ç¼–ç å™¨SAMåœ¨LossæŒ‡æ ‡ä¸Šæœ‰æ˜¾è‘—æå‡ã€‚æ‰€ä»¥æœ€ç»ˆé‡‡ç”¨SigLP+SAMçš„æ–¹æ¡ˆã€‚\nVision-Language Adaptor Design\nä¸ºäº†æé«˜ä»è§†è§‰ç¼–ç å™¨ä¸­æå–ä¿¡æ¯çš„æ•ˆç‡ï¼Œä¸”éµå¾ªå½“å‰çš„tokené•¿åº¦é™åˆ¶ï¼Œæœ‰ä¸¤ç§æ–¹å¼æ¥è°ƒæ•´VL Adaptorï¼šè§†è§‰ç‰¹å¾çš„ç»„åˆæ–¹æ³•å’ŒMLP adaptorçš„è®¾è®¡ã€‚\nå…ˆå‰ç ”ç©¶è¡¨æ˜ï¼Œæ²¿åºåˆ—ç»´åº¦æ•´åˆè§†è§‰ç‰¹å¾èƒ½æå‡æ¨¡å‹æ€§èƒ½ï¼Œä½†è¿™ä¹Ÿæ„å‘³ç€éœ€è¦è§†è§‰ç‰¹å¾æ ‡è®°çš„åºåˆ—å˜é•¿ï¼Œè®¡ç®—å¼€é”€å¢å¤§ã€‚åœ¨åºåˆ—æ‹¼æ¥ä¹‹å‰ï¼Œæ²¿å›¾åƒå®½æˆ–é«˜å¯¹è§†è§‰ç‰¹å¾è¿›è¡Œå †å ï¼Œä¸æ¯”ç›´æ¥æ²¿åµŒå…¥ç»´åº¦åˆå¹¶æ•ˆæœå¥½ã€‚\nï¼ˆToken Pooling - Wï¼š[H,W,C]ï¼ŒæŠŠæ¯ä¸€é«˜åº¦çš„Wæ–¹å‘ä½œæ± åŒ–ï¼Œå¾—åˆ°[H,C]ï¼Œç„¶åæ¥åœ¨æ–‡æœ¬åºåˆ—åé¢ï¼›Token Pooling - Håˆ™æ˜¯æŠŠé«˜åº¦æ–¹å‘å‹ç¼©ï¼‰\nåœ¨adaptoræ¶æ„æ–¹é¢ï¼Œæ¯ä¸ªè§†è§‰ç‰¹å¾ç¼–ç å™¨å•ç‹¬ä½¿ç”¨MLP adaptorå¯ä»¥æ›´ç²¾ç¡®åœ°è°ƒæ•´è§†è§‰ç‰¹å¾çš„å…·ä½“å€¼å’Œåˆ†å¸ƒæ¨¡å¼ï¼Œä¿ƒè¿›æ›´å¹³ç¨³çš„æ¨¡å‹è®­ç»ƒã€‚ä¸ºä¸åŒçš„è§†è§‰ç¼–ç å™¨ä½¿ç”¨å…±äº«çš„MLPé€‚é…å™¨æœ‰åŠ©äºè¶³å¤Ÿçš„ç‰¹å¾èåˆã€‚ä½œè€…é‡‡ç”¨äº†æ··åˆç­–ç•¥ã€‚\nConclusionã€Limitation and Future Work\nä»‹ç»äº†DeepSeek-VLï¼Œä¸€ä¸ªç³»åˆ—MLLMã€‚\né‡‡ç”¨äº†åˆ›æ–°çš„ä¸‰é˜¶æ®µè®­ç»ƒæ–¹æ³•ï¼Œä¿è¯äº†æ¨¡å‹çš„è¯­è¨€å’Œå¤šæ¨¡æ€èƒ½åŠ›ã€‚\né›†æˆäº†æ··åˆè§†è§‰ç¼–ç å™¨ï¼Œèƒ½å¤„ç†é«˜åˆ†è¾¨ç‡å›¾åƒï¼Œåœ¨å„ç±»æµ‹è¯•ä¸­è¡¨ç°ä¼˜å¼‚ã€‚\næœªæ¥å°†è¿›ä¸€æ­¥æ‰©å¤§æ¨¡å‹è§„æ¨¡ï¼Œå¹¶å¼•å…¥MoEæŠ€æœ¯ã€‚\nå¼€æºä¸‡å²ï¼\n","permalink":"https://Rook1eChan.github.io/posts/deepseekvl/","summary":"\u003ch1 id=\"deepseek-vl-towards-real-world-vision-language-understanding\"\u003eDeepSeek-VL: Towards Real-World Vision-Language Understanding\u003c/h1\u003e\n\u003ch2 id=\"0-abstract\"\u003e0. Abstract\u003c/h2\u003e\n\u003cp\u003eæœ¬æ–‡çš„ä¸»è¦è´¡çŒ®ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eæ•°æ®é›†æ„å»ºï¼šæ„å»ºäº†å…·æœ‰å¤šæ ·æ€§å’Œå¯æ‰©å±•æ€§ï¼Œå¹¿æ³›è¦†ç›–çœŸå®ä¸–ç•Œåœºæ™¯çš„æ•°æ®é›†ã€‚åŒ…æ‹¬ç½‘é¡µæˆªå›¾ã€PDFæ–‡æ¡£ã€OCRæ–‡æœ¬ã€å›¾è¡¨ä»¥åŠçŸ¥è¯†å‹å†…å®¹ï¼ˆå¦‚ä¸“å®¶çŸ¥è¯†ã€æ•™ç§‘ä¹¦ï¼‰ç­‰ã€‚æ­¤å¤–ï¼Œæ ¹æ®çœŸå®ç”¨æˆ·åœºæ™¯å°†æ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æ®æ­¤åˆ›å»ºäº†æŒ‡ä»¤å¾®è°ƒæ•°æ®é›†ã€‚é€šè¿‡è¯¥æ•°æ®é›†çš„å¾®è°ƒï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹åœ¨å®é™…åº”ç”¨ä¸­çš„ç”¨æˆ·ä½“éªŒã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eåˆ›æ–°çš„æ¨¡å‹æ¶æ„ï¼šé‡‡ç”¨äº†æ··åˆè§†è§‰ç¼–ç å™¨ï¼ˆhybrid vision encoderï¼‰ï¼Œèƒ½åœ¨å›ºå®šçš„tokené¢„ç®—ä¸‹é«˜æ•ˆå¤„ç†é«˜åˆ†è¾¨ç‡å›¾åƒï¼ˆ1024*1024ï¼‰ï¼ŒåŒæ—¶ä¿æŒè¾ƒä½çš„è®¡ç®—å¼€é”€ã€‚è¯¥æ¶æ„ä¿è¯æ¨¡å‹å¤šç§è§†è§‰ä»»åŠ¡ä¸­èƒ½æ•æ‰åˆ°å…³é”®çš„è¯­ä¹‰å’Œç»†èŠ‚ä¿¡æ¯ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eåˆ›æ–°çš„è®­ç»ƒç­–ç•¥ï¼šæ—¢ä½¿LLMå­¦ä¼šæ–°æ¨¡æ€ï¼Œä¹Ÿä¿è¯åŸæœ‰çš„çš„è¯­è¨€èƒ½åŠ›ä¸é€€åŒ–ã€‚è°ƒæ§è¯­è¨€å’Œè§†è§‰çš„ç«äº‰å…³ç³»ï¼Œå®ç°ä¸¤ç§æ¨¡æ€çš„å‡è¡¡èåˆã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cBR\u003e\n\u003ch2 id=\"1-introduction\"\u003e1. Introduction\u003c/h2\u003e\n\u003cp\u003eå¤§è¯­è¨€æ¨¡å‹çš„å·¨å¤§æˆåŠŸå¼•å‘äº†äººä»¬å¯¹å¤šæ¨¡æ€æ¨¡å‹çš„è¿½æ±‚ã€‚è¿™äº›æ¨¡å‹èƒ½åŒæ—¶ç†è§£è¯­è¨€å’Œå›¾åƒï¼Œåœ¨æ‰§è¡Œç°å®ä¸–ç•Œä»»åŠ¡æ—¶å±•ç°å‡ºå·¨å¤§çš„æ½œåŠ›ã€‚\u003c/p\u003e\n\u003cp\u003eç›®å‰å‡ºç°äº†å¾ˆå¤šå¼€æºçš„VLMæ–¹æ¡ˆï¼Œåœ¨benchmarkä¸Šè¡¨ç°ä¼˜ç§€ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­è¡¨ç°ä¸ä½³ã€‚å¤§éƒ½å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼ˆæœ¬æ–‡çš„æ”¹è¿›æ–¹æ¡ˆï¼‰ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eè®¸å¤šæ–¹æ¡ˆå°†é‡å¿ƒæ”¾åœ¨æŒ‡ä»¤å¾®è°ƒé˜¶æ®µã€‚ä½œè€…è®¤ä¸ºåº”å½“ä½¿ç”¨å¤§é‡çš„è§†è§‰-è¯­è¨€æ•°æ®è¿›è¡Œå……åˆ†é¢„è®­ç»ƒã€‚ï¼ˆæ·±åº¦é¢„è®­ç»ƒï¼‰\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eç°æœ‰æ–¹æ¡ˆå¤šä½¿ç”¨å­¦æœ¯ä¸Šçš„æ•°æ®é›†è¿›è¡Œå¾®è°ƒï¼Œç¼ºä¹ç°å®ä¸–ç•Œç»éªŒã€‚ï¼ˆç²¾å¿ƒæ„å»ºæ•°æ®é›†ï¼‰\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eç°æœ‰æ–¹æ¡ˆå¤šé‡‡ç”¨vision transformerä¸é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹ç»“åˆçš„æ–¹å¼ï¼Œè¿™ç±»æ¨¡å‹åˆ†è¾¨ç‡ä½ï¼Œä¸èƒ½èƒœä»»OCRæˆ–å¾®å°ç‰©ä½“è¯†åˆ«ä»»åŠ¡ã€‚ï¼ˆé«˜åˆ†è¾¨ç‡å¤„ç†æ¶æ„ï¼‰\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eæœ‰äº›æ¨¡å‹åœ¨é•¿æœŸçš„å¤šæ¨¡æ€è®­ç»ƒä¸­ä¼šå‡ºç°è¯­è¨€èƒ½åŠ›çš„é€€åŒ–ã€‚åº”é‡‡ç”¨ä¸€ç§æ—¢ä¿ç•™è¯­è¨€èƒ½åŠ›ï¼ŒåˆæŒæ¡æ–°æ¨¡æ€èƒ½åŠ›çš„è®­ç»ƒæ–¹å¼ã€‚ï¼ˆå¹³è¡¡å¤šæ¨¡æ€ç‰¹å¾çš„è®­ç»ƒç­–ç•¥ï¼‰\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cBR\u003e\n\u003cp\u003eDeepSeek-VLå…·æœ‰é€šç”¨çš„å¤šæ¨¡æ€ç†è§£èƒ½åŠ›ï¼Œèƒ½å¤Ÿå¤„ç†é€»è¾‘å›¾ã€ç½‘é¡µã€å…¬å¼è¯†åˆ«ã€ç§‘å­¦æ–‡çŒ®ã€è‡ªç„¶å›¾åƒç­‰ã€‚\u003c/p\u003e\n\u003cp\u003eDeepSeek-VLçš„ä¼˜åŠ¿ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eDeepseek-VLçš„é¢„è®­ç»ƒæ•°æ®æ¶µç›–äº†å¹¿æ³›çš„ä¸–ç•ŒçŸ¥è¯†ï¼ŒåŒ…æ‹¬ç½‘ç»œçˆ¬è™«ã€ç½‘é¡µä»£ç ã€ç”µå­ä¹¦ã€æ•™è‚²èµ„æ–™ã€arxivæ–‡ç« ç­‰ç­‰ï¼Œå…¨é¢è¦†ç›–ç°å®ä¸–ç•Œä¸­çš„åœºæ™¯ï¼Œæ•°æ®è´¨é‡é«˜ï¼Œå…·æœ‰å¹¿æ³›æ€§å’Œå®ç”¨æ€§ã€‚åŒæ—¶ä½œè€…å›¢é˜Ÿè¿˜ç²¾å¿ƒè®¾è®¡äº†æŒ‡ä»¤è°ƒä¼˜æ•°æ®é›†ï¼Œå…·ä½“æ¥è¯´ï¼Œä½œè€…ä»ç½‘ä¸Šæ”¶é›†äº†GPT-4Vå’ŒGeminiçš„çœŸå®æ¡ˆä¾‹ï¼Œå¹¶è¿›è¡Œåˆ†ç±»ï¼Œä¸ºæ¯ä¸ªæµ‹è¯•å›¾åƒé€‰æ‹©åˆé€‚çš„promptã€‚è¯¥åˆ†ç±»ä½“ç³»è¿˜ç”¨äºæ„å»ºè¯„ä¼°æ•°æ®é›†ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eè§†è§‰æ¨¡å—é‡‡ç”¨æ··åˆè§†è§‰ç¼–ç å™¨æ¶æ„ï¼Œ384$\\times$384çš„æ–‡æœ¬å¯¹é½ç¼–ç å™¨ç”¨äºç²—ç²’åº¦è¯­ä¹‰æå–ï¼Œ1024$\\times$1024çš„é«˜åˆ†è¾¨ç‡ç¼–ç å™¨ç”¨äºæ•æ‰ç»†èŠ‚è§†è§‰ä¿¡æ¯ã€‚ä¸¤è€…ç»“åˆï¼Œå¯ä»¥å°†1024$\\times$1024çš„å›¾åƒå‹ç¼©ä¸º576ä¸ªtokenï¼Œåœ¨è§†è§‰è¡¨å¾å’Œtokenå¼€é”€é—´å–å¾—å¹³è¡¡ï¼Œä½¿è§†è§‰æ¨¡å—æ”¯æŒæ–‡-å›¾äº¤ç»‡å¤„ç†å’Œå¤šè½®æ¨ç†åœºæ™¯ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eä¸ºäº†ä½¿å¤šæ¨¡æ€æ¨¡å‹ä¸å‡ºç°è¯­è¨€èƒ½åŠ›çš„é€€åŒ–ï¼š1.ä¿æŒè‡³å°‘70%çš„è¯­è¨€æ•°æ®ï¼Œè¿™å¯¹ç»´æŠ¤æ¨¡å‹å†…éƒ¨çš„è¯­è¨€çŸ¥è¯†å®Œæ•´æ€§è‡³å…³é‡è¦ã€‚2.ä½œè€…æå‡ºäº†æ¨¡æ€é¢„çƒ­(modality warm-up)ç­–ç•¥ã€‚è¯¥æ–¹æ³•é€šè¿‡åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­åŠ¨æ€è°ƒæ•´æ¨¡æ€æ¯”ä¾‹ï¼Œé€æ­¥å¼•å…¥æ›´å¤šè§†è§‰-è¯­è¨€æ•°æ®ã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eåœ¨è¿­ä»£æ¨¡å‹æ—¶ï¼Œé¦–å…ˆåœ¨å°æ¨¡å‹ä¸Šè¿›è¡Œå®éªŒã€‚ç„¶è€Œï¼Œå½¢å¦‚1Bçš„å°æ¨¡å‹åœ¨benchmarkä¸Šéš¾ä»¥å±•ç°ç†æƒ³æ€§èƒ½ï¼Œæ— æ³•çœŸå®çš„åæ˜ æ¨¡å‹çš„å®é™…è¡¨ç°ã€‚å› æ­¤ï¼Œä½œè€…æŠŠè¯„ä¼°æªæ–½ä»å¤šé€‰æ”¹ä¸ºäº†å„é€‰é¡¹çš„å›°æƒ‘åº¦ï¼ˆPPLï¼‰å¯¹æ¯”ï¼›æ­¤å¤–ï¼Œä¸ºé¿å…æŒ‡ä»¤è·Ÿéšèƒ½åŠ›æˆä¸ºç“¶é¢ˆï¼Œåœ¨é¢„è®­ç»ƒé˜¶æ®µæˆ‘ä»¬æ··åˆäº†å°‘é‡æŒ‡ä»¤è°ƒä¼˜æ•°æ®ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬æ—¢èƒ½åˆ©ç”¨1Bæ¨¡å‹è·å¾—åˆç†æ€§èƒ½è¡¨ç°ï¼Œåˆèƒ½æ›´ç²¾å‡†åœ°é‡åŒ–å®éªŒä¸­æ¯æ¬¡è¿­ä»£çš„å½±å“æ•ˆæœã€‚\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cBR\u003e\n\u003ch2 id=\"2-data-construction\"\u003e2. Data Construction\u003c/h2\u003e\n\u003cp\u003eæ•°æ®é›†åŒ…æ‹¬ä¸¤å¤§æ¨¡å—ï¼šVL-Pretrainæ•°æ®ã€VL-SFTæ•°æ®\u003c/p\u003e\n\u003cp\u003eVL-Pretrainæ•´åˆäº†å¤šæºè§†è§‰æ–‡æœ¬æ•°æ®ï¼Œæ—¨åœ¨å¼ºåŒ–æ¨¡å‹çš„åŸºç¡€è·¨æ¨¡æ€ç†è§£èƒ½åŠ›ã€‚\u003c/p\u003e\n\u003cp\u003eVL-SFTç›¸å¯¹è¾ƒå°ï¼Œä¸»è¦ç”¨äºè®­ç»ƒæ¨¡å‹å®Œæˆç‰¹å®šä¸‹æ¸¸ä»»åŠ¡ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨stage1ï¼ŒVL-Pretrainç”¨äºé¢„çƒ­VL adapter\u003c/p\u003e\n\u003cp\u003estage2ï¼ŒVL-Pretrainç”¨äºè”åˆé¢„è®­ç»ƒVL adaptorå’ŒVL model\u003c/p\u003e\n\u003cp\u003estage3ï¼Œä½¿ç”¨VL-SFTå¾®è°ƒæ•´ä¸ªæ¨¡å‹\u003c/p\u003e\n\u003cBR\u003e\n\u003ch3 id=\"21-vl-pretraining-data\"\u003e2.1 VL-Pretraining Data\u003c/h3\u003e\n\u003cp\u003eåˆ†ä¸ºä»¥ä¸‹7ä¸ªç±»åˆ«ï¼š\u003c/p\u003e\n\u003cp\u003eInterleaved image-text dataï¼ˆäº¤é”™å¼å›¾æ–‡æ•°æ®ï¼Œä½¿æ¨¡å‹å¯¹å¤šæ¨¡æ€è¾“å…¥å…·æœ‰æ›´å¥½çš„ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›ï¼‰ï¼ŒMMC4ã€Wikiç­‰\u003c/p\u003e\n\u003cp\u003eImage caption dataï¼ˆå›¾åƒæè¿°ï¼ŒåŒ…å«é«˜è´¨é‡å›¾-æ–‡å¯¹ï¼‰ï¼ŒCapsfusionã€TaiSuç­‰\u003c/p\u003e\n\u003cp\u003eTable and chart dataï¼ˆå›¾è¡¨æ•°æ®ï¼‰ï¼ŒChart2textã€Unichart\u003c/p\u003e\n\u003cp\u003eWeb Code dataï¼ˆç½‘é¡µä»£ç ï¼Œä½¿æ¨¡å‹å…·æœ‰ä»å›¾å½¢ç•Œé¢æˆ–å›¾è¡¨é‡å»ºä»£ç çš„èƒ½åŠ›ã€‚ä»Stackæ•°æ®é›†ä¸­çš„jupyter notebookæ¸…æ´—å‡º2millionå›¾åƒ-ä»£ç å¯¹ã€‚æœ€ç»ˆé€‰æ‹©1.1millionä½œä¸ºæ˜¯ä¸»è¦è®­ç»ƒé›†ï¼ŒåŒ…æ‹¬ä¸€å¼ å›¾åƒ-è‡³å°‘5è¡Œä»£ç ï¼‰\u003c/p\u003e\n\u003cp\u003eOCR dataï¼ˆæ–‡æ¡£å…‰å­¦å­—ç¬¦è¯†åˆ«æ•°æ®ï¼Œä½œè€…æ„å»ºäº†ä¸€ä¸ªä¸­è‹±æ··åˆçš„OCRæ•°æ®é›†ï¼ŒåŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼š1.arxivæ–‡ç«  2.ç”µå­ä¹¦å’Œæ•™è‚²ææ–™ï¼Œæ¥è‡ªAnna\u0026rsquo;s Archiveï¼‰\u003c/p\u003e\n\u003cp\u003eScene text OCRï¼ˆå¢å¼ºæ¨¡å‹è¯†åˆ«åœºæ™¯ä¸­æ–‡æœ¬çš„èƒ½åŠ›ï¼‰ArTã€MLT-17ç­‰ã€‚\u003c/p\u003e\n\u003cp\u003eText-only corpusï¼ˆçº¯æ–‡æœ¬ï¼Œå’ŒDeepSeek LLMçš„ä¸€è‡´ï¼‰\u003c/p\u003e\n\u003ch3 id=\"22-vl-sft-data\"\u003e2.2 VL-SFT Data\u003c/h3\u003e\n\u003cp\u003eåŒ…æ‹¬å¤šä¸ªçŸ¥åå¼€æºæ•°æ®é›†ShareGPT4Vã€LAION-GPTVç­‰ã€‚\u003c/p\u003e","title":"è®ºæ–‡é˜…è¯» | DeepSeek-VL: Towards Real-World Vision-Language Understanding"},{"content":"è¿™æ˜¯ä¸€ä¸ªç³»åˆ—åšå®¢ï¼ŒåŒ…æ‹¬äº”ç¯‡æ–‡ç« ã€‚åšå®¢åœ°å€ï¼šStop Saying RAG Is Dead â€“ Hamelâ€™s Blog\nä½œè€…æ‰¹é©³äº†â€œRAGå·²æ­»â€çš„è¯´æ³•ï¼Œè®¤ä¸ºçœŸæ­£è¢«æ·˜æ±°çš„æ˜¯â€œChuck documents into a vector database, do cosine similarity, call it a day. â€çš„è¿‡æ—¶çš„RAGã€‚RAGæŠ€æœ¯ä»åœ¨è¿›åŒ–ï¼Œåœ¨åé¢çš„çš„æ–‡ç« é‡Œå¯ä»¥çœ‹åˆ°åœ¨æ£€ç´¢ã€è¯„ä¼°ç­‰æ–¹é¢ä¸Šçš„åˆ›æ–°ã€‚å¾ˆé«˜å…´çœ‹åˆ°æœ‰äººå¯¹RAGæŒç§¯ææ€åº¦ï¼Œæ¯•ç«Ÿåœ¨ä¸€ä¸ªæœ‰å¸Œæœ›çš„é¢†åŸŸè¿›è¡Œç ”ç©¶å­¦ä¹ æ›´æœ‰åŠ¨åŠ›ã€‚\näº”ç¯‡æ–‡ç« çš„ç®€ä»‹å¦‚ä¸‹ï¼š\næ ‡é¢˜ å†…å®¹ç®€ä»‹ Part 1: I donâ€™t use RAG, I just retrieve documents Ben ClaviÃ© ä»‹ç»äº†RAGçš„ç°çŠ¶ Part 2: Modern IR Evals For RAG è¯„ä¼°æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤ï¼Œé«˜è´¨é‡çš„benchmarkæœ‰åŠ©äºæˆ‘ä»¬é€‰æ‹©æ›´å¥½çš„æ–¹æ³•ã€‚Nandan Thakur ï¼ˆBIERä½œè€…ï¼‰è®¤ä¸ºä¼ ç»Ÿçš„IRæŒ‡æ ‡ä¸é€‚åˆè¯„ä¼°RAGçš„è¡¨ç°ï¼Œåº”è¯¥é‡‡ç”¨æ–°çš„æŒ‡æ ‡ Part 3: Optimizing Retrieval with Reasoning Models Orion Weller æå‡ºäº†ä¸€ç§èƒ½éµå¾ªinstructçš„æ£€ç´¢ç³»ç»Ÿï¼Œåœ¨æ£€ç´¢æ—¶å°±è¿›è¡Œæ¨ç†ï¼Œä¼˜äºä¼ ç»Ÿçš„è¯­ä¹‰æ£€ç´¢ Part 4: Late Interaction Models For RAG Antoine Chaffin ä»‹ç»äº†ColBERTè¿™ç±»è¿Ÿäº¤äº’ã€å¤šå‘é‡æ¨¡å‹ Part 5: RAG with Multiple Representations Bryan Bischof and Ayush Chaurasia æå‡ºï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸åŒæ¨¡æ€çš„é—®é¢˜æ™ºèƒ½åŒ–çš„é€‰ç”¨ä¸ç”¨çš„æŒ‡æ ‡ P1: I donâ€™t use RAG, I just retrieve documents ç°åœ¨æœ‰ä¸€äº›è¯´æ³•ï¼Œè®¤ä¸ºé•¿ä¸Šä¸‹æ–‡çª—å£çš„å‡ºç°ä½¿å¾—æˆ‘ä»¬ä¸å†éœ€è¦RAGäº†ã€‚\n10Mçš„ä¸Šä¸‹æ–‡çª—å£å‡ºä¸–ï¼Œå¹¶ä¸æ„å‘³ç€RAGå°±è¢«æ·˜æ±°äº†ã€‚å°±å¥½åƒ512MBçš„RAMå‡ºä¸–ï¼Œå¹¶ä¸æ„å‘³ç€ç¡¬ç›˜å°±è¢«æ·˜æ±°äº†ã€‚æ¯•ç«Ÿå¤–éƒ¨çŸ¥è¯†çš„æ•°é‡è¿œè¶…ä¸Šä¸‹æ–‡çª—å£ï¼Œä»æˆæœ¬å’Œæ•ˆç‡æ¥çœ‹ï¼Œé•¿ä¸Šä¸‹æ–‡çª—å£å¹¶ä¸ä¼šæ›¿ä»£RAGã€‚\nRAGæ˜¯å·²å†»ç»“å‚æ•°çš„æ¨¡å‹äº†è§£å¤–éƒ¨ä¸–ç•Œçš„æ¡¥æ¢ã€‚æ¨¡å‹ä¸éœ€è¦çŸ¥é“é‚£ä¹ˆå¤šæ— å…³ç´§è¦çš„ã€ç”¨è¿‡å³ä¸¢çš„çŸ¥è¯†ï¼Œæ›´ä½•å†µæ¨¡å‹å­¦ä¹ è¿™äº›çŸ¥è¯†è¦ç»è¿‡å¤æ‚çš„è¿‡ç¨‹ã€‚æ‰€ä»¥ï¼ŒRAGæ˜¯æä¾›å¿…è¦çš„å¤–éƒ¨çŸ¥è¯†çš„æä½³æ–¹å¼ã€‚\nå›åˆ°åˆšæ‰RAMå’Œç¡¬ç›˜çš„ä¾‹å­ï¼Œç¡¬ç›˜ç¡®å®è¢«å–ä»£äº†ï¼Œä¸è¿‡æ˜¯è¢«SSDã€‚æ‰€ä»¥ï¼Œæ·˜æ±°çš„RAGçš„ï¼Œæ˜¯æ›´å…ˆè¿›çš„RAGã€‚\nP3: Optimizing Retrieval with Reasoning Models é•¿ä¹…ä»¥æ¥ï¼Œæˆ‘ä»¬çš„æœç´¢å¼•æ“çš„å½¢å¼ä¸€ç›´æ²¡æœ‰å˜åŒ–ï¼Œä»ç„¶æ˜¯æ ¹æ®å…³é”®å­—/è¯­ä¹‰è¿›è¡Œæ£€ç´¢ã€‚\næ¯”å¦‚è¯´ï¼Œæœ‰ä¸‰ç¯‡æ–‡ç« ï¼š\nData Encryption Standards Wolves Outside Your Data Digital Protection queryä¸ºï¼šâ€œFind websites explaining data privacyâ€\né‡‡ç”¨å…³é”®è¯æ£€ç´¢ï¼Œä¼šå¾—åˆ°1 2ï¼Œå› ä¸ºå«æœ‰dataå…³é”®è¯ã€‚\né‡‡ç”¨è¯­ä¹‰æ£€ç´¢ï¼Œä¼šå¾—åˆ°1 2 3ï¼Œå› ä¸ºå®ƒäº†è§£â€œdataâ€å’Œâ€œdigitalâ€ä»¥åŠâ€œprivacyâ€å’Œâ€œprotectionâ€ä¹‹é—´çš„å…³ç³»ã€‚\nä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬æŠŠqueryæ”¹ä¸ºâ€œFind websites explaining data privacy and uses extended metaphorsâ€ï¼Œæˆ‘ä»¬æƒ³è¦æ£€ç´¢å‡º2ï¼Œä½†æ˜¯æ¨¡å‹æ— æ³•ç†è§£çº¦æŸï¼Œåªä¼šå°è¯•åŒ¹é…ä¸â€œand uses extended metaphorsâ€è¯­ä¹‰ç›¸è¿‘çš„æ–‡ç« ï¼Œä¸æˆ‘ä»¬çš„ç›®çš„ç›¸å·®ç”šè¿œã€‚\nåŒ…æ‹¬ç°åœ¨LLMçš„è”ç½‘æœç´¢ï¼Œä¹Ÿä¸è¿‡æ˜¯åœ¨ä¼ ç»Ÿæ£€ç´¢çš„å¤–é¢ï¼Œå¤šåŠ äº†ä¸€å±‚LLMè¿›è¡Œæ•´ç†ã€‚\nå› æ­¤ï¼Œä½œè€…å¸Œæœ›æ£€ç´¢å™¨èƒ½éµå¾ªæŒ‡ä»¤ï¼ˆinstructï¼‰ã€‚æŒ‡ä»¤å¯ä»¥å’Œæ–‡æ¡£çš„å±æ€§ç›¸å…³ï¼Œæ¯”å¦‚æ—¥æœŸã€é•¿åº¦æˆ–æ¥æºã€‚æˆ–è€…æ¶‰åŠNLU æ–¹é¢ï¼Œä¾‹å¦‚æ–‡æ¡£æƒ…æ„Ÿæˆ–å†™ä½œé£æ ¼ã€‚ç¬¬ä¸‰ï¼Œå®ƒä»¬å¯ä»¥åŒ…å«é€»è¾‘æ¡ä»¶ï¼Œå°†å¤šä¸ªçº¦æŸä¸ ANDã€OR å’Œ NOT ç­‰è¿ç®—ç¬¦ç»„åˆåœ¨ä¸€èµ·ã€‚\nä½œè€…æå‡ºäº†Promptrieveræ¨¡å‹ï¼Œè®©æˆ‘ä»¬åœ¨æ£€ç´¢æ—¶ä¹Ÿç”¨ä¸Špromptå§ã€‚\nPromptriever ä¼ ç»Ÿçš„æ•°æ®é›†ä¸å¸¦æœ‰æŒ‡ä»¤ã€‚ä½œè€…ä½¿ç”¨LLMæ„å»ºäº†ä¸€ä¸ªå¸¦æœ‰æŒ‡ä»¤çš„æ•°æ®é›†ã€‚ç„¶åä½¿ç”¨RepLLaMAåœ¨æ•°æ®é›†ä¸Šè®­ç»ƒã€‚\nåœ¨è¯„æµ‹æ—¶ä½¿ç”¨äº†ä¸¤ä¸ªå¸¦æŒ‡ä»¤çš„æ•°æ®é›†ï¼šFollIRå’ŒInstructIRã€‚ç»“æœå½“ç„¶æ˜¯Promptrieverå¥½ï¼Œå› ä¸ºå…¶å®ƒæ¨¡å‹æ ¹æœ¬æ²¡æ³•åˆ©ç”¨æŒ‡ä»¤ã€‚\né‚£Promptrieveråœ¨æ²¡æœ‰promptæ—¶æ€ä¹ˆåŠï¼Ÿå¯ä»¥ç›´æ¥ä¸å¸¦promptï¼Œæˆ–è€…åŠ ä¸€å¥ â€œFind the most relevant documentâ€ï¼Œè¡¨ç°ä¼šæ›´å¥½ã€‚\nPromptrieverå¯ä»¥é€šè¿‡è°ƒæ•´è‡ªç„¶è¯­è¨€æç¤ºæ¥æ›´æ”¹æ¨¡å‹çš„è¡Œä¸ºï¼Œä¸éœ€è¦è®¾ç½®å›ºå®šçš„topké˜ˆå€¼ï¼Œå¦å¤–è¿˜èƒ½è§£å†³ â€œfind documents with high recallâ€ è¿™æ ·çš„æŒ‡ä»¤ã€‚\nä¸ºäº†è¯æ˜æ¨¡å‹çœŸçš„ç†è§£äº†æŒ‡ä»¤ï¼Œä½œè€…å¯¹æ¯ä¸ªæ•°æ®ä½¿ç”¨äº†10ä¸ªè¡¨è¿°ä¸åŒçš„æŒ‡ä»¤ï¼Œç»“æœè¯¥æ¨¡å‹çš„æ ‡å‡†å·®æœ€å°ï¼Œè¯´æ˜å®ƒç¡®å®ç†è§£äº†æŒ‡ä»¤çš„å«ä¹‰ï¼Œè€Œä¸æ˜¯ç®€å•åŒ¹é…å…³é”®è¯ã€‚\næ€»ç»“ï¼š\nç»è¿‡ç‰¹åˆ¶æ•°æ®çš„è®­ç»ƒï¼Œbi-encoderèƒ½å˜å¾—åƒå¤§æ¨¡å‹ä¸€æ ·å¯éµå¾ªæŒ‡ä»¤ã€‚ å¯ä»¥ä½¿ç”¨æ–°çš„è¯¢é—®æ–¹å¼ï¼Œç²¾ç»†åˆ°é£æ ¼ã€æƒ…æ„Ÿã€é€»è¾‘å±‚é¢ã€‚ ç”¨æˆ·ä¸éœ€è¦çº ç»“å…³é”®è¯ï¼Œåªéœ€è¦å‘Šè¯‰æ¨¡å‹ä»–ä»¬æƒ³è¦ä»€ä¹ˆã€‚ ","permalink":"https://Rook1eChan.github.io/posts/%E5%8D%9A%E5%AE%A2-stop-saying-rag-is-dead/","summary":"\u003cp\u003eè¿™æ˜¯ä¸€ä¸ªç³»åˆ—åšå®¢ï¼ŒåŒ…æ‹¬äº”ç¯‡æ–‡ç« ã€‚åšå®¢åœ°å€ï¼š\u003ca href=\"https://hamel.dev/notes/llm/rag/not_dead.html\"\u003eStop Saying RAG Is Dead â€“ Hamelâ€™s Blog\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eä½œè€…æ‰¹é©³äº†â€œRAGå·²æ­»â€çš„è¯´æ³•ï¼Œè®¤ä¸ºçœŸæ­£è¢«æ·˜æ±°çš„æ˜¯â€œChuck documents into a vector database, do cosine similarity, call it a day. â€çš„è¿‡æ—¶çš„RAGã€‚RAGæŠ€æœ¯ä»åœ¨è¿›åŒ–ï¼Œåœ¨åé¢çš„çš„æ–‡ç« é‡Œå¯ä»¥çœ‹åˆ°åœ¨æ£€ç´¢ã€è¯„ä¼°ç­‰æ–¹é¢ä¸Šçš„åˆ›æ–°ã€‚å¾ˆé«˜å…´çœ‹åˆ°æœ‰äººå¯¹RAGæŒç§¯ææ€åº¦ï¼Œæ¯•ç«Ÿåœ¨ä¸€ä¸ªæœ‰å¸Œæœ›çš„é¢†åŸŸè¿›è¡Œç ”ç©¶å­¦ä¹ æ›´æœ‰åŠ¨åŠ›ã€‚\u003c/p\u003e\n\u003cp\u003eäº”ç¯‡æ–‡ç« çš„ç®€ä»‹å¦‚ä¸‹ï¼š\u003c/p\u003e\n\u003ctable\u003e\n  \u003cthead\u003e\n      \u003ctr\u003e\n          \u003cth style=\"text-align: left\"\u003eæ ‡é¢˜\u003c/th\u003e\n          \u003cth\u003eå†…å®¹ç®€ä»‹\u003c/th\u003e\n      \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://hamel.dev/notes/llm/rag/p1-intro.html\"\u003ePart 1\u003c/a\u003e: \u003cstrong\u003eI donâ€™t use RAG, I just retrieve documents\u003c/strong\u003e\u003c/td\u003e\n          \u003ctd\u003eBen ClaviÃ© ä»‹ç»äº†RAGçš„ç°çŠ¶\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://hamel.dev/notes/llm/rag/p2-evals.html\"\u003ePart 2\u003c/a\u003e: \u003cstrong\u003eModern IR Evals For RAG\u003c/strong\u003e\u003c/td\u003e\n          \u003ctd\u003eè¯„ä¼°æ˜¯å¿…ä¸å¯å°‘çš„æ­¥éª¤ï¼Œé«˜è´¨é‡çš„benchmarkæœ‰åŠ©äºæˆ‘ä»¬é€‰æ‹©æ›´å¥½çš„æ–¹æ³•ã€‚Nandan Thakur ï¼ˆBIERä½œè€…ï¼‰è®¤ä¸ºä¼ ç»Ÿçš„IRæŒ‡æ ‡ä¸é€‚åˆè¯„ä¼°RAGçš„è¡¨ç°ï¼Œåº”è¯¥é‡‡ç”¨æ–°çš„æŒ‡æ ‡\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://hamel.dev/notes/llm/rag/p3_reasoning.html\"\u003ePart 3\u003c/a\u003e: \u003cstrong\u003eOptimizing Retrieval with Reasoning Models\u003c/strong\u003e\u003c/td\u003e\n          \u003ctd\u003eOrion Weller æå‡ºäº†ä¸€ç§èƒ½éµå¾ªinstructçš„æ£€ç´¢ç³»ç»Ÿï¼Œåœ¨æ£€ç´¢æ—¶å°±è¿›è¡Œæ¨ç†ï¼Œä¼˜äºä¼ ç»Ÿçš„è¯­ä¹‰æ£€ç´¢\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://hamel.dev/notes/llm/rag/p4_late_interaction.html\"\u003ePart 4\u003c/a\u003e: \u003cstrong\u003eLate Interaction Models For RAG\u003c/strong\u003e\u003c/td\u003e\n          \u003ctd\u003eAntoine Chaffin ä»‹ç»äº†ColBERTè¿™ç±»è¿Ÿäº¤äº’ã€å¤šå‘é‡æ¨¡å‹\u003c/td\u003e\n      \u003c/tr\u003e\n      \u003ctr\u003e\n          \u003ctd style=\"text-align: left\"\u003e\u003ca href=\"https://hamel.dev/notes/llm/rag/p5_map.html\"\u003ePart 5\u003c/a\u003e: \u003cstrong\u003eRAG with Multiple Representations\u003c/strong\u003e\u003c/td\u003e\n          \u003ctd\u003eBryan Bischof and Ayush Chaurasia æå‡ºï¼Œæˆ‘ä»¬éœ€è¦å¯¹ä¸åŒæ¨¡æ€çš„é—®é¢˜æ™ºèƒ½åŒ–çš„é€‰ç”¨ä¸ç”¨çš„æŒ‡æ ‡\u003c/td\u003e\n      \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cBR\u003e\n\u003ch1 id=\"p1-i-dont-use-rag-i-just-retrieve-documents\"\u003eP1: I donâ€™t use RAG, I just retrieve documents\u003c/h1\u003e\n\u003cp\u003eç°åœ¨æœ‰ä¸€äº›è¯´æ³•ï¼Œè®¤ä¸ºé•¿ä¸Šä¸‹æ–‡çª—å£çš„å‡ºç°ä½¿å¾—æˆ‘ä»¬ä¸å†éœ€è¦RAGäº†ã€‚\u003c/p\u003e","title":"åšå®¢ | Stop Saying RAG Is Dead"},{"content":"å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/403495863\n1.ä»‹ç» BERT(Bidirectional Encoder Representation from Transformers)æ˜¯2018å¹´10æœˆç”±Google AIç ”ç©¶é™¢æå‡ºçš„ä¸€ç§é¢„è®­ç»ƒæ¨¡å‹ï¼Œè¯¥æ¨¡å‹åœ¨æœºå™¨é˜…è¯»ç†è§£é¡¶çº§æ°´å¹³æµ‹è¯•SQuAD1.1ä¸­è¡¨ç°å‡ºæƒŠäººçš„æˆç»©: å…¨éƒ¨ä¸¤ä¸ªè¡¡é‡æŒ‡æ ‡ä¸Šå…¨é¢è¶…è¶Šäººç±»ï¼Œå¹¶ä¸”åœ¨11ç§ä¸åŒNLPæµ‹è¯•ä¸­åˆ›å‡ºSOTAè¡¨ç°ï¼ŒåŒ…æ‹¬å°†GLUEåŸºå‡†æ¨é«˜è‡³80.4% (ç»å¯¹æ”¹è¿›7.6%)ï¼ŒMultiNLIå‡†ç¡®åº¦è¾¾åˆ°86.7% (ç»å¯¹æ”¹è¿›5.6%)ï¼Œæˆä¸ºNLPå‘å±•å²ä¸Šçš„é‡Œç¨‹ç¢‘å¼çš„æ¨¡å‹æˆå°±ã€‚\nBERTçš„ç½‘ç»œæ¶æ„ä½¿ç”¨çš„æ˜¯ã€ŠAttention is all you needã€‹ä¸­æå‡ºçš„å¤šå±‚Transformerç»“æ„ã€‚å…¶æœ€å¤§çš„ç‰¹ç‚¹æ˜¯æŠ›å¼ƒäº†ä¼ ç»Ÿçš„RNNå’ŒCNNï¼Œé€šè¿‡Attentionæœºåˆ¶å°†ä»»æ„ä½ç½®çš„ä¸¤ä¸ªå•è¯çš„è·ç¦»è½¬æ¢æˆ1ï¼Œæœ‰æ•ˆçš„è§£å†³äº†NLPä¸­æ£˜æ‰‹çš„é•¿æœŸä¾èµ–é—®é¢˜ã€‚Transformerçš„ç»“æ„åœ¨NLPé¢†åŸŸä¸­å·²ç»å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚\n2.æ¨¡å‹ç»“æ„ ä¸‹å›¾å±•ç¤ºçš„æ˜¯BERTçš„æ€»ä½“ç»“æ„å›¾ï¼Œå¤šä¸ªTransformer Encoderä¸€å±‚ä¸€å±‚åœ°å †å èµ·æ¥ï¼Œå°±ç»„è£…æˆäº†BERTäº†ï¼Œåœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…åˆ†åˆ«ç”¨12å±‚å’Œ24å±‚Transformer Encoderç»„è£…äº†ä¸¤å¥—BERTæ¨¡å‹ï¼Œä¸¤å¥—æ¨¡å‹çš„å‚æ•°æ€»æ•°åˆ†åˆ«ä¸º110Må’Œ340Mã€‚\nBERTæ˜¯ç”¨äº†Transformerçš„encoderä¾§çš„ç½‘ç»œï¼Œencoderä¸­çš„Self-attentionæœºåˆ¶åœ¨ç¼–ç ä¸€ä¸ªtokençš„æ—¶å€™åŒæ—¶åˆ©ç”¨äº†å…¶ä¸Šä¸‹æ–‡çš„tokenï¼Œå…¶ä¸­â€˜åŒæ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡â€™å³ä¸ºåŒå‘çš„ä½“ç°ï¼Œè€Œå¹¶éåƒBi-LSTMé‚£æ ·æŠŠå¥å­å€’åºè¾“å…¥ä¸€éã€‚åœ¨BERTä¹‹å‰æ˜¯GPTï¼ŒGPTä½¿ç”¨çš„æ˜¯Transformerçš„decoderä¾§çš„ç½‘ç»œï¼ŒGPTæ˜¯ä¸€ä¸ªå•å‘è¯­è¨€æ¨¡å‹çš„é¢„è®­ç»ƒè¿‡ç¨‹ï¼Œæ›´é€‚ç”¨äºæ–‡æœ¬ç”Ÿæˆï¼Œé€šè¿‡å‰æ–‡å»é¢„æµ‹å½“å‰çš„å­—ã€‚\n2.1Embedding Embeddingç”±ä¸‰ç§Embeddingæ±‚å’Œè€Œæˆï¼š\ntoken embedding\nå°†è¾“å…¥çš„æ–‡æœ¬è¿›è¡ŒWord Pieceåˆ†è¯ï¼Œå¦‚playingåˆ‡å‰²æˆplayï¼Œ##ingï¼Œä½¿ç”¨Word Pieceæ˜¯ä¸ºäº†è§£å†³æœªç™»å½•è¯ã€‚tokenizationåï¼Œåœ¨å¼€å¤´æ’å…¥[CLS]ï¼Œåœ¨æ¯å¥è¯çš„æœ«å°¾æ’å…¥[SEP]ã€‚[CLS]è¡¨ç¤ºè¯¥ç‰¹å¾ç”¨äºåˆ†ç±»æ¨¡å‹ï¼Œå¯¹éåˆ†ç±»æ¨¡å‹ï¼Œè¯¥ç¬¦å·å¯ä»¥çœå»ã€‚[SEP]è¡¨ç¤ºåˆ†å¥ç¬¦å·ï¼Œç”¨äºæ–­å¼€è¾“å…¥è¯­æ–™ä¸­çš„ä¸¤ä¸ªå¥å­ã€‚\nBert åœ¨å¤„ç†è‹±æ–‡æ–‡æœ¬æ—¶åªéœ€è¦ 30522 ä¸ªè¯ï¼ŒToken Embeddings å±‚ä¼šå°†æ¯ä¸ªè¯è½¬æ¢æˆ 768 ç»´å‘é‡ï¼Œå¦‚ä¸‹å›¾çš„ä¾‹å­ä¸­ï¼Œ 5 ä¸ªToken ä¼šè¢«è½¬æ¢æˆä¸€ä¸ª (5, 768) çš„çŸ©é˜µæˆ– (1, 5, 768) çš„å¼ é‡ã€‚\nsegment embedding\nç”¨æ¥åŒºåˆ†ä¸¤ç§å¥å­ã€‚bertåœ¨è®­ç»ƒæ—¶åŒ…æ‹¬ä¸¤ç§ä»»åŠ¡ï¼Œå…¶ä¸€æ˜¯MLMï¼ˆmasked language modelï¼Œæ©ç è¯­è¨€æ¨¡å‹ï¼‰ï¼Œå°±æ˜¯é®ä½æŸä¸ªè¯è®©æ¨¡å‹å»é¢„æµ‹ï¼›å…¶äºŒæ˜¯NSPï¼ˆnext sentence predictionï¼Œä¸‹ä¸€å¥é¢„æµ‹ï¼‰ï¼Œè¾“å…¥ä¸¤ä¸ªå¥å­ï¼Œè®©æ¨¡å‹åˆ¤æ–­æ˜¯å¦ç›¸å…³ã€‚è¿™æ—¶å€™å°±éœ€è¦segment embeddingå¯¹ä¸¤ä¸ªå¥å­åšåŒºåˆ«ã€‚\nè¿›è¡Œé—®ç­”ç­‰éœ€è¦é¢„æµ‹ä¸‹ä¸€å¥çš„ä»»åŠ¡æ—¶ï¼Œsegment embeddingå±‚æŠŠ0èµ‹å€¼ç»™ç¬¬ä¸€ä¸ªå¥å­çš„å„tokenï¼ŒæŠŠ1èµ‹å€¼ç»™ç¬¬äºŒä¸ªå¥å­çš„å„tokenã€‚åœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡æ—¶ï¼Œsegment embeddingå…¨éƒ¨ä¸º0ã€‚\nposition embedding\nå’Œtransformerçš„å®ç°ä¸åŒï¼Œä¸æ˜¯å›ºå®šçš„ä¸‰è§’å‡½æ•°ï¼Œè€Œæ˜¯å¯å­¦ä¹ çš„å‚æ•°ã€‚\nTransformer ä¸­é€šè¿‡æ¤å…¥å…³äº Token çš„ç›¸å¯¹ä½ç½®æˆ–è€…ç»å¯¹ä½ç½®ä¿¡æ¯æ¥è¡¨ç¤ºåºåˆ—çš„é¡ºåºä¿¡æ¯ã€‚ä½œè€…æµ‹è¯•ç”¨å­¦ä¹ çš„æ–¹æ³•æ¥å¾—åˆ° Position Embeddingsï¼Œæœ€ç»ˆå‘ç°å›ºå®šä½ç½®å’Œç›¸å¯¹ä½ç½®æ•ˆæœå·®ä¸å¤šï¼Œæ‰€ä»¥æœ€åç”¨çš„æ˜¯å›ºå®šä½ç½®çš„ï¼Œè€Œæ­£å¼¦å¯ä»¥å¤„ç†æ›´é•¿çš„ Sequenceï¼Œä¸”å¯ä»¥ç”¨å‰é¢ä½ç½®çš„å€¼çº¿æ€§è¡¨ç¤ºåé¢çš„ä½ç½®ã€‚\nåœ¨BERTä¸­ï¼ŒPosition Embeddingså±‚è¢«å¼•å…¥ä»¥è§£å†³Transformeræ¨¡å‹æ— æ³•ç¼–ç è¾“å…¥åºåˆ—é¡ºåºæ€§çš„é—®é¢˜ã€‚åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¸­ï¼Œè¯çš„é¡ºåºå¾€å¾€å¾ˆé‡è¦ã€‚ä¾‹å¦‚ï¼Œâ€œI think, therefore I amâ€ä¸­ï¼Œâ€œIâ€çš„é¡ºåºä¸åŒï¼Œè¡¨è¾¾çš„å«ä¹‰ä¹Ÿä¸åŒã€‚Position Embeddingså±‚é€šè¿‡æ·»åŠ ä½ç½®ä¿¡æ¯ï¼Œè®©BERTèƒ½å¤Ÿç†è§£è¯çš„ä½ç½®å…³ç³»ï¼Œä»è€Œæ›´å¥½åœ°å¤„ç†æ–‡æœ¬æ•°æ®ã€‚åœ¨BERTä¸­ï¼Œä½ç½®ä¿¡æ¯è¢«ç¼–ç æˆä¸€ç³»åˆ—å‘é‡ï¼Œè¿™äº›å‘é‡è¢«åŠ åˆ°Token Embeddingså±‚çš„è¾“å‡ºä¸Šï¼Œå½¢æˆæœ€ç»ˆçš„è¯å‘é‡è¡¨ç¤ºã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼ŒBERTèƒ½å¤Ÿç†è§£è¯çš„ä½ç½®å…³ç³»ï¼Œä»è€Œæ›´å¥½åœ°å¤„ç†æ–‡æœ¬æ•°æ®ã€‚\nBERT ä¸­å¤„ç†çš„æœ€é•¿åºåˆ—æ˜¯ 512 ä¸ª Tokenï¼Œé•¿åº¦è¶…è¿‡ 512 ä¼šè¢«æˆªå–ï¼ŒBERT åœ¨å„ä¸ªä½ç½®ä¸Šå­¦ä¹ ä¸€ä¸ªå‘é‡æ¥è¡¨ç¤ºåºåˆ—é¡ºåºçš„ä¿¡æ¯ç¼–ç è¿›æ¥ï¼Œè¿™æ„å‘³ç€ Position Embeddings å®é™…ä¸Šæ˜¯ä¸€ä¸ª (512, 768) çš„ lookup è¡¨ï¼Œè¡¨ç¬¬ä¸€è¡Œæ˜¯ä»£è¡¨ç¬¬ä¸€ä¸ªåºåˆ—çš„æ¯ä¸ªä½ç½®ï¼Œç¬¬äºŒè¡Œä»£è¡¨åºåˆ—ç¬¬äºŒä¸ªä½ç½®ã€‚\næœ€åï¼ŒBERT æ¨¡å‹å°† Token Embeddings (1, n, 768) + Segment Embeddings(1, n, 768) + Position Embeddings(1, n, 768) æ±‚å’Œçš„æ–¹å¼å¾—åˆ°ä¸€ä¸ª Embedding(1, n, 768) ä½œä¸ºæ¨¡å‹çš„è¾“å…¥ã€‚\nï¼ˆä¸æ˜ç™½æ€ä¹ˆèµ‹å€¼çš„ï¼‰\n[CLS]çš„ä½œç”¨\nBERTåœ¨ç¬¬ä¸€å¥å‰ä¼šåŠ ä¸€ä¸ª[CLS]æ ‡å¿—ï¼Œæœ€åä¸€å±‚è¯¥ä½å¯¹åº”å‘é‡å¯ä»¥ä½œä¸ºæ•´å¥è¯çš„è¯­ä¹‰è¡¨ç¤ºï¼Œä»è€Œç”¨äºä¸‹æ¸¸çš„åˆ†ç±»ä»»åŠ¡ç­‰ã€‚å› ä¸ºä¸æ–‡æœ¬ä¸­å·²æœ‰çš„å…¶å®ƒè¯ç›¸æ¯”ï¼Œè¿™ä¸ªæ— æ˜æ˜¾è¯­ä¹‰ä¿¡æ¯çš„ç¬¦å·ä¼šæ›´â€œå…¬å¹³â€åœ°èåˆæ–‡æœ¬ä¸­å„ä¸ªè¯çš„è¯­ä¹‰ä¿¡æ¯ï¼Œä»è€Œæ›´å¥½çš„è¡¨ç¤ºæ•´å¥è¯çš„è¯­ä¹‰ã€‚ å…·ä½“æ¥è¯´ï¼Œself-attentionæ˜¯ç”¨æ–‡æœ¬ä¸­çš„å…¶å®ƒè¯æ¥å¢å¼ºç›®æ ‡è¯çš„è¯­ä¹‰è¡¨ç¤ºï¼Œä½†æ˜¯ç›®æ ‡è¯æœ¬èº«çš„è¯­ä¹‰è¿˜æ˜¯ä¼šå ä¸»è¦éƒ¨åˆ†çš„ï¼Œå› æ­¤ï¼Œç»è¿‡BERTçš„12å±‚ï¼ˆBERT-baseä¸ºä¾‹ï¼‰ï¼Œæ¯æ¬¡è¯çš„embeddingèåˆäº†æ‰€æœ‰è¯çš„ä¿¡æ¯ï¼Œå¯ä»¥å»æ›´å¥½çš„è¡¨ç¤ºè‡ªå·±çš„è¯­ä¹‰ã€‚è€Œ[CLS]ä½æœ¬èº«æ²¡æœ‰è¯­ä¹‰ï¼Œç»è¿‡12å±‚çš„ä¿¡æ¯ä¼ é€’åç¼–ç äº†å…¨å±€è¯­ä¹‰ï¼Œç›¸æ¯”å…¶ä»–æ­£å¸¸è¯ï¼Œå¯ä»¥æ›´å¥½çš„è¡¨å¾å¥å­è¯­ä¹‰ã€‚\nåˆ†ç±»çš„æ—¶å€™æŠŠclsä½ç½®çš„å‘é‡å–å‡ºæ¥å³å¯ã€‚\n2.2Encoder BERTä½¿ç”¨äº†Transformerçš„encoderä¾§çš„ç½‘ç»œã€‚\nåœ¨Transformerä¸­ï¼Œæ¨¡å‹çš„è¾“å…¥ä¼šè¢«è½¬æ¢æˆ512ç»´çš„å‘é‡ï¼Œç„¶ååˆ†ä¸º8ä¸ªheadï¼Œæ¯ä¸ªheadçš„ç»´åº¦æ˜¯64ç»´ï¼Œä½†æ˜¯BERTçš„ç»´åº¦æ˜¯768ç»´åº¦ï¼Œç„¶ååˆ†æˆ12ä¸ªheadï¼Œæ¯ä¸ªheadçš„ç»´åº¦æ˜¯64ç»´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾®å°çš„å·®åˆ«ã€‚Transformerä¸­position Embeddingæ˜¯ç”¨çš„ä¸‰è§’å‡½æ•°ï¼ŒBERTä¸­ä¹Ÿæœ‰ä¸€ä¸ªPostion Embeddingæ˜¯éšæœºåˆå§‹åŒ–ï¼Œç„¶åä»æ•°æ®ä¸­å­¦å‡ºæ¥çš„ã€‚\nBERTæ¨¡å‹åˆ†ä¸º24å±‚å’Œ12å±‚ä¸¤ç§ï¼Œå…¶å·®åˆ«å°±æ˜¯ä½¿ç”¨transformer encoderçš„å±‚æ•°çš„å·®å¼‚ï¼ŒBERT-baseä½¿ç”¨çš„æ˜¯12å±‚çš„Transformer Encoderç»“æ„ï¼ŒBERT-Largeä½¿ç”¨çš„æ˜¯24å±‚çš„Transformer Encoderç»“æ„ã€‚\n3.BERTè®­ç»ƒ BERTçš„è®­ç»ƒåŒ…å«pre-trainå’Œfine-tuneä¸¤ä¸ªé˜¶æ®µã€‚pre-trainé˜¶æ®µæ¨¡å‹æ˜¯åœ¨æ— æ ‡æ³¨çš„æ ‡ç­¾æ•°æ®ä¸Šè¿›è¡Œè®­ç»ƒï¼›fine-tuneé˜¶æ®µBERTæ¨¡å‹é¦–å…ˆæ˜¯è¢«pre-trainæ¨¡å‹å‚æ•°åˆå§‹åŒ–ï¼Œç„¶åæ‰€æœ‰çš„å‚æ•°ä¼šç”¨ä¸‹æ¸¸çš„æœ‰æ ‡æ³¨çš„æ•°æ®è¿›è¡Œè®­ç»ƒã€‚\n3.1 BERTé¢„è®­ç»ƒ BERTæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡æ¨¡å‹ï¼Œå®ƒçš„é¢„è®­ç»ƒï¼ˆPre-trainingï¼‰ä»»åŠ¡æ˜¯ç”±ä¸¤ä¸ªè‡ªç›‘ç£ä»»åŠ¡ç»„æˆï¼Œå³MLMå’ŒNSPã€‚\nMLM\nMLMæ˜¯æŒ‡åœ¨è®­ç»ƒçš„æ—¶å€™éšå³ä»è¾“å…¥è¯­æ–™ä¸Šmaskæ‰ä¸€äº›å•è¯ï¼Œç„¶åé€šè¿‡çš„ä¸Šä¸‹æ–‡é¢„æµ‹è¯¥å•è¯ï¼Œè¯¥ä»»åŠ¡éå¸¸åƒæˆ‘ä»¬åœ¨ä¸­å­¦æ—¶æœŸç»å¸¸åšçš„å®Œå½¢å¡«ç©ºã€‚æ­£å¦‚ä¼ ç»Ÿçš„è¯­è¨€æ¨¡å‹ç®—æ³•å’ŒRNNåŒ¹é…é‚£æ ·ï¼ŒMLMçš„è¿™ä¸ªæ€§è´¨å’ŒTransformerçš„ç»“æ„æ˜¯éå¸¸åŒ¹é…çš„ã€‚åœ¨BERTçš„å®éªŒä¸­ï¼Œ15%çš„WordPiece Tokenä¼šè¢«éšæœºMaskæ‰ã€‚åœ¨è®­ç»ƒæ¨¡å‹æ—¶ï¼Œä¸€ä¸ªå¥å­ä¼šè¢«å¤šæ¬¡å–‚åˆ°æ¨¡å‹ä¸­ç”¨äºå‚æ•°å­¦ä¹ ï¼Œä½†æ˜¯Googleå¹¶æ²¡æœ‰åœ¨æ¯æ¬¡éƒ½maskæ‰è¿™äº›å•è¯ï¼Œè€Œæ˜¯åœ¨ç¡®å®šè¦Maskæ‰çš„å•è¯ä¹‹åï¼Œåšä»¥ä¸‹å¤„ç†ã€‚\n80%çš„æ—¶å€™ä¼šç›´æ¥æ›¿æ¢ä¸º[Mask]ï¼Œå°†å¥å­ \u0026ldquo;my dog is cute\u0026rdquo; è½¬æ¢ä¸ºå¥å­ \u0026ldquo;my dog is [Mask]\u0026quot;ã€‚\n10%çš„æ—¶å€™å°†å…¶æ›¿æ¢ä¸ºå…¶å®ƒä»»æ„å•è¯ï¼Œå°†å•è¯ \u0026ldquo;cute\u0026rdquo; æ›¿æ¢æˆå¦ä¸€ä¸ªéšæœºè¯ï¼Œä¾‹å¦‚ \u0026ldquo;apple\u0026rdquo;ã€‚å°†å¥å­ \u0026ldquo;my dog is cute\u0026rdquo; è½¬æ¢ä¸ºå¥å­ \u0026ldquo;my dog is apple\u0026rdquo;ã€‚\n10%çš„æ—¶å€™ä¼šä¿ç•™åŸå§‹Tokenï¼Œä¾‹å¦‚ä¿æŒå¥å­ä¸º \u0026ldquo;my dog is cute\u0026rdquo; ä¸å˜ã€‚\nè¿™ä¹ˆåšçš„åŸå› æ˜¯å¦‚æœå¥å­ä¸­çš„æŸä¸ªToken 100%éƒ½ä¼šè¢«maskæ‰ï¼Œé‚£ä¹ˆåœ¨fine-tuningçš„æ—¶å€™æ¨¡å‹å°±ä¼šæœ‰ä¸€äº›æ²¡æœ‰è§è¿‡çš„å•è¯ã€‚åŠ å…¥éšæœºTokençš„åŸå› æ˜¯å› ä¸ºTransformerè¦ä¿æŒå¯¹æ¯ä¸ªè¾“å…¥tokençš„åˆ†å¸ƒå¼è¡¨å¾ï¼Œå¦åˆ™æ¨¡å‹å°±ä¼šè®°ä½è¿™ä¸ª[mask]æ˜¯token â€™cuteâ€˜ã€‚è‡³äºå•è¯å¸¦æ¥çš„è´Ÿé¢å½±å“ï¼Œå› ä¸ºä¸€ä¸ªå•è¯è¢«éšæœºæ›¿æ¢æ‰çš„æ¦‚ç‡åªæœ‰15%*10% =1.5%ï¼Œè¿™ä¸ªè´Ÿé¢å½±å“å…¶å®æ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚ å¦å¤–æ–‡ç« æŒ‡å‡ºæ¯æ¬¡åªé¢„æµ‹15%çš„å•è¯ï¼Œå› æ­¤æ¨¡å‹æ”¶æ•›çš„æ¯”è¾ƒæ…¢ã€‚\nä¼˜ç‚¹\n1ï¼‰è¢«éšæœºé€‰æ‹©15%çš„è¯å½“ä¸­ä»¥10%çš„æ¦‚ç‡ç”¨ä»»æ„è¯æ›¿æ¢å»é¢„æµ‹æ­£ç¡®çš„è¯ï¼Œç›¸å½“äºæ–‡æœ¬çº é”™ä»»åŠ¡ï¼Œä¸ºBERTæ¨¡å‹èµ‹äºˆäº†ä¸€å®šçš„æ–‡æœ¬çº é”™èƒ½åŠ›ï¼›\n2ï¼‰è¢«éšæœºé€‰æ‹©15%çš„è¯å½“ä¸­ä»¥10%çš„æ¦‚ç‡ä¿æŒä¸å˜ï¼Œç¼“è§£äº†finetuneæ—¶å€™ä¸é¢„è®­ç»ƒæ—¶å€™è¾“å…¥ä¸åŒ¹é…çš„é—®é¢˜ï¼ˆé¢„è®­ç»ƒæ—¶å€™è¾“å…¥å¥å­å½“ä¸­æœ‰maskï¼Œè€Œfinetuneæ—¶å€™è¾“å…¥æ˜¯å®Œæ•´æ— ç¼ºçš„å¥å­ï¼Œå³ä¸ºè¾“å…¥ä¸åŒ¹é…é—®é¢˜ï¼‰ã€‚\nç¼ºç‚¹\né’ˆå¯¹æœ‰ä¸¤ä¸ªåŠä¸¤ä¸ªä»¥ä¸Šè¿ç»­å­—ç»„æˆçš„è¯ï¼Œéšæœºmaskå­—å‰²è£‚äº†è¿ç»­å­—ä¹‹é—´çš„ç›¸å…³æ€§ï¼Œä½¿æ¨¡å‹ä¸å¤ªå®¹æ˜“å­¦ä¹ åˆ°è¯çš„è¯­ä¹‰ä¿¡æ¯ã€‚ä¸»è¦é’ˆå¯¹è¿™ä¸€çŸ­æ¿ï¼Œå› æ­¤googleæ­¤åå‘è¡¨äº†BERT-WWMï¼Œå›½å†…çš„å“ˆå·¥å¤§è”åˆè®¯é£å‘è¡¨äº†ä¸­æ–‡ç‰ˆçš„BERT-WWMã€‚ NSP\nNext Sentence Predictionï¼ˆNSPï¼‰çš„ä»»åŠ¡æ˜¯åˆ¤æ–­å¥å­Bæ˜¯å¦æ˜¯å¥å­Açš„ä¸‹æ–‡ã€‚å¦‚æœæ˜¯çš„è¯è¾“å‡ºâ€™IsNextâ€˜ï¼Œå¦åˆ™è¾“å‡ºâ€™NotNextâ€˜ã€‚è®­ç»ƒæ•°æ®çš„ç”Ÿæˆæ–¹å¼æ˜¯ä»å¹³è¡Œè¯­æ–™ä¸­éšæœºæŠ½å–çš„è¿ç»­ä¸¤å¥è¯ï¼Œå…¶ä¸­50%ä¿ç•™æŠ½å–çš„ä¸¤å¥è¯ï¼Œå®ƒä»¬ç¬¦åˆIsNextå…³ç³»ï¼Œå¦å¤–50%çš„ç¬¬äºŒå¥è¯æ˜¯éšæœºä»é¢„æ–™ä¸­æå–çš„ï¼Œå®ƒä»¬çš„å…³ç³»æ˜¯NotNextçš„ã€‚è¿™ä¸ªå…³ç³»ä¿å­˜åœ¨å›¾4ä¸­çš„[CLS]ç¬¦å·ä¸­ã€‚\nè¾“å…¥ = [CLS] æˆ‘ å–œæ¬¢ ç© [Mask] è”ç›Ÿ [SEP] æˆ‘ æœ€ æ“…é•¿ çš„ [Mask] æ˜¯ äºšç´¢ [SEP]\nç±»åˆ« = IsNext\nè¾“å…¥ = [CLS] æˆ‘ å–œæ¬¢ ç© [Mask] è”ç›Ÿ [SEP] ä»Šå¤© å¤©æ°” å¾ˆ [Mask] [SEP]\nç±»åˆ« = NotNext\næ³¨æ„ï¼Œåœ¨æ­¤åçš„ç ”ç©¶ï¼ˆè®ºæ–‡ã€ŠCrosslingual language model pretrainingã€‹ç­‰ï¼‰ä¸­å‘ç°ï¼ŒNSPä»»åŠ¡å¯èƒ½å¹¶ä¸æ˜¯å¿…è¦çš„ï¼Œæ¶ˆé™¤NSPæŸå¤±åœ¨ä¸‹æ¸¸ä»»åŠ¡çš„æ€§èƒ½ä¸Šèƒ½å¤Ÿä¸åŸå§‹BERTæŒå¹³æˆ–ç•¥æœ‰æé«˜ã€‚è¿™å¯èƒ½æ˜¯ç”±äºBERTä»¥å•å¥å­ä¸ºå•ä½è¾“å…¥ï¼Œæ¨¡å‹æ— æ³•å­¦ä¹ åˆ°è¯ä¹‹é—´çš„è¿œç¨‹ä¾èµ–å…³ç³»ã€‚é’ˆå¯¹è¿™ä¸€ç‚¹ï¼Œåç»­çš„RoBERTaã€ALBERTã€spanBERTéƒ½ç§»å»äº†NSPä»»åŠ¡ã€‚\nBERTé¢„è®­ç»ƒæ¨¡å‹æœ€å¤šåªèƒ½è¾“å…¥512ä¸ªè¯ï¼Œè¿™æ˜¯å› ä¸ºåœ¨BERTä¸­ï¼ŒTokenï¼ŒPositionï¼ŒSegment Embeddings éƒ½æ˜¯é€šè¿‡å­¦ä¹ æ¥å¾—åˆ°çš„ã€‚åœ¨ç›´æ¥ä½¿ç”¨Google çš„BERTé¢„è®­ç»ƒæ¨¡å‹æ—¶ï¼Œè¾“å…¥æœ€å¤š512ä¸ªè¯ï¼ˆè¿˜è¦é™¤æ‰[CLS]å’Œ[SEP]ï¼‰ï¼Œæœ€å¤šä¸¤ä¸ªå¥å­åˆæˆä¸€å¥ã€‚è¿™ä¹‹å¤–çš„è¯å’Œå¥å­ä¼šæ²¡æœ‰å¯¹åº”çš„embeddingã€‚\nå¦‚æœæœ‰è¶³å¤Ÿçš„ç¡¬ä»¶èµ„æºè‡ªå·±é‡æ–°è®­ç»ƒBERTï¼Œå¯ä»¥æ›´æ”¹ BERT configï¼Œè®¾ç½®æ›´å¤§max_position_embeddings å’Œ type_vocab_sizeå€¼å»æ»¡è¶³è‡ªå·±çš„éœ€æ±‚ã€‚\n4.BERTçš„ä¼˜ç¼ºç‚¹ ä¼˜ç‚¹ BERT ç›¸è¾ƒäºåŸæ¥çš„ RNNã€LSTM å¯ä»¥åšåˆ°å¹¶å‘æ‰§è¡Œï¼ŒåŒæ—¶æå–è¯åœ¨å¥å­ä¸­çš„å…³ç³»ç‰¹å¾ï¼Œå¹¶ä¸”èƒ½åœ¨å¤šä¸ªä¸åŒå±‚æ¬¡æå–å…³ç³»ç‰¹å¾ï¼Œè¿›è€Œæ›´å…¨é¢åæ˜ å¥å­è¯­ä¹‰ã€‚ ç›¸è¾ƒäº word2vecï¼Œå…¶åˆèƒ½æ ¹æ®å¥å­ä¸Šä¸‹æ–‡è·å–è¯ä¹‰ï¼Œä»è€Œé¿å…æ­§ä¹‰å‡ºç°ã€‚ ç¼ºç‚¹ æ¨¡å‹å‚æ•°å¤ªå¤šï¼Œè€Œä¸”æ¨¡å‹å¤ªå¤§ï¼Œå°‘é‡æ•°æ®è®­ç»ƒæ—¶ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆã€‚ BERTçš„NSPä»»åŠ¡æ•ˆæœä¸æ˜æ˜¾ï¼ŒMLMå­˜åœ¨å’Œä¸‹æ¸¸ä»»åŠ¡mismathchçš„æƒ…å†µã€‚ BERTå¯¹ç”Ÿæˆå¼ä»»åŠ¡å’Œé•¿åºåˆ—å»ºæ¨¡æ”¯æŒä¸å¥½ã€‚ ","permalink":"https://Rook1eChan.github.io/posts/bert/","summary":"\u003cp\u003eå‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/403495863\u003c/p\u003e\n\u003ch1 id=\"1ä»‹ç»\"\u003e1.ä»‹ç»\u003c/h1\u003e\n\u003cp\u003eBERT(Bidirectional Encoder Representation from Transformers)æ˜¯2018å¹´10æœˆç”±Google AIç ”ç©¶é™¢æå‡ºçš„ä¸€ç§é¢„è®­ç»ƒæ¨¡å‹ï¼Œè¯¥æ¨¡å‹åœ¨æœºå™¨é˜…è¯»ç†è§£é¡¶çº§æ°´å¹³æµ‹è¯•\u003ca href=\"https://zhida.zhihu.com/search?content_id=177795576\u0026amp;content_type=Article\u0026amp;match_order=1\u0026amp;q=SQuAD1.1\u0026amp;zhida_source=entity\"\u003eSQuAD1.1\u003c/a\u003eä¸­è¡¨ç°å‡ºæƒŠäººçš„æˆç»©: å…¨éƒ¨ä¸¤ä¸ªè¡¡é‡æŒ‡æ ‡ä¸Šå…¨é¢è¶…è¶Šäººç±»ï¼Œå¹¶ä¸”åœ¨11ç§ä¸åŒNLPæµ‹è¯•ä¸­åˆ›å‡ºSOTAè¡¨ç°ï¼ŒåŒ…æ‹¬å°†GLUEåŸºå‡†æ¨é«˜è‡³80.4% (ç»å¯¹æ”¹è¿›7.6%)ï¼Œ\u003ca href=\"https://zhida.zhihu.com/search?content_id=177795576\u0026amp;content_type=Article\u0026amp;match_order=1\u0026amp;q=MultiNLI\u0026amp;zhida_source=entity\"\u003eMultiNLI\u003c/a\u003eå‡†ç¡®åº¦è¾¾åˆ°86.7% (ç»å¯¹æ”¹è¿›5.6%)ï¼Œæˆä¸ºNLPå‘å±•å²ä¸Šçš„é‡Œç¨‹ç¢‘å¼çš„æ¨¡å‹æˆå°±ã€‚\u003c/p\u003e\n\u003cp\u003eBERTçš„ç½‘ç»œæ¶æ„ä½¿ç”¨çš„æ˜¯\u003ca href=\"https://zhida.zhihu.com/search?content_id=177795576\u0026amp;content_type=Article\u0026amp;match_order=1\u0026amp;q=%E3%80%8AAttention+is+all+you+need%E3%80%8B\u0026amp;zhida_source=entity\"\u003eã€ŠAttention is all you needã€‹\u003c/a\u003eä¸­æå‡ºçš„å¤šå±‚Transformerç»“æ„ã€‚å…¶æœ€å¤§çš„ç‰¹ç‚¹æ˜¯æŠ›å¼ƒäº†ä¼ ç»Ÿçš„RNNå’ŒCNNï¼Œé€šè¿‡Attentionæœºåˆ¶å°†ä»»æ„ä½ç½®çš„ä¸¤ä¸ªå•è¯çš„è·ç¦»è½¬æ¢æˆ1ï¼Œæœ‰æ•ˆçš„è§£å†³äº†NLPä¸­æ£˜æ‰‹çš„é•¿æœŸä¾èµ–é—®é¢˜ã€‚Transformerçš„ç»“æ„åœ¨NLPé¢†åŸŸä¸­å·²ç»å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"2æ¨¡å‹ç»“æ„\"\u003e2.æ¨¡å‹ç»“æ„\u003c/h1\u003e\n\u003cp\u003eä¸‹å›¾å±•ç¤ºçš„æ˜¯BERTçš„æ€»ä½“ç»“æ„å›¾ï¼Œå¤šä¸ªTransformer Encoderä¸€å±‚ä¸€å±‚åœ°å †å èµ·æ¥ï¼Œå°±ç»„è£…æˆäº†BERTäº†ï¼Œåœ¨è®ºæ–‡ä¸­ï¼Œä½œè€…åˆ†åˆ«ç”¨12å±‚å’Œ24å±‚Transformer Encoderç»„è£…äº†ä¸¤å¥—BERTæ¨¡å‹ï¼Œä¸¤å¥—æ¨¡å‹çš„å‚æ•°æ€»æ•°åˆ†åˆ«ä¸º110Må’Œ340Mã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"P1\" loading=\"lazy\" src=\"/bert/p1.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003eBERTæ˜¯ç”¨äº†Transformerçš„encoderä¾§çš„ç½‘ç»œï¼Œencoderä¸­çš„Self-attentionæœºåˆ¶åœ¨ç¼–ç ä¸€ä¸ªtokençš„æ—¶å€™åŒæ—¶åˆ©ç”¨äº†å…¶ä¸Šä¸‹æ–‡çš„tokenï¼Œå…¶ä¸­â€˜åŒæ—¶åˆ©ç”¨ä¸Šä¸‹æ–‡â€™å³ä¸ºåŒå‘çš„ä½“ç°ï¼Œè€Œå¹¶éåƒBi-LSTMé‚£æ ·æŠŠå¥å­å€’åºè¾“å…¥ä¸€éã€‚åœ¨BERTä¹‹å‰æ˜¯GPTï¼ŒGPTä½¿ç”¨çš„æ˜¯Transformerçš„decoderä¾§çš„ç½‘ç»œï¼ŒGPTæ˜¯ä¸€ä¸ªå•å‘è¯­è¨€æ¨¡å‹çš„é¢„è®­ç»ƒè¿‡ç¨‹ï¼Œæ›´é€‚ç”¨äºæ–‡æœ¬ç”Ÿæˆï¼Œé€šè¿‡å‰æ–‡å»é¢„æµ‹å½“å‰çš„å­—ã€‚\u003c/p\u003e\n\u003ch2 id=\"21embedding\"\u003e2.1Embedding\u003c/h2\u003e\n\u003cp\u003eEmbeddingç”±ä¸‰ç§Embeddingæ±‚å’Œè€Œæˆï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p2\" loading=\"lazy\" src=\"/bert/p2.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003etoken embedding\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eå°†è¾“å…¥çš„æ–‡æœ¬è¿›è¡ŒWord Pieceåˆ†è¯ï¼Œå¦‚playingåˆ‡å‰²æˆplayï¼Œ##ingï¼Œä½¿ç”¨Word Pieceæ˜¯ä¸ºäº†è§£å†³æœªç™»å½•è¯ã€‚tokenizationåï¼Œåœ¨å¼€å¤´æ’å…¥[CLS]ï¼Œåœ¨æ¯å¥è¯çš„æœ«å°¾æ’å…¥[SEP]ã€‚[CLS]è¡¨ç¤ºè¯¥ç‰¹å¾ç”¨äºåˆ†ç±»æ¨¡å‹ï¼Œå¯¹éåˆ†ç±»æ¨¡å‹ï¼Œè¯¥ç¬¦å·å¯ä»¥çœå»ã€‚[SEP]è¡¨ç¤ºåˆ†å¥ç¬¦å·ï¼Œç”¨äºæ–­å¼€è¾“å…¥è¯­æ–™ä¸­çš„ä¸¤ä¸ªå¥å­ã€‚\u003c/p\u003e\n\u003cp\u003eBert åœ¨å¤„ç†è‹±æ–‡æ–‡æœ¬æ—¶åªéœ€è¦ 30522 ä¸ªè¯ï¼ŒToken Embeddings å±‚ä¼šå°†æ¯ä¸ªè¯è½¬æ¢æˆ 768 ç»´å‘é‡ï¼Œå¦‚ä¸‹å›¾çš„ä¾‹å­ä¸­ï¼Œ 5 ä¸ªToken ä¼šè¢«è½¬æ¢æˆä¸€ä¸ª (5, 768) çš„çŸ©é˜µæˆ– (1, 5, 768) çš„å¼ é‡ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p3\" loading=\"lazy\" src=\"/bert/p3.jpg\"\u003e\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e\u003cstrong\u003esegment embedding\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eç”¨æ¥åŒºåˆ†ä¸¤ç§å¥å­ã€‚bertåœ¨è®­ç»ƒæ—¶åŒ…æ‹¬ä¸¤ç§ä»»åŠ¡ï¼Œå…¶ä¸€æ˜¯MLMï¼ˆmasked language modelï¼Œæ©ç è¯­è¨€æ¨¡å‹ï¼‰ï¼Œå°±æ˜¯é®ä½æŸä¸ªè¯è®©æ¨¡å‹å»é¢„æµ‹ï¼›å…¶äºŒæ˜¯NSPï¼ˆnext sentence predictionï¼Œä¸‹ä¸€å¥é¢„æµ‹ï¼‰ï¼Œè¾“å…¥ä¸¤ä¸ªå¥å­ï¼Œè®©æ¨¡å‹åˆ¤æ–­æ˜¯å¦ç›¸å…³ã€‚è¿™æ—¶å€™å°±éœ€è¦segment embeddingå¯¹ä¸¤ä¸ªå¥å­åšåŒºåˆ«ã€‚\u003c/p\u003e\n\u003cp\u003eè¿›è¡Œé—®ç­”ç­‰éœ€è¦é¢„æµ‹ä¸‹ä¸€å¥çš„ä»»åŠ¡æ—¶ï¼Œsegment embeddingå±‚æŠŠ0èµ‹å€¼ç»™ç¬¬ä¸€ä¸ªå¥å­çš„å„tokenï¼ŒæŠŠ1èµ‹å€¼ç»™ç¬¬äºŒä¸ªå¥å­çš„å„tokenã€‚åœ¨æ–‡æœ¬åˆ†ç±»ä»»åŠ¡æ—¶ï¼Œsegment embeddingå…¨éƒ¨ä¸º0ã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"p4\" loading=\"lazy\" src=\"/bert/p4.jpg\"\u003e\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e\u003cstrong\u003eposition embedding\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003eå’Œtransformerçš„å®ç°ä¸åŒï¼Œä¸æ˜¯å›ºå®šçš„ä¸‰è§’å‡½æ•°ï¼Œè€Œæ˜¯å¯å­¦ä¹ çš„å‚æ•°ã€‚\u003c/p\u003e\n\u003cp\u003eTransformer ä¸­é€šè¿‡æ¤å…¥å…³äº Token çš„ç›¸å¯¹ä½ç½®æˆ–è€…ç»å¯¹ä½ç½®ä¿¡æ¯æ¥è¡¨ç¤ºåºåˆ—çš„é¡ºåºä¿¡æ¯ã€‚ä½œè€…æµ‹è¯•ç”¨å­¦ä¹ çš„æ–¹æ³•æ¥å¾—åˆ° Position Embeddingsï¼Œæœ€ç»ˆå‘ç°å›ºå®šä½ç½®å’Œç›¸å¯¹ä½ç½®æ•ˆæœå·®ä¸å¤šï¼Œæ‰€ä»¥æœ€åç”¨çš„æ˜¯å›ºå®šä½ç½®çš„ï¼Œè€Œæ­£å¼¦å¯ä»¥å¤„ç†æ›´é•¿çš„ Sequenceï¼Œä¸”å¯ä»¥ç”¨å‰é¢ä½ç½®çš„å€¼çº¿æ€§è¡¨ç¤ºåé¢çš„ä½ç½®ã€‚\u003c/p\u003e","title":"BERT"},{"content":"ç®€ä»‹ï¼šæ£€ç´¢ç›¸å…³ç®—æ³•çš„å­¦ä¹ \n1.TF-IDF 1.1åŸç† TFï¼šterm frequencyï¼ˆè¯é¢‘ï¼‰\nIDFï¼šinverse document frequencyï¼ˆé€†æ–‡æ¡£é¢‘ç‡ï¼‰\nå­—è¯çš„é‡è¦æ€§éšç€å®ƒåœ¨æ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°æˆæ­£æ¯”å¢åŠ ï¼Œä½†åŒæ—¶ä¼šéšç€å®ƒåœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡æˆåæ¯”ä¸‹é™ã€‚\nTF-IDFçš„ä¸»è¦æ€æƒ³æ˜¯ï¼šå¦‚æœæŸä¸ªå•è¯åœ¨ä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„é¢‘ç‡é«˜ï¼ˆTFé«˜ï¼‰ï¼Œå¹¶ä¸”åœ¨å…¶ä»–æ–‡ç« ä¸­å¾ˆå°‘å‡ºç°ï¼ˆIDFé«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºæ­¤è¯æˆ–è€…çŸ­è¯­å…·æœ‰å¾ˆå¥½çš„ç±»åˆ«åŒºåˆ†èƒ½åŠ›ï¼Œé€‚åˆç”¨æ¥åˆ†ç±»ã€‚\n$TF=\\frac{æŸä¸ªè¯åœ¨æ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°}{æ–‡ç« çš„æ€»è¯æ•°}$\nè€ƒè™‘åˆ°æ–‡ç« é•¿çŸ­ä¸åŒï¼Œé™¤ä»¥æ€»è¯æ•°è¿›è¡Œæ ‡å‡†åŒ–\n$IDF=log(\\frac{è¯­æ–™åº“çš„æ–‡ç« æ€»æ•°}{åŒ…å«è¯¥è¯çš„æ–‡ç« æ•°é‡+1})$\nåŠ 1é˜²æ­¢ä¸å­˜åœ¨åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ—¶åˆ†æ¯ä¸º0\n$TF-IDF=TF \\times IDF$\nä¼˜ç‚¹ï¼š\nç®€å•å¿«é€Ÿã€æ˜“ç†è§£ ç¼ºç‚¹ï¼š\næ²¡è€ƒè™‘è¯è¯­çš„è¯­ä¹‰ ä»…ç”¨è¯é¢‘è€ƒè™‘è¯è¯­çš„é‡è¦æ€§ä¸å¤Ÿå…¨é¢ã€‚æŒ‰ç…§ä¼ ç»ŸTF-IDFï¼Œå¾€å¾€ä¸€äº›ç”Ÿåƒ»è¯çš„IDF(åæ–‡æ¡£é¢‘ç‡)ä¼šæ¯”è¾ƒé«˜ã€å› æ­¤è¿™äº›ç”Ÿåƒ»è¯å¸¸ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯æ–‡æ¡£å…³é”®è¯ã€‚ æ²¡æœ‰è€ƒè™‘ç‰¹å¾è¯çš„ä½ç½®å› ç´ å¯¹æ–‡æœ¬çš„åŒºåˆ†åº¦ï¼Œè¯æ¡å‡ºç°åœ¨æ–‡æ¡£çš„ä¸åŒä½ç½®æ—¶ï¼Œå¯¹åŒºåˆ†åº¦çš„è´¡çŒ®å¤§å°æ˜¯ä¸ä¸€æ ·çš„ã€‚ 1.2è‡ªå·±å®ç° import math # è®¡ç®—æ¯å¥è¯çš„è¯é¢‘ def counter(word_list): wordcount = [] for doc in word_list: count = {} for word in doc: count[word] = count.get(word, 0) + 1 wordcount.append(count) return wordcount # è®¡ç®—tf=æŸä¸ªè¯åœ¨æ–‡ç« ä¸­å‡ºç°çš„æ€»æ¬¡æ•°/æ–‡ç« çš„æ€»è¯æ•° def tf(word, word_list): return word_list.get(word) / sum(word_list.values()) # ç»Ÿè®¡å«æœ‰è¯¥å•è¯çš„å¥å­æ•° def count_sentence(word, wordcount): return sum(1 for i in wordcount if i.get(word)) # è®¡ç®—idf=log(è¯­æ–™åº“ä¸­çš„æ–‡æ¡£æ€»æ•°/(åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ•°+1)) def idf(word, wordcount): return math.log(len(wordcount) + 1 / count_sentence(word, wordcount) + 1) + 1 # tf-idf=tf*idf def tfidf(word, word_list, wordcount): return tf(word, word_list) * idf(word, wordcount) if __name__ == \u0026#34;__main__\u0026#34;: docs = [ \u0026#34;what is the weather like today\u0026#34;, \u0026#34;what is for dinner tonight\u0026#34;, \u0026#34;this is a question worth pondering\u0026#34;, \u0026#34;it is a beautiful day today\u0026#34; ] word_list = [] # è®°å½•æ¯ä¸ªæ–‡æ¡£åˆ†è¯åçš„ç»“æœ for doc in docs: word_list.append(doc.split(\u0026#34; \u0026#34;)) # ä½¿ç”¨åœç”¨è¯ # stopwords = [\u0026#34;is\u0026#34;, \u0026#34;the\u0026#34;] # for i in docs: # all_words = i.split() # new_words = [] # for j in all_words: # if j not in stopwords: # new_words.append(j) # word_list.append(new_words) wordcount = counter(word_list) # ç»Ÿè®¡æ¯ä¸ªæ–‡æ¡£è¯çš„æ¬¡æ•° for cnt, doc in enumerate(wordcount): print(\u0026#34;doc{}\u0026#34;.format(cnt)) for word, _ in doc.items(): print(\u0026#34;word:{} --- TF-IDF:{}\u0026#34;.format(word, tfidf(word, doc, wordcount))) 1.3ä½¿ç”¨sklearnåº“ from sklearn.feature_extraction.text import TfidfVectorizer if __name__ == \u0026#34;__main__\u0026#34;: docs = [ \u0026#34;what is the weather like today\u0026#34;, \u0026#34;what is for dinner tonight\u0026#34;, \u0026#34;this is a question worth pondering\u0026#34;, \u0026#34;it is a beautiful day today\u0026#34; ] tfidf_vec = TfidfVectorizer() # åˆ©ç”¨fit_transformå¾—åˆ°TFIDFçŸ©é˜µ tfidf_matrix = tfidf_vec.fit_transform(docs) # åˆ©ç”¨get_feature_names_outå¾—åˆ°ä¸é‡å¤çš„å•è¯ print(tfidf_vec.get_feature_names_out()) # åˆ©ç”¨vocabulary_å¾—åˆ°å„å•æ¬¡çš„ç¼–å· print(tfidf_vec.vocabulary_) # è¾“å‡ºTFIDFçŸ©é˜µï¼Œå³æ¯ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„tfidfå€¼ print(tfidf_matrix) 2.BM25 2.1åŸç† BM25æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡æ£€ç´¢æ¡†æ¶çš„æ’åºå‡½æ•°ï¼Œç”¨äºè®¡ç®—æŸ¥è¯¢ï¼ˆQueryï¼‰ä¸æ–‡æ¡£ï¼ˆDocumentï¼‰çš„ç›¸å…³æ€§å¾—åˆ†ã€‚\nå¯¹äºTF-IDFç®—æ³•ï¼Œå¦‚æœæ–‡æ¡£é•¿ï¼Œè¯è¯­å¤šï¼ŒTFå€¼å°±ä¼šå¾ˆå¤§ã€‚BM25é€šè¿‡bå‚æ•°å¯¹æ–‡æ¡£é•¿åº¦è¿›è¡Œæ‰“å‹ï¼Œéšç€TFçš„å¢åŠ ï¼ŒBM25scoreè¶‹äºç¨³å®šï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nç¬¦å·è¯´æ˜:\n$ Q $: æŸ¥è¯¢ï¼Œç”±ä¸€ç»„è¯é¡¹ç»„æˆ $ Q = (q_1, q_2, ..., q_n) $ $ D $: æ–‡æ¡£ $ f_i $: è¯é¡¹ $ q_i $ åœ¨æ–‡æ¡£ $ D $ ä¸­çš„å‡ºç°é¢‘ç‡ï¼ˆè¯é¢‘ï¼ŒTFï¼‰ $ dl $: æ–‡æ¡£é•¿åº¦ï¼ˆæ–‡æ¡£ä¸­çš„è¯é¡¹æ€»æ•°ï¼‰ $ avgdl $: è¯­æ–™åº“ä¸­æ‰€æœ‰æ–‡æ¡£çš„å¹³å‡é•¿åº¦ $ N $: è¯­æ–™åº“ä¸­æ–‡æ¡£æ€»æ•° $ n_i $: åŒ…å«è¯é¡¹ $ q_i $ çš„æ–‡æ¡£æ•°é‡ $ k $: è¯é¢‘è°ƒèŠ‚å‚æ•°ï¼ˆé€šå¸¸å–1.2~2.0ï¼‰ $ b $: æ–‡æ¡£é•¿åº¦è°ƒèŠ‚å‚æ•°ï¼ˆé€šå¸¸å–0.75ï¼‰ å‚æ•° å…¸å‹å€¼ ä½œç”¨ $ k $ 1.2~2.0 æ§åˆ¶è¯é¢‘é¥±å’Œåº¦ï¼Œå€¼è¶Šå¤§é¥±å’Œåº¦å˜åŒ–è¶Šæ…¢ $ b $ 0.75 æ§åˆ¶æ–‡æ¡£é•¿åº¦å½’ä¸€åŒ–ç¨‹åº¦ï¼Œ0=ä¸å½’ä¸€åŒ–ï¼Œ1=å®Œå…¨å½’ä¸€åŒ– b å‚æ•°é»˜è®¤ 0.75ï¼Œä¸»è¦æ˜¯å¯¹é•¿æ–‡æ¡£åšæƒ©ç½šã€‚å¦‚æœè®¾ç½®ä¸º 0ï¼Œåˆ†æ•°å°†ä¸æ–‡æ¡£çš„é•¿åº¦æ— å…³ã€‚ä»ä¸‹å›¾å¯ä»¥çœ‹åˆ°ï¼Œb=0æ—¶ï¼ŒLä¸åˆ†æ•°æ— å…³ï¼Œb=1æ—¶ï¼ŒLè¶Šå¤§ï¼Œåˆ†æ•°æ‰“å‹è¶Šå‰å®³ã€‚\nå®Œæ•´å…¬å¼ï¼š\n$$ \\text{BM25}(D, Q) = \\sum_{i=1}^{n} \\frac{{(k+1) \\cdot f_i}}{{f_i + k \\cdot (1 - b + b \\cdot \\frac{{\\lvert D \\rvert}}{{\\text{avgdl}}})}} \\cdot \\log\\left(\\frac{{N - n_i + 0.5}}{{n_i + 0.5}}\\right) $$å•ä¸ªè¯é¡¹å¾—åˆ†\nå¯¹äºæŸ¥è¯¢ä¸­çš„å•ä¸ªè¯é¡¹ $ q_i $ï¼Œå…¶BM25å¾—åˆ†ä¸ºï¼š\n$\\text{score}(q_i, D) = \\text{IDF}(q_i) \\cdot \\frac{f_i \\cdot (k_1 + 1)}{f_i + k_1 \\cdot (1 - b + b \\cdot \\frac{dl}{avgdl})}$\nIDFè®¡ç®—\né€†æ–‡æ¡£é¢‘ç‡ï¼ˆIDFï¼‰çš„è®¡ç®—å…¬å¼ä¸ºï¼š\n$\\text{IDF}(q_i) = \\log \\left( \\frac{N - n_i + 0.5}{n_i + 0.5} + 1 \\right)$\næ•´ä½“æŸ¥è¯¢å¾—åˆ†\nå¯¹äºå®Œæ•´æŸ¥è¯¢ $ Q $ï¼ŒBM25å¾—åˆ†ä¸ºæ‰€æœ‰è¯é¡¹å¾—åˆ†çš„æ€»å’Œï¼š $\\text{BM25}(Q, D) = \\sum_{i=1}^{n} \\text{score}(q_i, D)$\n2.2è‡ªå·±å®ç° import math from collections import Counter class BM25: def __init__(self, docs, k1=1.5, b=0.75): \u0026#34;\u0026#34;\u0026#34; BM25ç®—æ³•çš„æ„é€ å™¨ :param docs: åˆ†è¯åçš„æ–‡æ¡£åˆ—è¡¨ï¼Œæ¯ä¸ªæ–‡æ¡£æ˜¯ä¸€ä¸ªåŒ…å«è¯æ±‡çš„åˆ—è¡¨ :param k1: BM25ç®—æ³•ä¸­çš„è°ƒèŠ‚å‚æ•°k1 :param b: BM25ç®—æ³•ä¸­çš„è°ƒèŠ‚å‚æ•°b \u0026#34;\u0026#34;\u0026#34; self.docs = docs self.k1 = k1 self.b = b self.doc_len = [len(doc) for doc in docs] # è®¡ç®—æ¯ä¸ªæ–‡æ¡£çš„é•¿åº¦ self.avgdl = sum(self.doc_len) / len(docs) # è®¡ç®—æ‰€æœ‰æ–‡æ¡£çš„å¹³å‡é•¿åº¦ self.doc_freqs = [] # å­˜å‚¨æ¯ä¸ªæ–‡æ¡£çš„è¯é¢‘ self.idf = {} # å­˜å‚¨æ¯ä¸ªè¯çš„é€†æ–‡æ¡£é¢‘ç‡ self.initialize() def initialize(self): \u0026#34;\u0026#34;\u0026#34; åˆå§‹åŒ–æ–¹æ³•ï¼Œè®¡ç®—æ‰€æœ‰è¯çš„é€†æ–‡æ¡£é¢‘ç‡ \u0026#34;\u0026#34;\u0026#34; df = {} # ç”¨äºå­˜å‚¨æ¯ä¸ªè¯åœ¨å¤šå°‘ä¸åŒæ–‡æ¡£ä¸­å‡ºç° for doc in self.docs: # ä¸ºæ¯ä¸ªæ–‡æ¡£åˆ›å»ºä¸€ä¸ªè¯é¢‘ç»Ÿè®¡ self.doc_freqs.append(Counter(doc)) # æ›´æ–°dfå€¼ for word in set(doc): df[word] = df.get(word, 0) + 1 # è®¡ç®—æ¯ä¸ªè¯çš„IDFå€¼ï¼ˆå‡ºç°çš„æ–‡æ¡£æ•°è¶Šå°‘ï¼Œå¾—åˆ†è¶Šé«˜ï¼‰ for word, freq in df.items(): self.idf[word] = math.log((len(self.docs) - freq + 0.5) / (freq + 0.5) + 1) def score(self, doc, query): \u0026#34;\u0026#34;\u0026#34; è®¡ç®—æ–‡æ¡£ä¸æŸ¥è¯¢çš„BM25å¾—åˆ† :param doc: æ–‡æ¡£çš„ç´¢å¼• :param query: æŸ¥è¯¢è¯åˆ—è¡¨ :return: è¯¥æ–‡æ¡£ä¸æŸ¥è¯¢çš„ç›¸å…³æ€§å¾—åˆ† \u0026#34;\u0026#34;\u0026#34; score = 0.0 for word in query: if word in self.doc_freqs[doc]: freq = self.doc_freqs[doc][word] # è¯åœ¨æ–‡æ¡£ä¸­çš„é¢‘ç‡ # åº”ç”¨BM25è®¡ç®—å…¬å¼ score += (self.idf[word] * freq * (self.k1 + 1)) / ( freq + self.k1 * (1 - self.b + self.b * self.doc_len[doc] / self.avgdl)) return score if __name__ == \u0026#34;__main__\u0026#34;: # ç¤ºä¾‹æ–‡æ¡£é›†å’ŒæŸ¥è¯¢ docs = [[\u0026#34;the\u0026#34;, \u0026#34;quick\u0026#34;, \u0026#34;brown\u0026#34;, \u0026#34;fox\u0026#34;], [\u0026#34;the\u0026#34;, \u0026#34;lazy\u0026#34;, \u0026#34;dog\u0026#34;], [\u0026#34;the\u0026#34;, \u0026#34;quick\u0026#34;, \u0026#34;dog\u0026#34;], [\u0026#34;the\u0026#34;, \u0026#34;quick\u0026#34;, \u0026#34;brown\u0026#34;, \u0026#34;brown\u0026#34;, \u0026#34;fox\u0026#34;]] query = [\u0026#34;quick\u0026#34;, \u0026#34;brown\u0026#34;] # åˆå§‹åŒ–BM25æ¨¡å‹å¹¶è®¡ç®—å¾—åˆ† bm25 = BM25(docs) scores = [bm25.score(i, query) for i in range(len(docs))] print(scores) 2.3rank_bm25åº“ from rank_bm25 import BM25Okapi import jieba corpus = [ \u0026#34;BM25æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¿¡æ¯æ£€ç´¢ç®—æ³•\u0026#34;, \u0026#34;è¿™ä¸ªPythonåº“å®ç°äº†BM25ç®—æ³•\u0026#34;, \u0026#34;ä¿¡æ¯æ£€ç´¢æ˜¯æœç´¢å¼•æ“çš„æ ¸å¿ƒæŠ€æœ¯\u0026#34;, \u0026#34;BM25æ¯”ä¼ ç»Ÿçš„TF-IDFæ•ˆæœæ›´å¥½\u0026#34;, \u0026#34;ä¸­æ–‡ä¿¡æ¯æ£€ç´¢éœ€è¦å…ˆè¿›è¡Œåˆ†è¯å¤„ç†\u0026#34;, \u0026#34;è‡ªç„¶è¯­è¨€å¤„ç†æ˜¯äººå·¥æ™ºèƒ½çš„é‡è¦é¢†åŸŸ\u0026#34;, \u0026#34;Pythonæ˜¯æœ€å—æ¬¢è¿çš„ç¼–ç¨‹è¯­è¨€ä¹‹ä¸€\u0026#34;, ] tokenized_corpus = [list(jieba.cut(doc)) for doc in corpus] bm25 = BM25Okapi(tokenized_corpus) def search(query, top_n=3): tokenized_query = list(jieba.cut(query)) doc_scores = bm25.get_scores(tokenized_query) top_docs = bm25.get_top_n(tokenized_query, corpus, n=top_n) return doc_scores, top_docs query = \u0026#34;Pythonä¿¡æ¯æ£€ç´¢\u0026#34; print(f\u0026#34;æŸ¥è¯¢: \u0026#39;{query}\u0026#39;\u0026#34;) scores, results = search(query) print(\u0026#34;\\nç›¸å…³æ–‡æ¡£:\u0026#34;) for i, (score, doc) in enumerate(zip(scores, corpus)): print(f\u0026#34;{i}. [Score: {score:.2f}] {doc}\u0026#34;) print(\u0026#34;\\næœ€ç›¸å…³çš„3ä¸ªæ–‡æ¡£:\u0026#34;) for i, doc in enumerate(results): print(f\u0026#34;{i+1}. {doc}\u0026#34;) 2.4bm25s ä¸€ä¸ªå¿«é€Ÿçš„bm25å®ç°æ–¹æ³•ï¼Œåœ¨å¤§æ•°æ®ä¸Šæ¯”å…¶å®ƒå®ç°è¦å¿«ï¼Œå¾ˆå¥½ç”¨ã€‚\né¡¹ç›®åœ°å€ï¼šxhluca/bm25s: Fast lexical search implementing BM25 in Python using Numpy, Numba and Scipy\n","permalink":"https://Rook1eChan.github.io/posts/%E6%A3%80%E7%B4%A2/","summary":"\u003cp\u003e\u003cem\u003eç®€ä»‹ï¼šæ£€ç´¢ç›¸å…³ç®—æ³•çš„å­¦ä¹ \u003c/em\u003e\u003c/p\u003e\n\u003cBR\u003e\n\u003ch1 id=\"1tf-idf\"\u003e1.TF-IDF\u003c/h1\u003e\n\u003ch2 id=\"11åŸç†\"\u003e1.1åŸç†\u003c/h2\u003e\n\u003cp\u003eTFï¼šterm frequencyï¼ˆè¯é¢‘ï¼‰\u003c/p\u003e\n\u003cp\u003eIDFï¼šinverse document frequencyï¼ˆé€†æ–‡æ¡£é¢‘ç‡ï¼‰\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eå­—è¯çš„é‡è¦æ€§éšç€å®ƒåœ¨æ–‡ä»¶ä¸­å‡ºç°çš„æ¬¡æ•°æˆæ­£æ¯”å¢åŠ ï¼Œä½†åŒæ—¶ä¼šéšç€å®ƒåœ¨è¯­æ–™åº“ä¸­å‡ºç°çš„é¢‘ç‡æˆåæ¯”ä¸‹é™ã€‚\u003c/strong\u003e\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eTF-IDFçš„ä¸»è¦æ€æƒ³æ˜¯\u003c/strong\u003eï¼šå¦‚æœæŸä¸ªå•è¯åœ¨ä¸€ç¯‡æ–‡ç« ä¸­å‡ºç°çš„é¢‘ç‡é«˜ï¼ˆTFé«˜ï¼‰ï¼Œå¹¶ä¸”åœ¨å…¶ä»–æ–‡ç« ä¸­å¾ˆå°‘å‡ºç°ï¼ˆIDFé«˜ï¼‰ï¼Œåˆ™è®¤ä¸ºæ­¤è¯æˆ–è€…çŸ­è¯­å…·æœ‰å¾ˆå¥½çš„ç±»åˆ«åŒºåˆ†èƒ½åŠ›ï¼Œé€‚åˆç”¨æ¥åˆ†ç±»ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e$TF=\\frac{æŸä¸ªè¯åœ¨æ–‡ç« ä¸­å‡ºç°çš„æ¬¡æ•°}{æ–‡ç« çš„æ€»è¯æ•°}$\u003c/p\u003e\n\u003cp\u003eè€ƒè™‘åˆ°æ–‡ç« é•¿çŸ­ä¸åŒï¼Œé™¤ä»¥æ€»è¯æ•°è¿›è¡Œæ ‡å‡†åŒ–\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e$IDF=log(\\frac{è¯­æ–™åº“çš„æ–‡ç« æ€»æ•°}{åŒ…å«è¯¥è¯çš„æ–‡ç« æ•°é‡+1})$\u003c/p\u003e\n\u003cp\u003eåŠ 1é˜²æ­¢ä¸å­˜åœ¨åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ—¶åˆ†æ¯ä¸º0\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e$TF-IDF=TF \\times IDF$\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e\u003cstrong\u003eä¼˜ç‚¹ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eç®€å•å¿«é€Ÿã€æ˜“ç†è§£\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003eç¼ºç‚¹ï¼š\u003c/strong\u003e\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eæ²¡è€ƒè™‘è¯è¯­çš„è¯­ä¹‰\u003c/li\u003e\n\u003cli\u003eä»…ç”¨è¯é¢‘è€ƒè™‘è¯è¯­çš„é‡è¦æ€§ä¸å¤Ÿå…¨é¢ã€‚æŒ‰ç…§ä¼ ç»ŸTF-IDFï¼Œå¾€å¾€ä¸€äº›ç”Ÿåƒ»è¯çš„IDF(åæ–‡æ¡£é¢‘ç‡)ä¼šæ¯”è¾ƒé«˜ã€å› æ­¤è¿™äº›ç”Ÿåƒ»è¯å¸¸ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯æ–‡æ¡£å…³é”®è¯ã€‚\u003c/li\u003e\n\u003cli\u003eæ²¡æœ‰è€ƒè™‘ç‰¹å¾è¯çš„ä½ç½®å› ç´ å¯¹æ–‡æœ¬çš„åŒºåˆ†åº¦ï¼Œè¯æ¡å‡ºç°åœ¨æ–‡æ¡£çš„ä¸åŒä½ç½®æ—¶ï¼Œå¯¹åŒºåˆ†åº¦çš„è´¡çŒ®å¤§å°æ˜¯ä¸ä¸€æ ·çš„ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003cBR\u003e\n\u003ch2 id=\"12è‡ªå·±å®ç°\"\u003e1.2è‡ªå·±å®ç°\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"nn\"\u003emath\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è®¡ç®—æ¯å¥è¯çš„è¯é¢‘\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ecount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eword\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è®¡ç®—tf=æŸä¸ªè¯åœ¨æ–‡ç« ä¸­å‡ºç°çš„æ€»æ¬¡æ•°/æ–‡ç« çš„æ€»è¯æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evalues\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# ç»Ÿè®¡å«æœ‰è¯¥å•è¯çš„å¥å­æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003ecount_sentence\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"nb\"\u003esum\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# è®¡ç®—idf=log(è¯­æ–™åº“ä¸­çš„æ–‡æ¡£æ€»æ•°/(åŒ…å«è¯¥è¯çš„æ–‡æ¡£æ•°+1))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003eidf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003emath\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003elog\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"nb\"\u003elen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e \u003cspan class=\"o\"\u003e/\u003c/span\u003e \u003cspan class=\"n\"\u003ecount_sentence\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e+\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e# tf-idf=tf*idf\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edef\u003c/span\u003e \u003cspan class=\"nf\"\u003etfidf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003etf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eidf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"vm\"\u003e__name__\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;__main__\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003edocs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;what is the weather like today\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;what is for dinner tonight\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;this is a question worth pondering\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;it is a beautiful day today\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[]\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# è®°å½•æ¯ä¸ªæ–‡æ¡£åˆ†è¯åçš„ç»“æœ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edocs\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eappend\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esplit\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34; \u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# ä½¿ç”¨åœç”¨è¯\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# stopwords = [\u0026#34;is\u0026#34;, \u0026#34;the\u0026#34;]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# for i in docs:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#     all_words = i.split()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#     new_words = []\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#     for j in all_words:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#         if j not in stopwords:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#             new_words.append(j)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e#     word_list.append(new_words)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ecounter\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword_list\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e  \u003cspan class=\"c1\"\u003e# ç»Ÿè®¡æ¯ä¸ªæ–‡æ¡£è¯çš„æ¬¡æ•°\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003ecnt\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"nb\"\u003eenumerate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e):\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;doc\u003c/span\u003e\u003cspan class=\"si\"\u003e{}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ecnt\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003e_\u003c/span\u003e \u003cspan class=\"ow\"\u003ein\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eitems\u003c/span\u003e\u003cspan class=\"p\"\u003e():\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;word:\u003c/span\u003e\u003cspan class=\"si\"\u003e{}\u003c/span\u003e\u003cspan class=\"s2\"\u003e --- TF-IDF:\u003c/span\u003e\u003cspan class=\"si\"\u003e{}\u003c/span\u003e\u003cspan class=\"s2\"\u003e\u0026#34;\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eformat\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003etfidf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eword\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003edoc\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ewordcount\u003c/span\u003e\u003cspan class=\"p\"\u003e)))\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cBR\u003e\n\u003ch2 id=\"13ä½¿ç”¨sklearnåº“\"\u003e1.3ä½¿ç”¨sklearnåº“\u003c/h2\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-python\" data-lang=\"python\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kn\"\u003efrom\u003c/span\u003e \u003cspan class=\"nn\"\u003esklearn.feature_extraction.text\u003c/span\u003e \u003cspan class=\"kn\"\u003eimport\u003c/span\u003e \u003cspan class=\"n\"\u003eTfidfVectorizer\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"vm\"\u003e__name__\u003c/span\u003e \u003cspan class=\"o\"\u003e==\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;__main__\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003edocs\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;what is the weather like today\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;what is for dinner tonight\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;this is a question worth pondering\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"s2\"\u003e\u0026#34;it is a beautiful day today\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003etfidf_vec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003eTfidfVectorizer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# åˆ©ç”¨fit_transformå¾—åˆ°TFIDFçŸ©é˜µ\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003etfidf_matrix\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003etfidf_vec\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003efit_transform\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edocs\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# åˆ©ç”¨get_feature_names_outå¾—åˆ°ä¸é‡å¤çš„å•è¯\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etfidf_vec\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget_feature_names_out\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# åˆ©ç”¨vocabulary_å¾—åˆ°å„å•æ¬¡çš„ç¼–å·\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etfidf_vec\u003c/span\u003e\u003cspan class=\"o\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003evocabulary_\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e# è¾“å‡ºTFIDFçŸ©é˜µï¼Œå³æ¯ä¸ªæ–‡æ¡£ä¸­æ¯ä¸ªè¯çš„tfidfå€¼\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"nb\"\u003eprint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003etfidf_matrix\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cBR\u003e\n\u003ch1 id=\"2bm25\"\u003e2.BM25\u003c/h1\u003e\n\u003ch2 id=\"21åŸç†\"\u003e2.1åŸç†\u003c/h2\u003e\n\u003cp\u003eBM25æ˜¯ä¸€ç§åŸºäºæ¦‚ç‡æ£€ç´¢æ¡†æ¶çš„æ’åºå‡½æ•°ï¼Œç”¨äºè®¡ç®—æŸ¥è¯¢ï¼ˆQueryï¼‰ä¸æ–‡æ¡£ï¼ˆDocumentï¼‰çš„ç›¸å…³æ€§å¾—åˆ†ã€‚\u003c/p\u003e","title":"Retrieval_Learning"},{"content":"ICLR2025ï¼Œæ¥è‡ªGoogle DeepMindå›¢é˜Ÿçš„å·¥ä½œ\nhttps://arxiv.org/abs/2410.04343v2\n0.ç›®æ ‡ å…ˆå‰å¯¹äºRAGæ¨ç†æ‰©å±•çš„ç ”ç©¶ä¸»è¦é›†ä¸­äºæä¾›æ›´å¤šçš„çŸ¥è¯†ï¼Œä½†åªå¢åŠ çŸ¥è¯†çš„æ•°é‡æ˜¯ä¸å¤Ÿçš„ã€‚å½“å‰çš„LLMåœ¨å¤„ç†é•¿ä¸Šä¸‹æ–‡æ—¶ä»å­˜åœ¨æŒ‘æˆ˜ã€‚æ¯”å¦‚ï¼Œåœ¨è¶…é•¿åºåˆ—ä¸­å®šä½æœ‰æ•ˆä¿¡æ¯çš„èƒ½åŠ›æœ‰é™ã€æœ€ä½³æ€§èƒ½å¾€å¾€æ˜¯åœ¨æ²¡æœ‰å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹å®ç°çš„ã€è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼ˆæ–‡æ¡£æ•°é‡ï¼‰çš„æ£€ç´¢ä¼šä½¿æ€§èƒ½åœæ»ç”šè‡³ä¸‹é™ã€‚\nç›®æ ‡æ˜¯æ‰¾åˆ°ä¸Šä¸‹æ–‡é•¿åº¦ä¸æœ€ä¼˜é…ç½®ä¹‹é—´çš„å…³ç³»ï¼Œèƒ½å¤Ÿé¢„æµ‹æœ€ä½³æ¨ç†å‚æ•°ï¼Œæœ€å¤§é™åº¦æé«˜RAGæ€§èƒ½ã€‚å…¶ä¸­DRAGçš„å‚æ•°ä¸ºæ£€ç´¢åˆ°çš„æ–‡æ¡£æ•°é‡å’Œç¤ºä¾‹æ•°é‡ã€‚IterDRAGçš„å‚æ•°ä¸ºç”Ÿæˆæ¬¡æ•°ã€‚\n1.è´¡çŒ® æå‡ºä¸¤ç§RAGæ–¹æ³•ï¼šDRAGï¼ˆåŸºäºæ¼”ç¤ºçš„RAGï¼Œä¸ºLLMæä¾›å¤šä¸ªRAGç¤ºä¾‹ï¼‰å’ŒIterDRAGï¼ˆåŸºäºè¿­ä»£æ¼”ç¤ºçš„RAGï¼Œå°†è¾“å…¥æŸ¥è¯¢åˆ†è§£ä¸ºæ›´ç®€å•çš„å­æŸ¥è¯¢ï¼Œè¿­ä»£æ£€ç´¢ï¼‰ã€‚å¹¶è¯æ˜äº†è¿™ä¸¤ç§æ–¹æ³•ä¼˜äºä»…æä¾›çŸ¥è¯†çš„RAGã€‚ å¾—åˆ°äº†RAGçš„æ¨ç†ç¼©æ”¾å®šå¾‹ï¼šåœ¨æœ€ä½³é…ç½®ä¸‹ï¼ŒRAGæ€§èƒ½éšæœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦çº¿æ€§å˜åŒ–ã€‚ æ ¹æ®å®šå¾‹å¯¹RAGæ€§èƒ½ä¸ä¸åŒæ¨ç†å‚æ•°å»ºæ¨¡ï¼Œæ¨å¯¼å‡ºè®¡ç®—åˆ†é…æ¨¡å‹ï¼Œä¸ºé•¿ä¸Šä¸‹æ–‡RAGçš„ä¼˜åŒ–æä¾›äº†æŒ‡å¯¼ã€‚ 2.ç›¸å…³å·¥ä½œ 2.1é•¿ä¸Šä¸‹æ–‡LLMs æ—©æœŸé‡‡ç”¨ç¨€ç–/ä½ç§©æ ¸æ¥å‡å°‘å†…å­˜éœ€æ±‚ã€‚\nI. Beltagy, M. E. Peters, and A. Cohan. Longformer: The long-document transformer. arXiv preprint arXiv:2004.05150, 2020.\nK. Choromanski, V. Likhosherstov, D. Dohan, X. Song, A. Gane, T. Sarlos, P. Hawkins, J. Davis, A. Mohiuddin, L. Kaiser, et al. Rethinking attention with performers. arXiv preprint arXiv:2009.14794,2020.\nN. Kitaev, L. Kaiser, and A. Levskaya. Reformer: The efficient transformer. In International Conference on Learning Representations, 2019.\nM. Zaheer, G. Guruganesh, K. A. Dubey, J. Ainslie, C. Alberti, S. Ontanon, P. Pham, A. Ravula, Q. Wang, L. Yang, et al. Big bird: Transformers for longer sequences. Advances in neural information processing systems, 33:17283â€“17297, 2020\næ­¤å¤–é€’å½’å’ŒçŠ¶æ€ç©ºé—´æ¨¡å‹ï¼ˆSSMsï¼‰è¢«æå‡ºï¼Œä½œä¸ºåŸºäºtransformeræ¨¡å‹çš„æœ‰æ•ˆæ›¿ä»£æ–¹æ¡ˆã€‚\nM. Beck, K. PÃ¶ppel, M. Spanring, A. Auer, O. Prudnikova, M. Kopp, G. Klambauer, J. Brandstetter, and S. Hochreiter. xLSTM: Extended long short-term memory. arXiv preprint arXiv:2405.04517, 2024\nA. Gu and T. Dao. Mamba: Linear-time sequence modeling with selective state spaces. arXiv preprint arXiv:2312.00752, 2023.\nB. Peng, E. Alcaide, Q. Anthony, A. Albalak, S. Arcadinho, S. Biderman, H. Cao, X. Cheng, M. Chung, L. Derczynski, et al. RWKV: Reinventing rnns for the transformer era. In Findings of the Association for Computational Linguistics: EMNLP 2023, pages 14048â€“14077, 2023a.\nå¯¹äºå› æœLLMsï¼Œå¤–æ¨å’Œæ’å€¼æ–¹æ³•å·²è¢«è¯æ˜åœ¨æ‰©å±•ä¸Šä¸‹æ–‡çª—å£é•¿åº¦æ–¹é¢éå¸¸æœ‰æ•ˆã€‚\nS. Chen, S. Wong, L. Chen, and Y. Tian. Extending context window of large language models via positional interpolation. arXiv preprint arXiv:2306.15595, 2023.\nB. Peng, J. Quesnelle, H. Fan, and E. Shippole. Yarn: Efficient context window extension of large language models. arXiv preprint arXiv:2309.00071, 2023b.\nO. Press, N. A. Smith, and M. Lewis. Train short, test long: Attention with linear biases enables input length extrapolation. arXiv preprint arXiv:2108.12409, 2021.\nY. Sun, L. Dong, B. Patra, S. Ma, S. Huang, A. Benhaim, V. Chaudhary, X. Song, and F. Wei. A length-extrapolatable transformer. In Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pages 14590â€“14604, 2023.\næœ€è¿‘åœ¨é«˜æ•ˆæ³¨æ„åŠ›æœºåˆ¶æ–¹é¢çš„è¿›å±•ï¼Œä½¿å¾—LLMsèƒ½å¤Ÿè®­ç»ƒå’Œæ¨ç†åŒ…å«æ•°ç™¾ä¸‡ä¸ªæ ‡è®°çš„è¾“å…¥åºåˆ—ã€‚\nT. Dao, D. Fu, S. Ermon, A. Rudra, and C. RÃ©. Flashattention: Fast and memory-efficient exact attention with IO-awareness. Advances in Neural Information Processing Systems, 35:16344â€“16359, 2022\nS. A. Jacobs, M. Tanaka, C. Zhang, M. Zhang, L. Song, S. Rajbhandari, and Y. He. DeepSpeed Ulysses:System optimizations for enabling training of extreme long sequence transformer models. arXiv preprint arXiv:2309.14509, 2023.\nH. Liu, M. Zaharia, and P. Abbeel. Ring attention with blockwise transformers for near-infinite context. arXiv preprint arXiv:2310.01889, 2023.\nJ. Achiam, S. Adler, S. Agarwal, L. Ahmad, I. Akkaya, F. L. Aleman, D. Almeida, J. Altenschmidt, S. Altman, S. Anadkat, et al. GPT-4 technical report. arXiv preprint arXiv:2303.08774, 2023.\nM. Reid, N. Savinov, D. Teplyashin, D. Lepikhin, T. Lillicrap, J.-b. Alayrac, R. Soricut, A. Lazaridou, O. Firat, J. Schrittwieser, et al. Gemini 1.5: Unlocking multimodal understanding across millions of tokens of context. arXiv preprint arXiv:2403.05530, 2024.\nG. Team, R. Anil, S. Borgeaud, Y. Wu, J.-B. Alayrac, J. Yu, R. Soricut, J. Schalkwyk, A. M. Dai, A. Hauth, et al. Gemini: a family of highly capable multimodal models. arXiv preprint arXiv:2312.11805, 2023.\n2.2ä¸Šä¸‹æ–‡å­¦ä¹  ä¸Šä¸‹æ–‡å­¦ä¹ ï¼ˆICLï¼‰æä¾›äº†ä¸€ç§è®¡ç®—æ•ˆç‡é«˜çš„æ–¹æ³•ï¼Œé€šè¿‡ä¾èµ–å°‘é‡ä»»åŠ¡ç¤ºä¾‹æ¥æé«˜æ¨¡å‹åœ¨æ¨ç†æ—¶çš„è¡¨ç°ã€‚\nä¸ºäº†è¿›ä¸€æ­¥æå‡ICLæ€§èƒ½ï¼Œç°æœ‰ç ”ç©¶é›†ä¸­åœ¨é¢„è®­ç»ƒç­–ç•¥ä¸Šï¼Œä¼˜åŒ–è¯­è¨€æ¨¡å‹ä»¥å®ç°ä¸Šä¸‹æ–‡å­¦ä¹ ã€‚\næ­¤å¤–ï¼Œé€‰æ‹©æ€§ä½¿ç”¨å°‘é‡ç¤ºä¾‹ä¹Ÿè¢«è¯æ˜æœ‰åŠ©äºæé«˜ä¸‹æ¸¸ä»»åŠ¡çš„è¡¨ç°ã€‚\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé‡æ–°æ ¼å¼åŒ–æˆ–æ‰¾åˆ°æœ€ä½³é¡ºåºçš„åœºæ™¯ç¤ºä¾‹ä¹Ÿèƒ½æé«˜ICLçš„æœ‰æ•ˆæ€§ã€‚\néšç€é•¿æƒ…å¢ƒè¯­è¨€æ¨¡å‹çš„å‡ºç°ï¼Œåœ¨ICLä¸­æ‰©å±•ç¤ºä¾‹æ•°é‡æˆä¸ºå¯èƒ½ã€‚\nä¾‹å¦‚ï¼ŒAgarwalç­‰äººè¡¨æ˜ï¼Œå¤šæ ·æœ¬ICLå¯ä»¥å‡è½»LLMä¸­çš„é¢„è®­ç»ƒåå·®ï¼Œä»è€Œæé«˜å„ç§ä»»åŠ¡çš„ICLæ€§èƒ½ã€‚\n2.3RAG RAGé€šè¿‡å¼•å…¥å¤–éƒ¨çŸ¥è¯†æ¥æé«˜è¯­è¨€æ¨¡å‹çš„è¡¨ç°ã€‚\nå’ŒnaiveRAGç›¸æ¯”ï¼Œä¼˜åŒ–æ£€ç´¢é˜¶æ®µå¯ä»¥æœ‰æ•ˆæå‡ä¸Šä¸‹æ–‡ç›¸å…³æ€§ï¼Œæé«˜ç”Ÿæˆè´¨é‡ã€‚\nREPLUGä½¿ç”¨è¯­è¨€æ¨¡å‹ä½œä¸ºç›‘ç£æ¥å­¦ä¹ ä¸€ä¸ªå¯†é›†æ£€ç´¢å™¨æ¨¡å‹ã€‚\næ­¤å¤–ï¼Œç¼–ç æ–‡æ¡£å¯ä»¥å¢åŠ çŸ¥è¯†æ£€ç´¢å¹¶æé«˜ç”Ÿæˆèƒ½åŠ›ã€‚\nIzacardå’ŒGraveï¼ˆ2021ï¼‰åˆ©ç”¨èåˆè§£ç å™¨æ¶æ„æ¥ç¼–ç å¤šä¸ªé—®é¢˜-æ®µè½å¯¹ï¼ŒåŒæ—¶ä¿æŒæ¨¡å‹æ•ˆç‡ã€‚\næˆ–è€…ï¼Œæœ‰é€‰æ‹©åœ°åˆ©ç”¨æ–‡æ¡£ä¸­çš„çŸ¥è¯†å¯ä»¥æé«˜è¯­è¨€æ¨¡å‹å¯¹æ— å…³ä¸Šä¸‹æ–‡çš„é²æ£’æ€§ã€‚ä¾‹å¦‚ï¼ŒRAFTæå‡ºä½¿ç”¨è´Ÿæ–‡æ¡£è®­ç»ƒè¯­è¨€æ¨¡å‹ä»¥æé«˜ç”Ÿæˆè´¨é‡å’Œç›¸å…³æ€§ï¼ˆZhangç­‰äººï¼Œ2024ï¼‰ã€‚ä¸æˆ‘ä»¬çš„å·¥ä½œåŒæ—¶ï¼Œæå‡ºäº†é•¿æ–‡æ¡£æ£€ç´¢å’Œæ•°æ®é›†æ‰©å±•ä»¥ä¼˜åŒ–RAGæ€§èƒ½ï¼ˆJiangç­‰äººï¼Œ2024ï¼›Shaoç­‰äººï¼Œ2024ï¼‰ã€‚\n3.åŸºäºRAGçš„æ¨ç†æ‰©å±•ç­–ç•¥ æˆ‘ä»¬ä½¿ç”¨æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦æ¥æµ‹é‡æ¨ç†è®¡ç®—ï¼Œæœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦å®šä¹‰ä¸º LLM è¾“å‡ºæœ€ç»ˆç­”æ¡ˆä¹‹å‰ï¼Œæ‰€æœ‰è¿­ä»£çš„è¾“å…¥tokenæ€»æ•°ã€‚æ¯æ¬¡çš„è¾“å…¥å—åˆ°LLMä¸Šä¸‹æ–‡çª—å£çš„é™åˆ¶ã€‚å¿½ç•¥è¾“å‡ºçš„tokenå’Œæ£€ç´¢çš„å¼€é”€ã€‚\n3.1DRAG DRAGåŸºäºNaiveRAGæ„å»ºï¼Œå°†æ£€ç´¢åˆ°çš„topkæ–‡æ¡£å’Œä¸Šä¸‹æ–‡ç¤ºä¾‹é›†æˆåˆ°è¾“å…¥ä¸­ã€‚é¢ å€’æ–‡æ¡£é¡ºåºï¼Œå°†æ’åè¾ƒé«˜çš„æ–‡æ¡£æ”¾åœ¨ç¦»æŸ¥è¯¢è¿‘çš„ä½ç½®ã€‚\n3.2IterDRAG å°†æŸ¥è¯¢åˆ†è§£ä¸ºæ›´ç®€å•çš„å­æŸ¥è¯¢ï¼Œæ¯ä¸ªå­æŸ¥è¯¢æ‰§è¡Œæ£€ç´¢å¹¶ç”Ÿæˆä¸­é—´ç­”æ¡ˆã€‚è§£å†³å®Œæ‰€æœ‰å­æŸ¥è¯¢åï¼Œå°†æ‰€æœ‰ä¸Šä¸‹æ–‡ã€å­æŸ¥è¯¢ã€ä¸­é—´ç­”æ¡ˆç»„åˆåœ¨ä¸€èµ·ï¼Œç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚\nç”±äºç°æœ‰çš„æ•°æ®é›†ä¸å¸¦æœ‰å­æŸ¥è¯¢å’Œä¸­é—´ç­”æ¡ˆï¼Œæ‰€ä»¥è®©å¤§æ¨¡å‹ä½¿ç”¨çº¦æŸè§£ç ï¼ˆconstrained decodingï¼‰å¹¶éµå¾ªself-askæ ¼å¼ç”Ÿæˆexampleã€‚\nç”Ÿæˆexampleçš„æ­¥éª¤ï¼š\nåœ¨æ¯ä¸€è½®ä¸­ï¼Œç”Ÿæˆå­æŸ¥è¯¢ï¼Œç„¶åå°†æŸ¥è¯¢åˆ°çš„æ–‡æ¡£äº¤é”™æ”¾å…¥promptï¼Œå†ç”Ÿæˆä¸­é—´ç­”æ¡ˆã€‚\næœ€ç»ˆç­”æ¡ˆç”Ÿæˆã€‚æˆ–è€…è¾¾åˆ°æœ€å¤§è½®æ•°åï¼Œå¼ºåˆ¶ç”Ÿæˆæœ€ç»ˆç­”æ¡ˆã€‚\næ–‡æ¡£ã€å­æŸ¥è¯¢-ä¸­é—´ç­”æ¡ˆã€æœ€ç»ˆç­”æ¡ˆä¸€èµ·æ„æˆexampleã€‚\næ¨ç†è¿‡ç¨‹ä¸­ï¼Œä¸Šä¸‹æ–‡ç¤ºä¾‹æ·»åŠ åˆ°åˆå§‹æ–‡æ¡£ä¹‹å‰ã€‚\nIterRAGè¿˜å°†å­¦ä¹ ï¼š1.å°†é—®é¢˜åˆ†è§£ä¸ºç®€å•å¯æ§çš„å­é—®é¢˜ 2.æå–å­é—®é¢˜çš„ç›¸å…³ä¿¡æ¯\nè¿™ä¸€æ–¹æ³•æœ‰åŠ©äºæé«˜RAGå›ç­”å¤æ‚é—®é¢˜çš„èƒ½åŠ›ã€‚\nå…·ä½“æ“ä½œè§é™„å½•Hã€‚\n4.RAGæ€§èƒ½å’Œæ¨ç†è®¡ç®—è§„æ¨¡ 4.1ç»™å®šé¢„ç®—ï¼ˆæœ€å¤§æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦ï¼‰ä¸‹çš„æœ€ä½³æ€§èƒ½ é™åˆ¶æœ€å¤§è¾“å…¥tokenå³$L_{max}$æ—¶ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´æ¨ç†å‚æ•° $\\theta$ æ¥ä¼˜åŒ–è®¡ç®—èµ„æºçš„ä½¿ç”¨ã€‚\nåœ¨ DRAG ä¸­ï¼Œå¯ä»¥è°ƒæ•´ æ£€ç´¢æ–‡æ¡£æ•°é‡ ( k ) å’Œ ä¸Šä¸‹æ–‡ç¤ºä¾‹æ•°é‡ ( m )ï¼› åœ¨ IterDRAG ä¸­ï¼Œé¢å¤–å¼•å…¥äº† æ£€ç´¢ä¸ç”Ÿæˆçš„è¿­ä»£æ¬¡æ•° ( n )ã€‚ å¯¹äºæ¯ä¸ªè¾“å…¥æŸ¥è¯¢åŠå…¶çœŸå®ç­”æ¡ˆ $ (x_i, y_i) \\in \\mathcal{X} $ï¼Œæˆ‘ä»¬å¯ä»¥åº”ç”¨å‚æ•°ä¸º $ \\theta $ çš„ RAG æ¨ç†ç­–ç•¥ $ f $ï¼Œå¾—åˆ°é¢„æµ‹ç»“æœ $ \\hat{y}_i = f(x_i; \\theta) $ï¼Œå¹¶è®¡ç®—è¯„ä¼°æŒ‡æ ‡ $ P(y_i, \\hat{y}_i) $ã€‚\nä¸ºäº†ç ”ç©¶ RAG æ€§èƒ½ä¸æ¨ç†è®¡ç®—é‡ä¹‹é—´çš„å…³ç³»ï¼Œæˆ‘ä»¬åœ¨ä¸åŒçš„è®¡ç®—é¢„ç®— $ L_{\\text{max}} $ ä¸‹é‡‡æ ·ï¼Œå¹¶é€šè¿‡æšä¸¾ä¸åŒçš„ $ \\theta \\in \\Theta $ æ¥å¯»æ‰¾è¯¥é¢„ç®—ä¸‹çš„æœ€ä¼˜å¹³å‡æ€§èƒ½ $ P^*(L_{\\text{max}}) $ï¼š\n$P^*(L_{\\text{max}}) := \\max_{\\theta \\in \\Theta} \\left\\{ \\frac{1}{|\\mathcal{X}|} \\sum_i P(y_i, f(x_i; \\theta)) \\ \\Bigg| \\ \\forall i, l(x_i; \\theta) \\leq L_{\\text{max}} \\right\\}. \\quad$\n$ \\mathcal{X} $ï¼šæµ‹è¯•é›†ï¼ŒåŒ…å«è¾“å…¥æŸ¥è¯¢ $ x_i $ å’ŒçœŸå®ç­”æ¡ˆ $ y_i $ çš„é…å¯¹ $ (x_i, y_i) $ã€‚ $ \\theta $ï¼šRAG æ¨ç†å‚æ•°ï¼ŒåŒ…æ‹¬ï¼š $ k $ï¼šæ£€ç´¢çš„æ–‡æ¡£æ•°é‡ï¼Œ $ m $ï¼šä¸Šä¸‹æ–‡ç¤ºä¾‹ï¼ˆin-context examplesï¼‰æ•°é‡ï¼Œ $ n $ï¼šç”Ÿæˆè¿­ä»£æ¬¡æ•°ï¼ˆDRAG ä¸­ $ n=1 $ï¼ŒIterDRAG ä¸­ $ n \\geq 1 $ï¼‰ã€‚ $ f(x_i; \\theta) $ï¼šä½¿ç”¨å‚æ•° $ \\theta$ çš„ RAG ç­–ç•¥å¯¹æŸ¥è¯¢ $ x_i $ çš„é¢„æµ‹ç»“æœ $ \\hat{y}_i $ã€‚ $ P(y_i, \\hat{y}_i) $ï¼šè¯„ä¼°æŒ‡æ ‡ï¼ˆå¦‚å‡†ç¡®ç‡ã€F1 åˆ†æ•°ç­‰ï¼‰ï¼Œè¡¡é‡é¢„æµ‹ç­”æ¡ˆ $ \\hat{y}_i $ ä¸çœŸå®ç­”æ¡ˆ $ y_i $ çš„åŒ¹é…ç¨‹åº¦ã€‚ $ l(x_i; \\theta) $ï¼šå¯¹æŸ¥è¯¢ $ x_i $ ä½¿ç”¨å‚æ•° $ \\theta $ æ—¶çš„å®é™…ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆå³æ‰€æœ‰è¾“å…¥ tokens çš„æ€»å’Œï¼‰ã€‚ $ L_{\\text{max}} $ï¼šé¢„ç®—çº¦æŸï¼Œå³å…è®¸çš„æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ã€‚ åœ¨æ‰€æœ‰æ»¡è¶³çº¦æŸçš„ $ \\theta $ ä¸­ï¼Œé€‰æ‹©ä½¿å¹³å‡æ€§èƒ½ $ \\frac{1}{|\\mathcal{X}|} \\sum_i P(\\cdot) $ æœ€å¤§çš„å‚æ•°ç»„åˆã€‚\nå®éªŒï¼š\nè¯„ä¼°Genmini 1.5 Flashï¼ˆä¸Šä¸‹æ–‡çª—å£æœ€é«˜1Mï¼‰åœ¨çŸ¥è¯†å¯†é›†å‹é—®ç­”æ•°æ®é›†ï¼ˆBamboogleã€HotpotQAã€MuSiQue å’Œ 2WikiMultiHopQAï¼‰ä¸Šçš„æ€§èƒ½ã€‚\nè¯„ä¼°æŒ‡æ ‡ä¸ºexact matchï¼ˆEMï¼‰ã€F1ã€Acc\n$L_{max} \\in \\{16k, 32k, 128k, 1M, 5M \\} $tokens\nå¯¹äºDRAGï¼Œæ£€ç´¢æ–‡æ¡£æ•°é‡ $k \\in \\{0,1,2,5,10,20,50,100,200,500,1000\\}$ï¼Œç¤ºä¾‹æ•°é‡ $m \\in \\{0,2^0,2^1,...,2^8\\}$\nå¯¹äºIterRAGï¼Œ$n \\in \\{1,2,3,4,5\\}$\næ¨¡å‹ï¼š\nzero-shot QAï¼ˆZS QAï¼‰çº¯ä½¿ç”¨LLMè‡ªèº«çŸ¥è¯† many-shots QAï¼ˆMS QAï¼‰åªåŠ å…¥mä¸ªç¤ºä¾‹ RAG åªä½¿ç”¨kä¸ªæ–‡æ¡£ DRAG IterRAG 4.2æ€»ä½“æ€§èƒ½ ç»“è®ºï¼šåœ¨ä»»æ„ä¸Šä¸‹æ–‡é•¿åº¦ã€ä»»æ„æ•°æ®é›†ä¸­ï¼Œéƒ½æ˜¯DRAGã€IterRAGæ•ˆæœè¾ƒå¥½ï¼›è¾¾ä¸åˆ°æŒ‡å®šçš„ä¸Šä¸‹æ–‡é•¿åº¦æ—¶ä¼šè¢«çœç•¥ã€‚è€Œä¸”æœ€å¥½çš„På€¼éšä¸Šä¸‹æ–‡é•¿åº¦çº¿æ€§å˜åŒ–ã€‚\nDRAGã€IterdDRAGçš„æ€§èƒ½éšä¸Šä¸‹æ–‡é•¿åº¦çš„æ‰©å±•è€Œä¸æ–­æé«˜ï¼Œè€Œå…¶ä½™æ–¹æ³•å¾ˆå¿«è¾¾åˆ°å³°å€¼ã€‚DRAG åœ¨è¾ƒçŸ­çš„æœ€å¤§é•¿åº¦ä¸‹è¡¨ç°å‡ºè‰²ï¼Œè€Œ IterDRAG åœ¨æ›´é•¿çš„æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦ä¸‹æ›´æœ‰æ•ˆã€‚\n4.3RAGæ¨ç†ç¼©æ”¾å®šå¾‹ éšç€æœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦çš„æ‰©å¤§ï¼Œæœ€ä½³æ€§èƒ½è¡¨ç°å‡ºçº¿æ€§å¢é•¿ã€‚æ‰€ä»¥å¯ä»¥é€šè¿‡å¢åŠ è®¡ç®—æ¥æé«˜ RAG æ€§èƒ½ï¼Œä»è€Œåœ¨ç»™å®šå¯ç”¨è®¡ç®—èµ„æºçš„æƒ…å†µä¸‹æ›´å‡†ç¡®åœ°é¢„æµ‹æ€§èƒ½ã€‚ å¯¹äº $L_{max}$ é«˜äº $10^5$â€‹ï¼ŒIterDRAG ç»§ç»­é€šè¿‡äº¤é”™æ£€ç´¢å’Œè¿­ä»£ç”Ÿæˆè¿›è¡Œæœ‰æ•ˆæ‰©å±•ã€‚è¯´æ˜å…¶æ›´é€‚åˆé•¿ä¸Šä¸‹æ–‡æ¨ç†ã€‚ ä¸Šä¸‹æ–‡è¶…è¿‡1Måï¼Œæ€§èƒ½æå‡ä¸æ˜æ˜¾ã€‚ 4.4å¯¹äºç‰¹å®šå‚æ•°çš„ç¼©æ”¾ æ–‡æ¡£å’Œç¤ºä¾‹å¹¶éèµ·åˆ°åŒæ ·ä½œç”¨ã€‚å¯¹äºå›ºå®šé…ç½®ï¼Œå¢åŠ æ£€ç´¢åˆ°çš„æ–‡æ¡£æ•°é‡é€šå¸¸ä¼šå¸¦æ¥æ›´å¥½çš„æ€§èƒ½æå‡ã€‚ä½†kå’Œmä¹Ÿæ˜¯æœ‰é˜ˆå€¼çš„ã€‚ å¢åŠ ç¤ºä¾‹å¯¹IterRAGæ›´æœ‰å¸®åŠ©ï¼Œå¦‚ç¤ºä¾‹ä»0-1æ—¶ï¼ŒIterRAGçš„æ€§èƒ½æ˜æ˜¾æå‡ï¼›è€Œç¤ºä¾‹å¯¹DRAGä¸æ˜æ˜¾ã€‚ 5.é•¿ä¸Šä¸‹æ–‡ RAG çš„æ¨ç†è®¡ç®—åˆ†é… æ„å»ºè®¡ç®—åˆ†é…æ¨¡å‹ï¼Œç›®çš„æ˜¯ä¸ºäº†èƒ½æ ¹æ® $L_{max}$ æ±‚ $\\theta$ã€‚\næ€§èƒ½æŒ‡æ ‡ï¼ˆğ‘ƒï¼‰\nè¡¨ç¤ºåœ¨æ•°æ®é›† $ X $ ä¸Šçš„è¡¨ç°ï¼ˆå¦‚å‡†ç¡®ç‡ï¼‰ï¼Œå»ºæ¨¡ä¸ºå‚æ•° $ \\theta $ çš„å‡½æ•°ã€‚ èµ„æºå‚æ•°ï¼ˆğœƒï¼‰\nå®šä¹‰ä¸ºä¸‰ç»´å‘é‡ $ \\theta := (k, m, n)^T $ï¼ŒåŒ…å«ï¼š ( k )ï¼šä½¿ç”¨çš„æ–‡æ¡£æ•°é‡ ( m )ï¼šä¸Šä¸‹æ–‡ç¤ºä¾‹ï¼ˆdemonstrations/shotsï¼‰çš„æ•°é‡ ( n )ï¼šæœ€å¤§è¿­ä»£/ç”Ÿæˆæ­¥æ•° ä¿¡æ¯é‡å‚æ•°ï¼ˆğ‘–ï¼‰\nè¡¡é‡è¾“å…¥å†…å®¹çš„ä¿¡æ¯ä»·å€¼ï¼Œå®šä¹‰ä¸º $ i := (i_{\\text{doc}}, i_{\\text{shot}}, 0)^T $ï¼š $ i_{\\text{doc}} $ï¼šæ–‡æ¡£çš„ä¿¡æ¯é‡ é€šè¿‡â€œæ·»åŠ 1ç¯‡æ–‡æ¡£ vs é›¶æ ·æœ¬ï¼ˆzero-shotï¼‰çš„æ€§èƒ½å·®å¼‚â€è®¡ç®—ã€‚ $ i_{\\text{shot}} $ï¼šç¤ºä¾‹çš„ä¿¡æ¯é‡ é€šè¿‡â€œæ·»åŠ 1ä¸ªç¤ºä¾‹ vs é›¶æ ·æœ¬çš„æ€§èƒ½å·®å¼‚â€è®¡ç®—ã€‚ $ i_{\\text{iter}} $ è¢«å¿½ç•¥ï¼ˆè®¾ä¸º0ï¼‰ï¼Œå› å®éªŒä¸­å‘ç°å¢åŠ ç”Ÿæˆæ­¥æ•°å¯¹æ€§èƒ½æ— æ˜¾è‘—æå‡ã€‚ æ€§èƒ½æ¨¡å‹å…¬å¼\n$P(\\theta) \\approx \\sigma((a + b \\odot i)^T \\log(\\theta) + c)$\nç¬¦å·è¯´æ˜ï¼š $ \\odot $ï¼šé€å…ƒç´ ç›¸ä¹˜ï¼ˆHadamardç§¯ï¼‰ã€‚ $ a, b \\in \\mathbb{R}^3 $ï¼šå¾…ä¼°è®¡å‚æ•°ï¼Œåˆ†åˆ«è¡¨ç¤ºèµ„æºçš„åŸºç¡€æ•ˆåº”å’Œä¸ä¿¡æ¯é‡çš„äº¤äº’æ•ˆåº”ã€‚ $ c $ï¼šå¸¸æ•°åç½®é¡¹ã€‚ aã€bã€céƒ½æ˜¯åœ¨ç‰¹å®šæƒ…å†µä¸‹æ‹Ÿåˆçš„ã€‚ $ \\log(\\theta) $ï¼šå¯¹èµ„æºå‘é‡é€å…ƒç´ å–å¯¹æ•°ã€‚ $ \\sigma $ï¼šSigmoidå‡½æ•°ã€‚ $L_{max}$ ç›¸å½“äº $\\theta$ çš„é™åˆ¶æ¡ä»¶ï¼›æ‹Ÿåˆå‡ºabcï¼›ç›®æ ‡æ˜¯æœ€å¤§åŒ– $P(\\theta)$ ï¼Œå°±å¯ä»¥å¾—åˆ°æœ€å¥½çš„ $\\theta$ã€‚\n","permalink":"https://Rook1eChan.github.io/posts/inference-scaling-for-long-context-retrieval-augmented-generation/","summary":"\u003cp\u003eICLR2025ï¼Œæ¥è‡ªGoogle DeepMindå›¢é˜Ÿçš„å·¥ä½œ\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://arxiv.org/abs/2410.04343v2\"\u003ehttps://arxiv.org/abs/2410.04343v2\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"0ç›®æ ‡\"\u003e0.ç›®æ ‡\u003c/h2\u003e\n\u003cp\u003eå…ˆå‰å¯¹äºRAGæ¨ç†æ‰©å±•çš„ç ”ç©¶ä¸»è¦é›†ä¸­äºæä¾›æ›´å¤šçš„çŸ¥è¯†ï¼Œä½†åªå¢åŠ çŸ¥è¯†çš„æ•°é‡æ˜¯ä¸å¤Ÿçš„ã€‚å½“å‰çš„LLMåœ¨å¤„ç†é•¿ä¸Šä¸‹æ–‡æ—¶ä»å­˜åœ¨æŒ‘æˆ˜ã€‚æ¯”å¦‚ï¼Œåœ¨è¶…é•¿åºåˆ—ä¸­å®šä½æœ‰æ•ˆä¿¡æ¯çš„èƒ½åŠ›æœ‰é™ã€æœ€ä½³æ€§èƒ½å¾€å¾€æ˜¯åœ¨æ²¡æœ‰å……åˆ†åˆ©ç”¨ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹å®ç°çš„ã€è¶…è¿‡ä¸€å®šé˜ˆå€¼ï¼ˆæ–‡æ¡£æ•°é‡ï¼‰çš„æ£€ç´¢ä¼šä½¿æ€§èƒ½åœæ»ç”šè‡³ä¸‹é™ã€‚\u003c/p\u003e\n\u003cp\u003eç›®æ ‡æ˜¯æ‰¾åˆ°ä¸Šä¸‹æ–‡é•¿åº¦ä¸æœ€ä¼˜é…ç½®ä¹‹é—´çš„å…³ç³»ï¼Œèƒ½å¤Ÿé¢„æµ‹æœ€ä½³æ¨ç†å‚æ•°ï¼Œæœ€å¤§é™åº¦æé«˜RAGæ€§èƒ½ã€‚å…¶ä¸­DRAGçš„å‚æ•°ä¸ºæ£€ç´¢åˆ°çš„æ–‡æ¡£æ•°é‡å’Œç¤ºä¾‹æ•°é‡ã€‚IterDRAGçš„å‚æ•°ä¸ºç”Ÿæˆæ¬¡æ•°ã€‚\u003c/p\u003e\n\u003ch2 id=\"1è´¡çŒ®\"\u003e1.è´¡çŒ®\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eæå‡ºä¸¤ç§RAGæ–¹æ³•ï¼šDRAGï¼ˆåŸºäºæ¼”ç¤ºçš„RAGï¼Œä¸ºLLMæä¾›å¤šä¸ªRAGç¤ºä¾‹ï¼‰å’ŒIterDRAGï¼ˆåŸºäºè¿­ä»£æ¼”ç¤ºçš„RAGï¼Œå°†è¾“å…¥æŸ¥è¯¢åˆ†è§£ä¸ºæ›´ç®€å•çš„å­æŸ¥è¯¢ï¼Œè¿­ä»£æ£€ç´¢ï¼‰ã€‚å¹¶è¯æ˜äº†è¿™ä¸¤ç§æ–¹æ³•ä¼˜äºä»…æä¾›çŸ¥è¯†çš„RAGã€‚\u003c/li\u003e\n\u003cli\u003eå¾—åˆ°äº†RAGçš„æ¨ç†ç¼©æ”¾å®šå¾‹ï¼šåœ¨æœ€ä½³é…ç½®ä¸‹ï¼ŒRAGæ€§èƒ½éšæœ‰æ•ˆä¸Šä¸‹æ–‡é•¿åº¦çº¿æ€§å˜åŒ–ã€‚\u003c/li\u003e\n\u003cli\u003eæ ¹æ®å®šå¾‹å¯¹RAGæ€§èƒ½ä¸ä¸åŒæ¨ç†å‚æ•°å»ºæ¨¡ï¼Œæ¨å¯¼å‡ºè®¡ç®—åˆ†é…æ¨¡å‹ï¼Œä¸ºé•¿ä¸Šä¸‹æ–‡RAGçš„ä¼˜åŒ–æä¾›äº†æŒ‡å¯¼ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2ç›¸å…³å·¥ä½œ\"\u003e2.ç›¸å…³å·¥ä½œ\u003c/h2\u003e\n\u003ch3 id=\"21é•¿ä¸Šä¸‹æ–‡llms\"\u003e2.1é•¿ä¸Šä¸‹æ–‡LLMs\u003c/h3\u003e\n\u003cp\u003eæ—©æœŸé‡‡ç”¨ç¨€ç–/ä½ç§©æ ¸æ¥å‡å°‘å†…å­˜éœ€æ±‚ã€‚\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eI. Beltagy, M. E. Peters, and A. Cohan. Longformer: The long-document transformer. \u003cem\u003earXiv preprint\u003c/em\u003e \u003cem\u003earXiv:2004.05150\u003c/em\u003e, 2020.\u003c/p\u003e\n\u003cp\u003eK. Choromanski, V. Likhosherstov, D. Dohan, X. Song, A. Gane, T. Sarlos, P. Hawkins, J. Davis, A. Mohiuddin, L. Kaiser, et al. Rethinking attention with performers. \u003cem\u003earXiv preprint arXiv:2009.14794\u003c/em\u003e,2020.\u003c/p\u003e\n\u003cp\u003eN. Kitaev, L. Kaiser, and A. Levskaya. Reformer: The efficient transformer. In \u003cem\u003eInternational Conference\u003c/em\u003e \u003cem\u003eon Learning Representations\u003c/em\u003e, 2019.\u003c/p\u003e","title":"Inference Scaling for Long-Context Retrieval Augmented Generation"},{"content":"1.Motivation å°½ç®¡æœ‰äº†RAGçš„å¸®åŠ©ï¼ŒLLMä»æœ‰å¯èƒ½ç»™å‡ºä¸æ‰€æä¾›çŸ¥è¯†ä¸ç¬¦çš„å›ç­”ã€‚å› æ­¤éœ€è¦æ„å»ºä¸€ä¸ªæ•°æ®é›†æ¥æ£€æµ‹å¹»è§‰ã€‚\n2.Contributions æå‡ºRAGTruthï¼Œä¸€ä¸ªå¤§è§„æ¨¡è¯çº§åˆ«çš„å¹»è§‰æ£€æµ‹æ•°æ®é›†ï¼Œç”±LLMè‡ªç„¶äº§ç”Ÿï¼ˆä½œè€…è®¤ä¸ºæ•…æ„è§¦å‘çš„å¹»è§‰ä¸è‡ªç„¶äº§ç”Ÿçš„å¹»è§‰å­˜åœ¨å·®å¼‚ï¼‰ å¯¹ç°æœ‰å¹»è§‰æ£€æµ‹æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ æå‡ºäº†å¾®è°ƒLLMç”¨äºå¹»è§‰æ£€æµ‹çš„åŸºçº¿ã€‚Llama-2-13Båœ¨RAGTruth training dataä¸Šå¾®è°ƒåæ¯”å¾—ä¸ŠGPT4 è¯æ˜äº†ä½¿ç”¨å¾®è°ƒå¾—åˆ°çš„å¹»è§‰æ£€æµ‹å™¨ï¼Œèƒ½é™ä½å¹»è§‰ 3.Related Work 4.Methods 1.Hallucination Taxonomyå¹»è§‰ç±»å‹ æœ¬æ–‡å°†å¹»è§‰ç±»å‹åˆ†ä¸ºï¼š\nEvident Conflictæ˜æ˜¾å†²çªï¼šä¸æä¾›çš„æ–‡æœ¬æ˜æ˜¾ç›¸åï¼Œå®¹æ˜“è¾¨åˆ«ï¼Œå¦‚äº‹å®é”™è¯¯ã€æ‹¼å†™é”™è¯¯ã€æ•°å­—é”™è¯¯ã€‚ Subtle Conflictè½»å¾®å†²çªï¼šç”Ÿæˆçš„ä¿¡æ¯ä¸æä¾›çš„æ–‡æœ¬æœ‰æ­§ä¹‰ï¼Œæ¯”å¦‚æœ¯è¯­çš„æ›¿æ¢ï¼Œéœ€è¦ç»“åˆä¸Šä¸‹æ–‡åˆ¤æ–­ã€‚ Evident Introduction of Baseless Informationæ˜æ˜¾å¼•å…¥æ— æ ¹æ®çŸ¥è¯†ï¼šç”Ÿæˆçš„å†…å®¹ä¸åœ¨æä¾›çš„ä¿¡æ¯ä¹‹å†…ã€‚ Subtle Introduction of Baseless Informationè½»å¾®å¼•å…¥æ— æ ¹æ®çŸ¥è¯†ï¼šç”Ÿæˆå†…å®¹è¶…å‡ºäº†æä¾›çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸»è§‚çš„å‡è®¾æˆ–æ¨æ–­ã€‚ 2.Response Generationå›ç­”ç”Ÿæˆ é€‰æ‹©ä¸‰ä¸ªä»»åŠ¡: Question Answering,Data-to-text Writing, and News Summarization.ï¼ˆé—®é¢˜å›ç­”ã€æ•°æ®åˆ°æ–‡æœ¬çš„å†™ä½œã€æ–°é—»æ‘˜è¦ï¼‰ï¼Œç”Ÿæˆå›ç­”å¹¶äººå·¥æ ‡æ³¨å¹»è§‰éƒ¨åˆ†ã€‚\nQuestion Answeringï¼šä»MS MARCOé€‰æ‹©ä¸ç”Ÿæ´»ç›¸å…³çš„QAï¼Œæ¯ä¸ªé—®é¢˜ä¿ç•™ä¸‰æ®µæå–å†…å®¹ï¼Œç„¶åä½¿ç”¨LLMæ ¹æ®å†…å®¹å›ç­”é—®é¢˜ã€‚ Data-to-text Writingï¼šä»Yelpæ•°æ®é›†é€‰æ‹©æœ‰å…³å•†å®¶çš„ç»“æ„åŒ–ä¿¡æ¯å’Œç”¨æˆ·çš„è¯„è®ºï¼Œç”¨LLMç”Ÿæˆå¯¹å•†å®¶çš„æè¿°ã€‚å¦‚æœæ•°æ®å‡ºç°ç©ºå€¼è€Œå¤§æ¨¡å‹å°†å…¶è§£é‡Šä¸ºâ€œå‡â€ï¼Œè®¤ä¸ºè¿™æ˜¯å‡ºç°äº†å¹»è§‰ã€‚ News Summarizationï¼šæ•°æ®æ¥è‡ªCNN/Daily Mail dataset+æŸæ–°é—»å¹³å°çš„æ–°é—»ï¼Œä½¿ç”¨LLMå¯¹æ¯ç¯‡å†…å®¹ç”Ÿæˆæ‘˜è¦ã€‚ ä½¿ç”¨çš„LLMï¼šGPT-3.5-turbo-0613ã€GPT-4-0613ã€Mistral-7b-Instructã€Llama-2-7B-chatã€ Llama-2-13B-chatã€ Llama-2-70B-chat\næ¯ä¸ªä»»åŠ¡éƒ½ç”¨6ä¸ªæ¨¡å‹è·‘ä¸€éï¼Œå¾—åˆ°6ä¸ªå›ç­”ã€‚\n5.Result å„é¡¹ä»»åŠ¡ä¸­å¹»è§‰ç±»å‹çš„æ¯”ä¾‹ï¼š\nå¦‚å›¾2æ‰€ç¤ºï¼Œåœ¨ä¸Šä¸‹æ–‡ä¸­æ— æ ¹æ®çš„ä¿¡æ¯ç”Ÿæˆæ˜¾è‘—å¤šäºä¸ä¸Šä¸‹æ–‡å†²çªçš„ä¿¡æ¯ç”Ÿæˆï¼Œå°¤å…¶æ˜¯åœ¨é—®ç­”ä»»åŠ¡ä¸­ã€‚åœ¨ä¸¤å¤§ç±»æ— æ ¹æ®ä¿¡æ¯å’Œå†²çªä¿¡æ¯ä¸­ï¼Œæ›´ä¸¥é‡çš„å¹»è§‰ï¼Œå³æ˜æ˜¾çš„æ— æ ¹æ®ä¿¡æ¯å’Œæ˜æ˜¾çš„å†²çªä¿¡æ¯ï¼Œå æ®äº†ç›¸å½“å¤§çš„æ¯”ä¾‹ã€‚è¿™ä¸€è§‚å¯Ÿç»“æœè¯´æ˜å³ä½¿æœ‰RAGï¼Œè¿˜æ˜¯å­˜åœ¨ä¸¥é‡å¹»è§‰ã€‚\næ•°æ®è½¬æ–‡æœ¬çš„ä»»åŠ¡å¹»è§‰ç‡æœ€é«˜ï¼Œå¯èƒ½ä¸JSONæ ¼å¼æœ‰å…³ã€‚å¦å¤–ï¼Œè¾ƒæ–°çš„æ–°é—»çš„å¹»è§‰ç‡ä¸æ¯”è¿‡æ—¶æ–°é—»é«˜ï¼Œå¯èƒ½æ˜¯ç”±äºè¾ƒæ–°çš„æ–°é—»çš„æ–‡æœ¬é•¿åº¦è¾ƒçŸ­ã€‚\nå„æ¨¡å‹å‡ºç°å¹»è§‰çš„æ¯”ä¾‹ï¼š\nï¼ˆspanã€densityä»€ä¹ˆæ„æ€ï¼‰\nè¡¨3æ˜¾ç¤ºï¼Œåœ¨æˆ‘ä»¬æ”¶é›†çš„æ•°æ®ä¸­ï¼ŒOpenAIçš„ä¸¤ä¸ªæ¨¡å‹è¡¨ç°å‡ºæ˜¾è‘—è¾ƒä½çš„å¹»è§‰ç‡ã€‚å…·ä½“æ¥è¯´ï¼ŒGPT-4-0613çš„å¹»è§‰é¢‘ç‡æœ€ä½ã€‚ä¸ºäº†æ›´æ¸…æ™°åœ°æ¯”è¾ƒä¸åŒæ¨¡å‹çš„å¹»è§‰ç‡ï¼Œæˆ‘ä»¬è®¡ç®—äº†æ¯ä¸ªæ¨¡å‹åœ¨ä¸‰ä¸ªä»»åŠ¡ä¸­çš„å¹»è§‰å¯†åº¦ã€‚å¹»è§‰å¯†åº¦å®šä¹‰ä¸ºæ¯ä¸€ç™¾ä¸ªå•è¯å“åº”ä¸­å¹³å‡å‡ºç°çš„å¹»è§‰è·¨åº¦æ•°ã€‚åœ¨Llama2ç³»åˆ—ä¸­ï¼Œé™¤äº†æ•°æ®æ€»æ–‡æœ¬å†™ä½œä»»åŠ¡å¤–ï¼Œæ¨¡å‹è§„æ¨¡ä¸å¹»è§‰å¯†åº¦ä¹‹é—´å­˜åœ¨æ˜æ˜¾çš„è´Ÿç›¸å…³å…³ç³»ã€‚å°½ç®¡Mistral-7B-Instructæ¨¡å‹åœ¨å„ç§åŸºå‡†å’Œæ’è¡Œæ¦œä¸Šçš„è¡¨ç°å¼ºåŠ²ï¼ˆZhengç­‰äººï¼Œ2023ï¼‰ï¼Œä½†å®ƒç”Ÿæˆçš„åŒ…å«å¹»è§‰çš„å›ç­”æ•°é‡æœ€å¤šã€‚\nå¹»è§‰ä¸æ–‡æœ¬é•¿åº¦çš„å…³ç³»ï¼š\nå¯¹äºä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆCLBï¼‰ï¼Œåªæœ‰æ–°é—»æ‘˜è¦å‘ˆç°å‡ºä¸Šä¸‹æ–‡è¶Šé•¿ï¼Œè¶Šå®¹æ˜“å¹»è§‰çš„ç‰¹ç‚¹ã€‚\nå¯¹äºå›ç­”é•¿åº¦ï¼ˆRLBï¼‰ï¼Œéƒ½æœ‰å›ç­”è¶Šé•¿ï¼Œè¶Šå®¹æ˜“å¹»è§‰çš„ç‰¹ç‚¹ã€‚\nå¹»è§‰ä¸ä½ç½®çš„å…³ç³»ï¼š\nåœ¨é—®ç­”å’Œæ–°é—»æ‘˜è¦ä»»åŠ¡ä¸­ï¼Œå¹»è§‰æ›´å€¾å‘äºå‡ºç°åœ¨å›ç­”çš„æœ«å°¾ã€‚æ•°æ®åˆ°æ–‡æœ¬å†™ä½œä»»åŠ¡åœ¨å‰åŠéƒ¨åˆ†è¾ƒæ˜“å‡ºç°å¹»è§‰ã€‚\n","permalink":"https://Rook1eChan.github.io/posts/ragtruth/","summary":"\u003ch1 id=\"1motivation\"\u003e1.Motivation\u003c/h1\u003e\n\u003cp\u003eå°½ç®¡æœ‰äº†RAGçš„å¸®åŠ©ï¼ŒLLMä»æœ‰å¯èƒ½ç»™å‡ºä¸æ‰€æä¾›çŸ¥è¯†ä¸ç¬¦çš„å›ç­”ã€‚å› æ­¤éœ€è¦æ„å»ºä¸€ä¸ªæ•°æ®é›†æ¥æ£€æµ‹å¹»è§‰ã€‚\u003c/p\u003e\n\u003cbr\u003e\n\u003ch1 id=\"2contributions\"\u003e2.Contributions\u003c/h1\u003e\n\u003col\u003e\n\u003cli\u003eæå‡ºRAGTruthï¼Œä¸€ä¸ªå¤§è§„æ¨¡è¯çº§åˆ«çš„å¹»è§‰æ£€æµ‹æ•°æ®é›†ï¼Œç”±LLMè‡ªç„¶äº§ç”Ÿï¼ˆä½œè€…è®¤ä¸ºæ•…æ„è§¦å‘çš„å¹»è§‰ä¸è‡ªç„¶äº§ç”Ÿçš„å¹»è§‰å­˜åœ¨å·®å¼‚ï¼‰\u003c/li\u003e\n\u003cli\u003eå¯¹ç°æœ‰å¹»è§‰æ£€æµ‹æ–¹æ³•è¿›è¡Œæ¯”è¾ƒ\u003c/li\u003e\n\u003cli\u003eæå‡ºäº†å¾®è°ƒLLMç”¨äºå¹»è§‰æ£€æµ‹çš„åŸºçº¿ã€‚Llama-2-13Båœ¨RAGTruth training dataä¸Šå¾®è°ƒåæ¯”å¾—ä¸ŠGPT4\u003c/li\u003e\n\u003cli\u003eè¯æ˜äº†ä½¿ç”¨å¾®è°ƒå¾—åˆ°çš„å¹»è§‰æ£€æµ‹å™¨ï¼Œèƒ½é™ä½å¹»è§‰\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch1 id=\"3related-work\"\u003e3.Related Work\u003c/h1\u003e\n\u003ch1 id=\"4methods\"\u003e4.Methods\u003c/h1\u003e\n\u003ch2 id=\"1hallucination-taxonomyå¹»è§‰ç±»å‹\"\u003e1.Hallucination Taxonomyå¹»è§‰ç±»å‹\u003c/h2\u003e\n\u003cp\u003eæœ¬æ–‡å°†å¹»è§‰ç±»å‹åˆ†ä¸ºï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eEvident Conflictæ˜æ˜¾å†²çª\u003c/strong\u003eï¼šä¸æä¾›çš„æ–‡æœ¬æ˜æ˜¾ç›¸åï¼Œå®¹æ˜“è¾¨åˆ«ï¼Œå¦‚äº‹å®é”™è¯¯ã€æ‹¼å†™é”™è¯¯ã€æ•°å­—é”™è¯¯ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSubtle Conflictè½»å¾®å†²çª\u003c/strong\u003eï¼šç”Ÿæˆçš„ä¿¡æ¯ä¸æä¾›çš„æ–‡æœ¬æœ‰æ­§ä¹‰ï¼Œæ¯”å¦‚æœ¯è¯­çš„æ›¿æ¢ï¼Œéœ€è¦ç»“åˆä¸Šä¸‹æ–‡åˆ¤æ–­ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eEvident Introduction of Baseless Informationæ˜æ˜¾å¼•å…¥æ— æ ¹æ®çŸ¥è¯†\u003c/strong\u003eï¼šç”Ÿæˆçš„å†…å®¹ä¸åœ¨æä¾›çš„ä¿¡æ¯ä¹‹å†…ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSubtle Introduction of Baseless Informationè½»å¾®å¼•å…¥æ— æ ¹æ®çŸ¥è¯†\u003c/strong\u003eï¼šç”Ÿæˆå†…å®¹è¶…å‡ºäº†æä¾›çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸»è§‚çš„å‡è®¾æˆ–æ¨æ–­ã€‚\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"2response-generationå›ç­”ç”Ÿæˆ\"\u003e2.Response Generationå›ç­”ç”Ÿæˆ\u003c/h2\u003e\n\u003cp\u003eé€‰æ‹©ä¸‰ä¸ªä»»åŠ¡: Question Answering,Data-to-text Writing, and News Summarization.ï¼ˆé—®é¢˜å›ç­”ã€æ•°æ®åˆ°æ–‡æœ¬çš„å†™ä½œã€æ–°é—»æ‘˜è¦ï¼‰ï¼Œç”Ÿæˆå›ç­”å¹¶äººå·¥æ ‡æ³¨å¹»è§‰éƒ¨åˆ†ã€‚\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eQuestion Answering\u003c/strong\u003eï¼šä»MS MARCOé€‰æ‹©ä¸ç”Ÿæ´»ç›¸å…³çš„QAï¼Œæ¯ä¸ªé—®é¢˜ä¿ç•™ä¸‰æ®µæå–å†…å®¹ï¼Œç„¶åä½¿ç”¨LLMæ ¹æ®å†…å®¹å›ç­”é—®é¢˜ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eData-to-text Writing\u003c/strong\u003eï¼šä»Yelpæ•°æ®é›†é€‰æ‹©æœ‰å…³å•†å®¶çš„ç»“æ„åŒ–ä¿¡æ¯å’Œç”¨æˆ·çš„è¯„è®ºï¼Œç”¨LLMç”Ÿæˆå¯¹å•†å®¶çš„æè¿°ã€‚å¦‚æœæ•°æ®å‡ºç°ç©ºå€¼è€Œå¤§æ¨¡å‹å°†å…¶è§£é‡Šä¸ºâ€œå‡â€ï¼Œè®¤ä¸ºè¿™æ˜¯å‡ºç°äº†å¹»è§‰ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eNews Summarization\u003c/strong\u003eï¼šæ•°æ®æ¥è‡ªCNN/Daily Mail dataset+æŸæ–°é—»å¹³å°çš„æ–°é—»ï¼Œä½¿ç”¨LLMå¯¹æ¯ç¯‡å†…å®¹ç”Ÿæˆæ‘˜è¦ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eä½¿ç”¨çš„LLMï¼šGPT-3.5-turbo-0613ã€GPT-4-0613ã€Mistral-7b-Instructã€Llama-2-7B-chatã€ Llama-2-13B-chatã€ Llama-2-70B-chat\u003c/p\u003e\n\u003cp\u003eæ¯ä¸ªä»»åŠ¡éƒ½ç”¨6ä¸ªæ¨¡å‹è·‘ä¸€éï¼Œå¾—åˆ°6ä¸ªå›ç­”ã€‚\u003c/p\u003e\n\u003ch2 id=\"5result\"\u003e5.Result\u003c/h2\u003e\n\u003cp\u003eå„é¡¹ä»»åŠ¡ä¸­å¹»è§‰ç±»å‹çš„æ¯”ä¾‹ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"f2\" loading=\"lazy\" src=\"/RAGTRUTH/f2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå¦‚å›¾2æ‰€ç¤ºï¼Œåœ¨ä¸Šä¸‹æ–‡ä¸­æ— æ ¹æ®çš„ä¿¡æ¯ç”Ÿæˆæ˜¾è‘—å¤šäºä¸ä¸Šä¸‹æ–‡å†²çªçš„ä¿¡æ¯ç”Ÿæˆï¼Œå°¤å…¶æ˜¯åœ¨é—®ç­”ä»»åŠ¡ä¸­ã€‚åœ¨ä¸¤å¤§ç±»æ— æ ¹æ®ä¿¡æ¯å’Œå†²çªä¿¡æ¯ä¸­ï¼Œæ›´ä¸¥é‡çš„å¹»è§‰ï¼Œå³æ˜æ˜¾çš„æ— æ ¹æ®ä¿¡æ¯å’Œæ˜æ˜¾çš„å†²çªä¿¡æ¯ï¼Œå æ®äº†ç›¸å½“å¤§çš„æ¯”ä¾‹ã€‚è¿™ä¸€è§‚å¯Ÿç»“æœè¯´æ˜å³ä½¿æœ‰RAGï¼Œè¿˜æ˜¯å­˜åœ¨ä¸¥é‡å¹»è§‰ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003e\u003cimg alt=\"t2\" loading=\"lazy\" src=\"/RAGTRUTH/t2.png\"\u003e\u003c/p\u003e\n\u003cp\u003eæ•°æ®è½¬æ–‡æœ¬çš„ä»»åŠ¡å¹»è§‰ç‡æœ€é«˜ï¼Œå¯èƒ½ä¸JSONæ ¼å¼æœ‰å…³ã€‚å¦å¤–ï¼Œè¾ƒæ–°çš„æ–°é—»çš„å¹»è§‰ç‡ä¸æ¯”è¿‡æ—¶æ–°é—»é«˜ï¼Œå¯èƒ½æ˜¯ç”±äºè¾ƒæ–°çš„æ–°é—»çš„æ–‡æœ¬é•¿åº¦è¾ƒçŸ­ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003eå„æ¨¡å‹å‡ºç°å¹»è§‰çš„æ¯”ä¾‹ï¼š\u003c/p\u003e\n\u003cp\u003eï¼ˆspanã€densityä»€ä¹ˆæ„æ€ï¼‰\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"t2\" loading=\"lazy\" src=\"/RAGTRUTH/t3.png\"\u003e\u003c/p\u003e\n\u003cp\u003eè¡¨3æ˜¾ç¤ºï¼Œåœ¨æˆ‘ä»¬æ”¶é›†çš„æ•°æ®ä¸­ï¼ŒOpenAIçš„ä¸¤ä¸ªæ¨¡å‹è¡¨ç°å‡ºæ˜¾è‘—è¾ƒä½çš„å¹»è§‰ç‡ã€‚å…·ä½“æ¥è¯´ï¼ŒGPT-4-0613çš„å¹»è§‰é¢‘ç‡æœ€ä½ã€‚ä¸ºäº†æ›´æ¸…æ™°åœ°æ¯”è¾ƒä¸åŒæ¨¡å‹çš„å¹»è§‰ç‡ï¼Œæˆ‘ä»¬è®¡ç®—äº†æ¯ä¸ªæ¨¡å‹åœ¨ä¸‰ä¸ªä»»åŠ¡ä¸­çš„å¹»è§‰å¯†åº¦ã€‚å¹»è§‰å¯†åº¦å®šä¹‰ä¸ºæ¯ä¸€ç™¾ä¸ªå•è¯å“åº”ä¸­å¹³å‡å‡ºç°çš„å¹»è§‰è·¨åº¦æ•°ã€‚åœ¨Llama2ç³»åˆ—ä¸­ï¼Œé™¤äº†æ•°æ®æ€»æ–‡æœ¬å†™ä½œä»»åŠ¡å¤–ï¼Œæ¨¡å‹è§„æ¨¡ä¸å¹»è§‰å¯†åº¦ä¹‹é—´å­˜åœ¨æ˜æ˜¾çš„è´Ÿç›¸å…³å…³ç³»ã€‚å°½ç®¡Mistral-7B-Instructæ¨¡å‹åœ¨å„ç§åŸºå‡†å’Œæ’è¡Œæ¦œä¸Šçš„è¡¨ç°å¼ºåŠ²ï¼ˆZhengç­‰äººï¼Œ2023ï¼‰ï¼Œä½†å®ƒç”Ÿæˆçš„åŒ…å«å¹»è§‰çš„å›ç­”æ•°é‡æœ€å¤šã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003eå¹»è§‰ä¸æ–‡æœ¬é•¿åº¦çš„å…³ç³»ï¼š\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"t2\" loading=\"lazy\" src=\"/RAGTRUTH/t4.png\"\u003e\u003c/p\u003e\n\u003cp\u003eå¯¹äºä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆCLBï¼‰ï¼Œåªæœ‰æ–°é—»æ‘˜è¦å‘ˆç°å‡ºä¸Šä¸‹æ–‡è¶Šé•¿ï¼Œè¶Šå®¹æ˜“å¹»è§‰çš„ç‰¹ç‚¹ã€‚\u003c/p\u003e\n\u003cp\u003eå¯¹äºå›ç­”é•¿åº¦ï¼ˆRLBï¼‰ï¼Œéƒ½æœ‰å›ç­”è¶Šé•¿ï¼Œè¶Šå®¹æ˜“å¹»è§‰çš„ç‰¹ç‚¹ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003cp\u003eå¹»è§‰ä¸ä½ç½®çš„å…³ç³»ï¼š\u003c/p\u003e\n\u003cp\u003eåœ¨é—®ç­”å’Œæ–°é—»æ‘˜è¦ä»»åŠ¡ä¸­ï¼Œå¹»è§‰æ›´å€¾å‘äºå‡ºç°åœ¨å›ç­”çš„æœ«å°¾ã€‚æ•°æ®åˆ°æ–‡æœ¬å†™ä½œä»»åŠ¡åœ¨å‰åŠéƒ¨åˆ†è¾ƒæ˜“å‡ºç°å¹»è§‰ã€‚\u003c/p\u003e","title":"RAGTruth: A Hallucination Corpus for Developing Trustworthy Retrieval-Augmented Language Models"},{"content":" RAGï¼ŒQAå¸¸ç”¨çš„æ•°æ®é›†å’Œè¯„ä»·æ ‡å‡† å¤šä¸ºçŸ¥è¯†å¯†é›†å‹ã€é—®ç­”å‹æ•°æ®é›†\næ•°æ®é›† 1.UltraDomain lightragæ›¾ä½¿ç”¨\nä½¿ç”¨MemoRAGæå‡ºçš„Benchmarkã€‚\nåœ¨UltraDomainé‡Œï¼ŒåŒ…å«å¤šä¸ªé¢†åŸŸçš„æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®åŒ…æ‹¬å¤šæœ¬ä¹¦ã€‚ä»¥csä¸ºä¾‹ï¼Œå…±å«æœ‰100æœ¬ä¹¦å’Œ100ä¸ªå¯¹åº”çš„é—®é¢˜ã€‚è¯¥é¢†åŸŸä¸“æ³¨äºè®¡ç®—æœºç§‘å­¦ï¼Œæ¶µç›–æ•°æ®ç§‘å­¦å’Œè½¯ä»¶å·¥ç¨‹çš„å…³é”®é¢†åŸŸã€‚å®ƒç‰¹åˆ«å¼ºè°ƒæœºå™¨å­¦ä¹ å’Œå¤§æ•°æ®å¤„ç†ï¼Œå†…å®¹æ¶‰åŠæ¨èç³»ç»Ÿã€åˆ†ç±»ç®—æ³•ä»¥åŠä½¿ç”¨Sparkè¿›è¡Œå®æ—¶åˆ†æã€‚ï¼š\n{ input: How does Spark Streaming enable real-time data processing? answers: [\u0026#39;Spark Streaming extends ...... \u0026#39;] context: \u0026#34;Whole Book......\u0026#34; length: 131651 context_id: 7bcef8714a477fd61fc8fb0d499b2cc3 _id: b2fd8d9c6d1499d521d778ce3d6d06fa label: cs meta: {\u0026#39;title\u0026#39;: \u0026#39;Machine Learning With Spark\u0026#39;, \u0026#39;authors\u0026#39;: \u0026#39;Nick Pentreath\u0026#39;} } æ•°æ®é›†åœ°å€ï¼šTommyChien/UltraDomain Â· Datasets at Hugging Face\nLightragä½¿ç”¨LLMç”Ÿæˆé—®é¢˜-ç­”æ¡ˆå¯¹\nç”Ÿæˆé—®é¢˜çš„æ–¹æ³•æ¥è‡ªäºFrom Local to Global: A Graph RAG Approach to Query-Focused Summarization\næä¾›æ–‡æœ¬ï¼Œè®©å¤§æ¨¡å‹ç”ŸæˆKä¸ªä½¿ç”¨è¯¥æ•°æ®é›†çš„ç”¨æˆ·èº«ä»½ï¼ˆæ¯”å¦‚æ•°æ®é›†æ˜¯è´¢ç»æ–°é—»ï¼Œuserå°±å¯èƒ½æ˜¯æ”¶é›†é‡‘èå¸‚åœºè¶‹åŠ¿çš„è´¢ç»è®°è€…ï¼‰ï¼Œå¯¹äºæ¯ä¸ªç”¨æˆ·å†ç”ŸæˆNä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªç”¨æˆ·-ä»»åŠ¡æå‡ºMä¸ªé«˜å±‚æ¬¡é—®é¢˜ï¼ˆç†è§£æ•´ä¸ªæ•°æ®é›†ã€æ— éœ€æå–å…·ä½“äº‹å®ï¼‰\nUser: A tech journalist looking for insights and trends in the tech industry Task: Understanding how tech leaders view the role of policy and regulation Questions: 1. Which episodes deal primarily with tech policy and government regulation? 2. How do guests perceive the impact of privacy laws on technology development? 3. Do any guests discuss the balance between innovation and ethical considerations? 4. What are the suggested changes to current policies mentioned by the guests? 5. Are collaborations between tech companies and governments discussed and how? 2.DAPRä½¿ç”¨çš„æ•°æ®é›† MS MARCOã€Natural Questionsã€MIRACLã€Genomics å’Œ ConditionalQA\n3.HotpotQA å«æœ‰trainï¼ˆeasyã€mediumã€hardï¼‰ï¼Œtestï¼ˆdistractorã€full Wikiï¼‰\nDistractorï¼šæ¯ä¸ªé—®é¢˜ä¼šæä¾› 10 ç¯‡å¤‡é€‰ç¯‡ç« ï¼Œå…¶ä¸­åŒ…å« 2 æ®µä¸é—®é¢˜ç­”æ¡ˆç›¸å…³çš„æ®µè½ï¼Œ8 æ®µä¸ç›¸å…³çš„æ®µè½ï¼Œè¿™ 10 ç¯‡æ–‡ç« é™å®šäº†æ¨¡å‹å¯»æ‰¾ç­”æ¡ˆçš„èŒƒå›´ï¼Œç›¸å¯¹è¾ƒå°ã€‚ Full Wikiï¼šFull Wiki å±äºå¼€æ”¾åŸŸé—®ç­”ä»»åŠ¡ï¼Œæ¨¡å‹éœ€è¦ä»æ•´ä¸ªç»´åŸºç™¾ç§‘æ–‡æ¡£ä¸­æŠ½å–æ–‡æ¡£ï¼Œç„¶åå†ä»æ–‡æ¡£ä¸­æå–æ®µè½ï¼Œæœ€åä»æ®µè½ä¸­æŠ½å–ç­”æ¡ˆï¼Œæ•°æ®èŒƒå›´æ˜¯æ•´ä¸ªç»´åŸºç™¾ç§‘ï¼ŒèŒƒå›´è¦å¤§å¾—å¤šï¼Œè¿™ä½¿å¾—ä»»åŠ¡æ›´å…·æŒ‘æˆ˜æ€§ã€‚ï¼ˆå®é™…ä¸Šä¹Ÿæ˜¯10ç¯‡æ–‡ç« ï¼Œæ¯ç¯‡çš„æ®µè½ä¹Ÿæ²¡æ¯”distractoré•¿å¤šå°‘ï¼‰\n1.hotpot_train_v1.1.json\næ€»é—®é¢˜æ•°é‡: 90447 é—®é¢˜ç±»å‹åˆ†å¸ƒ: - comparison: 17456 (19.3%) - bridge: 72991 (80.7%) éš¾åº¦åˆ†å¸ƒ: - medium: 56814 (62.8%) - hard: 15661 (17.3%) - easy: 17972 (19.9%) é—®é¢˜é•¿åº¦åˆ†å¸ƒ: - 0-10: 0 (0.0%) - 11-20: 8 (0.0%) - 21-30: 96 (0.1%) - 31-40: 664 (0.7%) - 41-50: 3352 (3.7%) - 51-70: 18602 (20.6%) - 71-100: 31161 (34.5%) - 100+: 36564 (40.4%) 100å·¦å³æœ€å¤š supporting_factsç»Ÿè®¡: - å‡ ä¹éƒ½æ˜¯2ï¼Œå…¶æ¬¡3ã€4ï¼Œå…¶ä»–æå°‘ contextç»Ÿè®¡: - å‡ ä¹æ¯ä¸ªé—®é¢˜çš„ä¸Šä¸‹æ–‡æ•°é‡éƒ½åœ¨9-10 2.hotpot_dev_distractor_v1.json\n{ \u0026#34;_id\u0026#34;: \u0026#34;5a8b57f25542995d1e6f1371\u0026#34;, # é—®é¢˜ç¼–å· \u0026#34;answer\u0026#34;: \u0026#34;yes\u0026#34;, # å›ç­”ï¼ˆç®€çŸ­ï¼‰ \u0026#34;question\u0026#34;: \u0026#34;Were Scott Derrickson and Ed Wood of the same nationality?\u0026#34;, # é—®é¢˜ \u0026#34;supporting_facts\u0026#34;: [ # é»„é‡‘æ®µè½æ‰€åœ¨æ–‡æ¡£çš„æ ‡é¢˜ä»¥åŠå¥å­çš„ç¼–å· [\u0026#34;Scott Derrickson\u0026#34;, 0], [\u0026#34;Ed Wood\u0026#34;, 0] ], \u0026#34;context\u0026#34;: [ # ç›¸å…³çš„æ–‡æ¡£ï¼Œæ–‡æ¡£å†…åŒ…å«å¤šä¸ªæ®µè½ [ \u0026#34;Ed Wood (film)\u0026#34;, [ \u0026#34;Ed Wood is a 1994 American biographical period comedy-drama film directed and produced by Tim Burton, and starring Johnny Depp as cult filmmaker Ed Wood.\u0026#34;, \u0026#34; The film concerns the period in Wood\u0026#39;s life when he made his best-known films as well as his relationship with actor Bela Lugosi, played by Martin Landau.\u0026#34;, \u0026#34; Sarah Jessica Parker, Patricia Arquette, Jeffrey Jones, Lisa Marie, and Bill Murray are among the supporting cast.\u0026#34; ] ], [ \u0026#34;Scott Derrickson\u0026#34;, [ \u0026#34;Scott Derrickson (born July 16, 1966) is an American director, screenwriter and producer.\u0026#34;, \u0026#34; He lives in Los Angeles, California.\u0026#34;, \u0026#34; He is best known for directing horror films such as \\\u0026#34;Sinister\\\u0026#34;, \\\u0026#34;The Exorcism of Emily Rose\\\u0026#34;, and \\\u0026#34;Deliver Us From Evil\\\u0026#34;, as well as the 2016 Marvel Cinematic Universe installment, \\\u0026#34;Doctor Strange.\\\u0026#34;\u0026#34; ] ] ], \u0026#34;type\u0026#34;: \u0026#34;comparison\u0026#34;, # é—®é¢˜ç±»å‹ \u0026#34;level\u0026#34;: \u0026#34;hard\u0026#34; # é—®é¢˜ç­‰çº§ } æ€»é—®é¢˜æ•°é‡: 7405 é—®é¢˜ç±»å‹åˆ†å¸ƒ: - comparison: 1487 (20.1%) - bridge: 5918 (79.9%) éš¾åº¦åˆ†å¸ƒ: - hard: 7405 (100.0%) supporting_factsç»Ÿè®¡: - å‡ ä¹éƒ½æ˜¯2ï¼Œå…¶æ¬¡3ã€4ï¼Œå…¶ä»–æå°‘ - å¹³å‡æ¯ä¸ªé—®é¢˜çš„æ”¯æŒæ€§äº‹å®æ•°é‡: 2.43 - æœ€å¤šæ”¯æŒæ€§äº‹å®æ•°é‡: 8 - æœ€å°‘æ”¯æŒæ€§äº‹å®æ•°é‡: 2 contextç»Ÿè®¡: - 10ç¯‡æ–‡ç« ï¼Œ2ç¯‡ç›¸å…³ï¼Œ8ç¯‡ä¸ç›¸å…³ 3.hotpot_dev_fullwiki_v1.json\né—®é¢˜ç±»å‹åˆ†å¸ƒ: - comparison: 1487 (20.1%) - bridge: 5918 (79.9%) éš¾åº¦åˆ†å¸ƒ: - hard: 7405 (100.0%) é—®é¢˜é•¿åº¦åˆ†å¸ƒ: - 0-10: 0 (0.0%) - 11-20: 0 (0.0%) - 21-30: 0 (0.0%) - 31-40: 49 (0.7%) - 41-50: 282 (3.8%) - 51-70: 1612 (21.8%) - 71-100: 2919 (39.4%) - 100+: 2543 (34.3%) supporting_factsæ•°é‡åˆ†å¸ƒ: - åŒ…å« 2 ä¸ªsupporting_factsçš„é—®é¢˜: 4990 (67.4%) - åŒ…å« 3 ä¸ªsupporting_factsçš„é—®é¢˜: 1774 (24.0%) - åŒ…å« 5 ä¸ªsupporting_factsçš„é—®é¢˜: 80 (1.1%) - åŒ…å« 4 ä¸ªsupporting_factsçš„é—®é¢˜: 537 (7.3%) - åŒ…å« 7 ä¸ªsupporting_factsçš„é—®é¢˜: 9 (0.1%) - åŒ…å« 6 ä¸ªsupporting_factsçš„é—®é¢˜: 14 (0.2%) - åŒ…å« 8 ä¸ªsupporting_factsçš„é—®é¢˜: 1 (0.0%) contextæ•°é‡åˆ†å¸ƒ: - 10ç¯‡æ–‡ç« ï¼Œå±äºæ˜¯open-domainçš„å¼€æ”¾åŸŸé—®ç­”ä»»åŠ¡ï¼ˆæ²¡æœ‰äººä¸ºè®¾ç½®è´Ÿæ ·æœ¬ï¼Ÿï¼‰ 4.2WikiMultiHopQA è®ºæ–‡é“¾æ¥ï¼š Constructing A Multi-hop QA Dataset for Comprehensive Evaluation of Reasoning Steps - ACL Anthology\ngithub repoåœ°å€ï¼š Alab-NII/2wikimultihop\næ•°æ®åœ°å€ï¼šhttps://www.dropbox.com/s/npidmtadreo6df2/data.zip\nç±»ä¼¼hotpotqa\n{ \u0026#34;_id\u0026#34;: \u0026#34;str\u0026#34;, \u0026#34;type\u0026#34;: [\t// ä»¥ä¸‹å››ç§ä¹‹ä¸€ä½œä¸ºå€¼ã€‚é—®é¢˜ç±»å‹æœ‰ï¼šæ¯”è¾ƒã€æ¨ç†ã€ç»„åˆå’Œæ¡¥æ¥æ¯”è¾ƒ \u0026#34;compositional\u0026#34;, \u0026#34;inference\u0026#34;, \u0026#34;bridge_comparison\u0026#34;, \u0026#34;comparison\u0026#34; ], \u0026#34;question\u0026#34;: \u0026#34;str\u0026#34;, \u0026#34;context\u0026#34;: [ //å¯ç»„æˆcorpus [ \u0026#34;str(Title)\u0026#34;, // æ–‡æ¡£æ ‡é¢˜ [ \u0026#34;str(Sent)\u0026#34;, // å¥å­å†…å®¹ \u0026#34;str(Sent)\u0026#34; // å¥å­å†…å®¹ // ... ] ] // ... ], \u0026#34;supporting_facts\u0026#34;: [ //é»„é‡‘æ®µè½ [\u0026#34;str(title)\u0026#34;, \u0026#34;int(sent_id)\u0026#34;] // æ”¯æŒæ–‡æ¡£çš„æ ‡é¢˜å’Œå¯¹åº”å¥å­çš„åºå·ï¼ˆç¬¬å‡ å¥ï¼‰ ], \u0026#34;evidences\u0026#34;: [ [\u0026#34;str(subject entity)\u0026#34;, \u0026#34;str(relation)\u0026#34;, \u0026#34;str(object entity)\u0026#34;] // åˆ—è¡¨ï¼Œæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªåŒ…å«[ä¸»ä½“å®ä½“, å…³ç³», å®¢ä½“å®ä½“]çš„ä¸‰å…ƒç»„,æœ‰å‡ ç»„`supporting_facts`å°±æœ‰å‡ ç»„è¿™ä¸ª ], \u0026#34;answer\u0026#34;: \u0026#34;str\u0026#34; } 5.Qasper NLPè®ºæ–‡ç›¸å…³çš„é—®ç­”\nhfåœ°å€ï¼šhttps://huggingface.co/datasets/allenai/qasper\næ•°æ®é›†åœ°å€ï¼šhttps://qasper-dataset.s3.us-west-2.amazonaws.com/qasper-train-dev-v0.3.tgz\nè¯„ä»·æ ‡å‡† 1.Lightragä½¿ç”¨LLMè¯„ä»· åŒ…æ‹¬å‡ ä¸ªç»´åº¦ï¼Œå’ŒGraphRAGä¸€è‡´ï¼š\nâ€¢ Comprehensiveness. How much detail does the answer provide to cover all aspects and details of the question?\nâ€¢ Diversity. How varied and rich is the answer in providing different perspectives and insights on the question?\nâ€¢ Empowerment. How well does the answer help the reader understand and make informed judgments about the topic?\n2.NDCG ä¸€ã€NDCGæ˜¯ä»€ä¹ˆï¼Ÿ NDCGçš„å…¨ç§°æ˜¯ï¼šNormalized Discounted Cumulative Gain(å½’ä¸€åŒ–æŠ˜æŸç´¯è®¡å¢ç›Š)\nåœ¨æœç´¢å’Œæ¨èä»»åŠ¡ä¸­ï¼Œç³»ç»Ÿå¸¸è¿”å›ä¸€ä¸ªitemåˆ—è¡¨ã€‚å¦‚ä½•è¡¡é‡è¿™ä¸ªè¿”å›çš„åˆ—è¡¨æ˜¯å¦ä¼˜ç§€å‘¢ï¼Ÿ\nä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬æ£€ç´¢ã€æ¨èæ’åºã€‘ï¼Œç½‘é¡µè¿”å›äº†ä¸æ¨èæ’åºç›¸å…³çš„é“¾æ¥åˆ—è¡¨ã€‚åˆ—è¡¨å¯èƒ½ä¼šæ˜¯[A,B,C,G,D,E,F],ä¹Ÿå¯èƒ½æ˜¯[C,F,A,E,D]ï¼Œç°åœ¨é—®é¢˜æ¥äº†ï¼Œå½“ç³»ç»Ÿè¿”å›è¿™äº›åˆ—è¡¨æ—¶ï¼Œæ€ä¹ˆè¯„ä»·å“ªä¸ªåˆ—è¡¨æ›´å¥½ï¼Ÿ\næ²¡é”™ï¼ŒNDCGå°±æ˜¯ç”¨æ¥è¯„ä¼°æ’åºç»“æœçš„ã€‚æœç´¢å’Œæ¨èä»»åŠ¡ä¸­æ¯”è¾ƒå¸¸è§ã€‚\näºŒã€ä¸€ç‚¹ç‚¹æ¥ç†è§£NDCG~ G-CG-DCG-NDCG\nGain: è¡¨ç¤ºä¸€ä¸ªåˆ—è¡¨ä¸­æ‰€æœ‰itemçš„ç›¸å…³æ€§åˆ†æ•°ã€‚$rel(i)$è¡¨ç¤º$item(i)$ç›¸å…³æ€§å¾—åˆ†ã€‚$$Gain=rel(i)$$ Cumulative Gain: è¡¨ç¤ºå¯¹Kä¸ªitemçš„Gainè¿›è¡Œç´¯åŠ ã€‚$CG_{k}=\\sum_{i=1}^{k}{rel(i)}$ CGåªæ˜¯å•çº¯ç´¯åŠ ç›¸å…³æ€§ï¼Œä¸è€ƒè™‘ä½ç½®ä¿¡æ¯ã€‚ å¦‚æœè¿”å›ä¸€ä¸ªlist_1=[A,B,C,D,E]ï¼Œé‚£list_1çš„CGä¸º0.5+0.9+0.3+0.6+0.1=2.4\nå¦‚æœè¿”å›ä¸€ä¸ªlist_2=[D,A,E,C,B]ï¼Œé‚£list_2çš„CGä¸º0.6+0.5+0.1+0.3+0.9=2.4\næ‰€ä»¥ï¼Œé¡ºåºä¸å½±å“CGå¾—åˆ†ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¯„ä¼°ä¸åŒé¡ºåºçš„å½±å“ï¼Œå°±éœ€è¦ä½¿ç”¨å¦ä¸€ä¸ªæŒ‡æ ‡DCGæ¥è¯„ä¼°ã€‚\nDiscounted Cumulative Gain: è€ƒè™‘æ’åºé¡ºåºçš„å› ç´ ï¼Œä½¿å¾—æ’åé å‰çš„itemå¢ç›Šæ›´é«˜ï¼Œå¯¹æ’åé åçš„itemè¿›è¡ŒæŠ˜æŸã€‚ CGä¸é¡ºåºæ— å…³ï¼Œè€ŒDCGè¯„ä¼°äº†é¡ºåºçš„å½±å“ã€‚DCGçš„æ€æƒ³æ˜¯ï¼šlistä¸­itemçš„é¡ºåºå¾ˆé‡è¦ï¼Œä¸åŒä½ç½®çš„è´¡çŒ®ä¸åŒï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ’åœ¨å‰é¢çš„itemå½±å“æ›´å¤§ï¼Œæ’åœ¨åé¢çš„itemå½±å“è¾ƒå°ã€‚ï¼ˆä¾‹å¦‚ä¸€ä¸ªè¿”å›çš„ç½‘é¡µï¼Œè‚¯å®šæ˜¯æ’åœ¨å‰é¢çš„itemä¼šæœ‰æ›´å¤šäººç‚¹å‡»ï¼‰ã€‚æ‰€ä»¥ï¼Œç›¸å¯¹CGæ¥è¯´ï¼ŒDCGä½¿æ’åœ¨å‰é¢çš„itemå¢åŠ å…¶å½±å“ï¼Œæ’åœ¨åé¢çš„itemå‡å¼±å…¶å½±å“ã€‚\n$$DCG_{k}=\\sum_{i=1}^{k}{\\frac{rel(i)}{log_{2}(i+1)}}$$æ€ä¹ˆå®ç°è¿™ä¸ªæ€æƒ³å‘¢ï¼ŸDCGåœ¨CGçš„åŸºç¡€ä¸Šï¼Œç»™æ¯ä¸ªitemçš„ç›¸å…³æ€§æ¯”ä¸Šlog2(i+1)ï¼Œiè¶Šå¤§ï¼Œlog2(i+1)çš„å€¼è¶Šå¤§ï¼Œç›¸å½“äºç»™æ¯ä¸ªitemçš„ç›¸å…³æ€§æ‰“ä¸ªæŠ˜æ‰£ï¼Œitemè¶Šé åï¼ŒæŠ˜æ‰£è¶Šå¤§ã€‚\nè¿˜æ˜¯ä¸Šé¢é‚£ä¸ªä¾‹å­ï¼š\nlist_1=[A,B,C,D,E], å…¶å¯¹åº”è®¡ç®—å¦‚ä¸‹ï¼š\ni rel(i) log(i+1) rel(i)/log(i+1) 1 = A 0.5 1 0.5 2 = B 0.9 1.59 0.57 3 = C 0.3 2 0.15 4 = D 0.6 2.32 0.26 5 = E 0.1 2.59 0.04 list_1çš„ DCG_1= 0.5+0.57+0.15+0.26+0.04=1.52\nlist_2=[D,A,E,C,B]ï¼Œå…¶å¯¹åº”è®¡ç®—å¦‚ä¸‹ï¼š\ni rel(i) log(i+1) rel(i)/log(i+1) 1 = D 0.6 1 0.6 2 = A 0.5 1.59 0.31 3 = E 0.1 2 0.05 4 = C 0.3 2.32 0.13 5 = B 0.9 2.59 0.35 list_2çš„ DCG_2= 0.6+0.31+0.05+0.13+0.35=1.44\nDCG_1 \u0026gt; DCG_2, æ‰€ä»¥åœ¨è¿™ä¸ªä¾‹å­é‡Œlist_1ä¼˜äºlist_2ã€‚\nåˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œä½¿ç”¨DCGæ–¹æ³•å°±å¯ä»¥å¯¹ä¸åŒçš„listè¿›è¡Œè¯„ä¼°ï¼Œé‚£ä¸ºä»€ä¹ˆåé¢è¿˜æœ‰ä¸€ä¸ªNDCGå‘¢ï¼Ÿ\nNDCG(Normalized DCG): å½’ä¸€åŒ–æŠ˜æŸç´¯è®¡å¢ç›Š åœ¨NDCGä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€äº›IDGC(ideal DCG)\u0026ndash;ç†æƒ³çš„DCGï¼ŒIDCGçš„ä¾æ®æ˜¯ï¼šæ˜¯æ ¹æ®rel(i)é™åºæ’åˆ—ï¼Œå³æ’åˆ—åˆ°æœ€å¥½çŠ¶æ€ã€‚ç®—å‡ºæœ€å¥½æ’åˆ—çš„DCGï¼Œå°±æ˜¯IDCGã€‚\nIDCG=æœ€å¥½æ’åˆ—çš„DCG\nå¯¹äºä¸Šè¿°çš„ä¾‹å­ï¼ŒæŒ‰ç…§rel(i)è¿›è¡Œé™åºæ’åˆ—çš„æœ€å¥½çŠ¶æ€ä¸ºlist_best=[B,D,A,C,E]\ni rel(i) log(i+1) rel(i)/log(i+1) 1 = B 0.9 1 0.9 2 = D 0.6 1.59 0.38 3 = A 0.5 2 0.25 4 = C 0.3 2.32 0.13 5 = E 0.1 2.59 0.04 IDCG = list_bestçš„DCG_best = 0.9+0.38+0.25+0.13+0.04=1.7 (ç†æ‰€å½“ç„¶ï¼ŒIDCG\u0026gt;DCG_1å’ŒDCG_2)\nå› ä¸ºä¸åŒqueryçš„æœç´¢ç»“æœæœ‰å¤šæœ‰å°‘ï¼Œæ‰€ä»¥ä¸åŒqueryçš„DCGå€¼å°±æ²¡æœ‰åŠæ³•æ¥åšå¯¹æ¯”ã€‚æ‰€ä»¥æå‡ºNDCGã€‚\n$$NDCG=\\frac{DCG}{IDCG}$$æ‰€ä»¥NDGCä½¿ç”¨DCG/IDCGæ¥è¡¨ç¤ºï¼Œè¿™æ ·çš„è¯ï¼ŒNDCGå°±æ˜¯ä¸€ä¸ªç›¸å¯¹å€¼ï¼Œé‚£ä¹ˆä¸åŒqueryä¹‹é—´å°±å¯ä»¥é€šè¿‡NDCGå€¼è¿›è¡Œæ¯”è¾ƒè¯„ä¼°ã€‚\n3.Precision æ‰€æœ‰æ£€ç´¢åˆ°çš„ç»“æœä¸­ï¼Œæœ‰å¤šå°‘æ˜¯åº”è¯¥æ˜¯è¢«æ£€ç´¢åˆ°çš„\n$$Precision=\\frac{æ­£ç¡®çš„ç»“æœ}{è¿”å›çš„ç»“æœ}$$4.Recall 5.F1 ","permalink":"https://Rook1eChan.github.io/posts/ragqa-%E6%95%B0%E6%8D%AE%E9%9B%86%E8%AF%84%E4%BC%B0/","summary":"\u003cblockquote\u003e\n\u003cp\u003eRAGï¼ŒQAå¸¸ç”¨çš„æ•°æ®é›†å’Œè¯„ä»·æ ‡å‡†\nå¤šä¸ºçŸ¥è¯†å¯†é›†å‹ã€é—®ç­”å‹æ•°æ®é›†\u003c/p\u003e\u003c/blockquote\u003e\n\u003ch1 id=\"æ•°æ®é›†\"\u003eæ•°æ®é›†\u003c/h1\u003e\n\u003ch2 id=\"1ultradomain\"\u003e1.UltraDomain\u003c/h2\u003e\n\u003cp\u003elightragæ›¾ä½¿ç”¨\u003c/p\u003e\n\u003cp\u003eä½¿ç”¨\u003ca href=\"https://arxiv.org/abs/2409.05591\"\u003eMemoRAG\u003c/a\u003eæå‡ºçš„Benchmarkã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨UltraDomainé‡Œï¼ŒåŒ…å«å¤šä¸ªé¢†åŸŸçš„æ•°æ®ï¼Œæ¯ä¸ªæ•°æ®åŒ…æ‹¬å¤šæœ¬ä¹¦ã€‚ä»¥csä¸ºä¾‹ï¼Œå…±å«æœ‰100æœ¬ä¹¦å’Œ100ä¸ªå¯¹åº”çš„é—®é¢˜ã€‚è¯¥é¢†åŸŸä¸“æ³¨äºè®¡ç®—æœºç§‘å­¦ï¼Œæ¶µç›–æ•°æ®ç§‘å­¦å’Œè½¯ä»¶å·¥ç¨‹çš„å…³é”®é¢†åŸŸã€‚å®ƒç‰¹åˆ«å¼ºè°ƒæœºå™¨å­¦ä¹ å’Œå¤§æ•°æ®å¤„ç†ï¼Œå†…å®¹æ¶‰åŠæ¨èç³»ç»Ÿã€åˆ†ç±»ç®—æ³•ä»¥åŠä½¿ç”¨Sparkè¿›è¡Œå®æ—¶åˆ†æã€‚ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-gdscript3\" data-lang=\"gdscript3\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003einput\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eHow\u003c/span\u003e \u003cspan class=\"n\"\u003edoes\u003c/span\u003e \u003cspan class=\"n\"\u003eSpark\u003c/span\u003e \u003cspan class=\"n\"\u003eStreaming\u003c/span\u003e \u003cspan class=\"n\"\u003eenable\u003c/span\u003e \u003cspan class=\"n\"\u003ereal\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u003c/span\u003e\u003cspan class=\"n\"\u003etime\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"n\"\u003eprocessing\u003c/span\u003e\u003cspan class=\"err\"\u003e?\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003eanswers\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;Spark Streaming extends ...... \u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  \t\u003cspan class=\"n\"\u003econtext\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s2\"\u003e\u0026#34;Whole Book......\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003elength\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e131651\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003econtext_id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e7\u003c/span\u003e\u003cspan class=\"n\"\u003ebcef8714a477fd61fc8fb0d499b2cc3\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003e_id\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eb2fd8d9c6d1499d521d778ce3d6d06fa\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003elabel\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003ecs\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\t\u003cspan class=\"n\"\u003emeta\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"s1\"\u003e\u0026#39;title\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Machine Learning With Spark\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;authors\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"s1\"\u003e\u0026#39;Nick Pentreath\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eæ•°æ®é›†åœ°å€ï¼š\u003ca href=\"https://huggingface.co/datasets/TommyChien/UltraDomain\"\u003eTommyChien/UltraDomain Â· Datasets at Hugging Face\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eLightragä½¿ç”¨LLMç”Ÿæˆé—®é¢˜-ç­”æ¡ˆå¯¹\u003c/p\u003e\n\u003cp\u003eç”Ÿæˆé—®é¢˜çš„æ–¹æ³•æ¥è‡ªäº\u003ca href=\"https://arxiv.org/abs/2404.16130\"\u003eFrom Local to Global: A Graph RAG Approach to Query-Focused Summarization\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eæä¾›æ–‡æœ¬ï¼Œè®©å¤§æ¨¡å‹ç”ŸæˆKä¸ªä½¿ç”¨è¯¥æ•°æ®é›†çš„ç”¨æˆ·èº«ä»½ï¼ˆæ¯”å¦‚æ•°æ®é›†æ˜¯è´¢ç»æ–°é—»ï¼Œuserå°±å¯èƒ½æ˜¯æ”¶é›†é‡‘èå¸‚åœºè¶‹åŠ¿çš„è´¢ç»è®°è€…ï¼‰ï¼Œå¯¹äºæ¯ä¸ªç”¨æˆ·å†ç”ŸæˆNä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªç”¨æˆ·-ä»»åŠ¡æå‡ºMä¸ªé«˜å±‚æ¬¡é—®é¢˜ï¼ˆç†è§£æ•´ä¸ªæ•°æ®é›†ã€æ— éœ€æå–å…·ä½“äº‹å®ï¼‰\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-fallback\" data-lang=\"fallback\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e User: A tech journalist looking for insights and trends in the tech industry\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Task: Understanding how tech leaders view the role of policy and regulation\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e Questions:\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 1. Which episodes deal primarily with tech policy and government regulation?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 2. How do guests perceive the impact of privacy laws on technology development?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 3. Do any guests discuss the balance between innovation and ethical considerations?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 4. What are the suggested changes to current policies mentioned by the guests?\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e 5. Are collaborations between tech companies and governments discussed and how?\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cBR\u003e\n\u003ch2 id=\"2daprä½¿ç”¨çš„æ•°æ®é›†\"\u003e2.DAPRä½¿ç”¨çš„æ•°æ®é›†\u003c/h2\u003e\n\u003cp\u003eMS MARCOã€Natural Questionsã€MIRACLã€Genomics å’Œ ConditionalQA\u003c/p\u003e","title":"RAG,QAç›¸å…³æ•°æ®é›†åŠè¯„ä»·æ ‡å‡†"},{"content":"1.Motivation ç°æœ‰çš„ç¥ç»æ£€ç´¢ï¼ˆneural retrievalï¼‰çš„æ–¹æ³•ä¸»è¦é›†ä¸­åœ¨çŸ­æ–‡æœ¬æ’åºï¼Œåœ¨é•¿ç¯‡æ–‡ç« ä¸­åšæ£€ç´¢æ•ˆæœå¹¶ä¸å¥½ï¼ˆç”±äºè‡ªæ³¨æ„åŠ›æœºåˆ¶tokenæ•°é‡çš„é™åˆ¶ï¼›æˆ–è€…è¿”å›çš„æ–‡æ¡£è¿‡é•¿ï¼Œä¸ä¾¿äºç”¨æˆ·ä½¿ç”¨ï¼‰ã€‚å¦å¤–ï¼Œä½œè€…å‘ç°åœ¨å…ˆè¿›æ£€ç´¢å™¨çš„æ£€ç´¢é”™è¯¯ä¸­ï¼ŒåŠæ•°é”™è¯¯ä¸ç¼ºå°‘ä¸Šä¸‹æ–‡æœ‰å…³ã€‚\næ¯”å¦‚ï¼šåœ¨Aå‰§åœºä¸­æ¼”å‡ºè¿‡çš„æ¼”å‘˜æœ‰å“ªäº›ï¼Ÿå¦‚æœåªæ£€ç´¢å…³é”®å­—â€œAå‰§åœºâ€ï¼Œå¯èƒ½æ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œéœ€è¦ç»“åˆä¸Šä¸‹æ–‡æ‰¾åˆ°â€œâ€¦â€¦åœ¨è¿™é‡Œæ¼”å‡ºè¿‡â€¦â€¦â€çš„å†…å®¹æ‰æ˜¯çœŸæ­£ç­”æ¡ˆã€‚\nå› æ­¤ï¼Œä½œè€…é’ˆå¯¹ä¸Šä¸‹æ–‡å¼ºå…³è”çš„ä»»åŠ¡å»ºç«‹äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œä½¿ç”¨ä¸¤ç±»æ–¹æ³•ï¼ˆhybrid retrieval with BM25ã€ contextualized passage representationsï¼‰è¿›è¡Œå®éªŒï¼Œå¹¶è¯¦ç»†è§£é‡Šäº†å®éªŒç»“æœã€‚\n2.Related work Document Question Answeringï¼ˆDocQAï¼‰ï¼šè¦æ±‚æ¨¡å‹å›ç­”å…³äºè¾“å…¥æ–‡æ¡£çš„é—®é¢˜ï¼Œé€šå¸¸å‡è®¾æ–‡æ¡£åœ¨æé—®å‰å°±å·²ç»™å‡ºã€‚æœ¬æ–‡æå‡ºçš„(Document-Awarepassage Retrieval, DAPR)ä¸DocQAç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºDAPRå¸Œæœ›ç”¨æˆ·æé—®æ—¶ä¸çŸ¥é“ç›®æ ‡æ–‡æ¡£ï¼Œç”±æ¨¡å‹æ¥å¯»æ‰¾ç›®æ ‡æ–‡æ¡£ã€‚ Long-document retrievalï¼ˆé•¿æ–‡æ¡£æ£€ç´¢ï¼‰ï¼šå¯¹äºé•¿æ–‡æ¡£æ£€ç´¢æœ‰ä¸€äº›ç®€å•çš„æ–¹æ³•ï¼šå°†æ–‡æ¡£ä¸­æ®µè½ç›¸å…³æ€§çš„æœ€å¤§å€¼ä½œä¸ºæ–‡æ¡£çš„ç›¸å…³æ€§ï¼ˆMaxPï¼‰ï¼›ä»…ç¼–ç æ–‡æ¡£ä¸­çš„ç¬¬ä¸€ä¸ªæ®µè½ï¼ˆFirstPï¼‰â€¦â€¦ä¸DAPRç›¸æ¯”ï¼Œæ‰€æœ‰è¿™äº›å…ˆå‰çš„å·¥ä½œéƒ½æ²¡æœ‰ç ”ç©¶å¦‚ä½•åœ¨è€ƒè™‘æ–‡æ¡£ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æ£€ç´¢æ®µè½ã€‚ Hybrid retrievalï¼ˆæ··åˆæ£€ç´¢ï¼‰ï¼šå¯¹äºä¸€ä¸ªæŸ¥è¯¢ä½¿ç”¨å¤šä¸ªæ£€ç´¢ç³»ç»Ÿï¼ˆå¸¸å¸¸æ˜¯BM25+ç¥ç»æ£€ç´¢ï¼‰ rank fusionï¼ˆæ’åèåˆï¼‰â€”â€”é€šè¿‡å‡¸ç»„åˆã€äº’é€†æ’åç­‰æ–¹æ³•å°†ä¸åŒæ£€ç´¢ç³»ç»Ÿçš„ä¸ªä½“æ’ååˆå¹¶ä¸ºä¸€ä¸ªã€‚ hierarchical retrievalï¼ˆå±‚æ¬¡æ£€ç´¢ï¼‰â€”â€”é¦–å…ˆæ£€ç´¢æ–‡æ¡£ï¼Œç„¶åä»è¿™äº›æ–‡æ¡£ä¸­æ£€ç´¢æ®µè½ã€‚åªé€‚ç”¨äºæ®µè½æœ¬èº«è¶³ä»¥å¯¹æŸ¥è¯¢åšå‡ºå“åº”çš„æƒ…å†µã€‚ æœ¬æ–‡æ¢è®¨äº†æ®µè½æ’åå’Œæ–‡æ¡£æ’åç»“åˆçš„æœ‰æ•ˆæ€§ã€‚ Relation to pre-training tasksï¼ˆå’Œé¢„è®­ç»ƒä»»åŠ¡çš„å…³ç³»ï¼‰ï¼šæœ‰çš„ç ”ç©¶åœ¨é¢„è®­ç»ƒä¸­åŠ å…¥ä¸Šä¸‹æ–‡ã€‚ä½†æ¨ç†æ—¶ä»ç„¶åªå…³æ³¨ç‹¬ç«‹çš„æ®µè½ã€‚ è¡¥å……ï¼š NQï¼šè°·æ­Œçš„ä¸€ä¸ªé—®ç­”æ•°æ®é›† NDCGï¼šè¯„ä»·æ£€ç´¢åºåˆ—çš„ç›¸å…³æ€§å’Œä½ç½® å…±æŒ‡ä¿¡æ¯ï¼šæè¿°æ–‡æœ¬ä¸­ä¸åŒè¡¨è¾¾å¼æŒ‡å‘åŒä¸€å®ä½“æˆ–æ¦‚å¿µçš„è¯­è¨€ç°è±¡ï¼Œå¦‚*â€œç›ä¸½æ‰“å¼€äº†é—¨ï¼Œå¥¹éšåæ‹¿èµ·åŒ…ã€‚â€* â†’ â€œå¥¹â€ä¸â€œç›ä¸½â€å…±æŒ‡åŒä¸€äººã€‚ å…±æŒ‡æ¶ˆè§£ï¼ˆCoreference Resolutionï¼‰ï¼šè‡ªåŠ¨è¯†åˆ«æ–‡æœ¬ä¸­æ‰€æœ‰æŒ‡å‘åŒä¸€å®ä½“çš„è¡¨è¾¾å¼å¹¶åˆ†ç»„ã€‚ 3.Method DAPRä»»åŠ¡è¦æ±‚ç³»ç»Ÿæå–+æ’åºã€‚ç»™å‡ºæ®µè½é›†åˆ$C$ï¼Œæ–‡æ¡£é›†åˆ$D$ï¼Œå¯¹äºæŸ¥è¯¢é›†åˆ$q \\in Q$ï¼Œæ£€ç´¢ç³»ç»Ÿ$s$åº”è¯¥æå–å‡ºæœ€å¥½çš„$K$ä¸ªæ®µè½é›†åˆ$R$ã€‚\n3.1NQ-Hard å¯¹SOTAçš„æ£€ç´¢å™¨ï¼ˆDRAGON+,SPLADEv2, and ColBERTv2)ä½¿ç”¨NQæ•°æ®é›†ï¼Œå‘ç°ä¸€åŠçš„é”™è¯¯æ¥è‡ªäºä¸äº†è§£ä¸Šä¸‹æ–‡ã€‚å°†è¿™äº›æ•°æ®å‘½åä¸ºNQ-hardï¼Œå¹¶åˆ†ä¸º4ç±»ï¼š\nå…±æŒ‡æ¶ˆè§£ï¼ˆCRï¼‰ï¼šå…³é”®çš„å…±æŒ‡ä¿¡æ¯éœ€è¦é€šè¿‡ç‰¹å®šæ–‡æ¡£ä¸Šä¸‹æ–‡æ¥è§£æï¼› ä¸»è¦ä¸»é¢˜ï¼ˆMTï¼‰ï¼šåªæœ‰äº†è§£æ–‡æ¡£çš„èƒŒæ™¯ä¸»é¢˜ï¼ˆé€šå¸¸æ˜¯æ ‡é¢˜ï¼‰ï¼Œæ‰èƒ½å›ç­”æŸ¥è¯¢ï¼› å¤šè·³æ¨ç†ï¼ˆMHRï¼‰ï¼šè¿æ¥æŸ¥è¯¢å’ŒæŸ¥è¯¢ç›¸å…³æ®µè½ä¸­çš„å®ä½“çš„æ¨ç†è·¯å¾„åŒ…æ‹¬æ–‡æ¡£ä¸Šä¸‹æ–‡ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼› ç¼©å†™ï¼ˆACï¼‰ï¼šåœ¨ç›¸å…³æ®µè½ï¼ˆæˆ–æŸ¥è¯¢ï¼‰ä¸­å‡ºç°ä¸€ä¸ªç¼©å†™ï¼Œè¯¥ç¼©å†™å¯¹åº”äºæŸ¥è¯¢ï¼ˆæˆ–ç›¸å…³æ®µè½ï¼‰ä¸­çš„å…¨ç§°ï¼Œæ–‡æ¡£ä¸Šä¸‹æ–‡è§£é‡Šäº†è¿™ç§æ˜ å°„ï¼› 3.2Datasets MS MARCOã€Natural Questionsã€MIRACLã€Genomics å’Œ ConditionalQAï¼ˆå…·ä½“å¤„ç†æ–¹å¼è§é™„å½•Aï¼‰æœ‰è¯­æ–™åº“çš„ç›´æ¥ç”¨ï¼Œæ²¡æœ‰çš„æŠŠé»„é‡‘æ®µè½æ–‡æœ¬æ”¶é›†èµ·æ¥å½“è¯­æ–™åº“ã€‚ï¼ˆä¹Ÿæ˜¯å¾ˆç¥å¥‡ï¼‰\n3.3Evaluation ä½¿ç”¨nDCG@10å’Œrecall@100åšæŒ‡æ ‡ã€‚\nå°†binary/3-scaleè½¬æ¢ä¸º0-1/0-1-2ï¼Œç„¶åä½¿ç”¨pytrec_evalè®¡ç®—æŒ‡æ ‡ã€‚\nè€ƒè™‘åˆ°ç°å®ä¸–ç•Œä¸­çš„æ£€ç´¢ç³»ç»Ÿå¤šç”¨äºé›¶æ ·æœ¬ã€è·¨é¢†åŸŸçš„æƒ…æ™¯ï¼Œæœ¬æ–‡è¿›è¡Œäº†ä¸€é¡¹æµ‹è¯•ï¼šåœ¨MS MARCOè®­ç»ƒé›†è®­ç»ƒï¼Œç„¶ååœ¨MS MARCOæµ‹è¯•é›†æµ‹è¯•ï¼Œä½œä¸ºåŸŸå†…è¯„ä¼°ï¼›åœ¨å…¶å®ƒå››ä¸ªæ•°æ®é›†ä¸Šæµ‹è¯•ï¼Œä½œä¸ºåŸŸå¤–è¯„ä¼°ã€‚\n4.Experiments 4.1åŸºç¡€æ£€ç´¢å™¨ BM25ï¼ˆä½¿ç”¨PySeriniçš„é»˜è®¤é…ç½®ï¼‰ neural retrieversï¼šDRAGON+ã€SPLADEv2ã€ColBERTv2ï¼ˆåœ¨MS MARCOä¸Šè®­ç»ƒï¼‰ 4.2ä¸¤ç§å°†ä¸Šä¸‹æ–‡å¼•å…¥ç¥ç»æ£€ç´¢å™¨çš„æ–¹æ³• 4.2.1åŠ å…¥BM25çš„æ··åˆæ£€ç´¢ ï¼ˆ1ï¼‰Rank fusionèåˆæ£€ç´¢\nç”±äºç¥ç»ç½‘ç»œé€‚åˆäºæ£€æµ‹512tokenså†…çš„æ®µè½ï¼Œè€ŒBM25æ— é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥ä½¿ç”¨BM25æ£€ç´¢æ•´ä¸ªæ–‡æ¡£ï¼Œè€Œä½¿ç”¨ç¥ç»æ£€ç´¢å™¨æ£€ç´¢æ®µè½ã€‚\nç›¸å…³æ€§åˆ†æ•°ä¸ºï¼š\n$$s_{convex}(q,p,d)=\\alpha\\hat s_{BM25}(q,p) + (1-\\alpha)\\hat s_{nueral}(q,d)$$ï¼ˆå…¬å¼æœ‰è¯¯ï¼‰\n$\\hat s_{BM25},\\hat s_{nueral}$çš„åˆ†æ•°éƒ½æ˜¯å½’ä¸€åŒ–çš„ã€‚å½’ä¸€åŒ–å…¬å¼ä¸ºï¼š\n$$\\hat{s}(q, c) = \\frac{s(q, c) - m_q}{M_q - m_q}$$â€‹\n$s(q, c)$ï¼šæ£€ç´¢å™¨å¯¹æŸ¥è¯¢(q)å’Œå€™é€‰æ–‡æœ¬(c)ï¼ˆæ®µè½æˆ–æ–‡æ¡£ï¼‰çš„åŸå§‹åˆ†æ•°ã€‚ $m_qå’ŒM_q$ï¼šå½“å‰æŸ¥è¯¢(q)çš„Topå€™é€‰ç»“æœä¸­åˆ†æ•°çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚ è‹¥å€™é€‰æ–‡æœ¬(c)åœ¨æŸä¸€æ£€ç´¢å™¨çš„ç»“æœä¸­ç¼ºå¤±ï¼ˆæœªè¿›å…¥Topåˆ—è¡¨ï¼‰ï¼Œåˆ™å…¶åˆ†æ•°è§†ä¸º0ã€‚ åˆ†æ•°è®¡ç®—ç¤ºä¾‹ï¼š\nè¾“å…¥æ•°æ®:\n5ç¯‡æ–‡ç« ï¼Œæ¯ç¯‡2ä¸ªæ®µè½ï¼š æ–‡ç« D1ï¼šæ®µè½P1, P2 æ–‡ç« D2ï¼šæ®µè½P3, P4 æ–‡ç« D3ï¼šæ®µè½P5, P6 æ–‡ç« D4ï¼šæ®µè½P7, P8 æ–‡ç« D5ï¼šæ®µè½P9, P10 æ–‡æ¡£çº§æ£€ç´¢ç»“æœ (topk=2)ï¼š å¾—åˆ†ï¼šD1=0.8, D2=0.6ï¼ˆå…¶ä»–æ–‡æ¡£å¾—åˆ†ä½äºè¿™ä¸¤ä¸ªï¼‰ æ®µè½çº§æ£€ç´¢ç»“æœ (topk=2)ï¼š å¾—åˆ†ï¼šP3=0.9, P5=0.7ï¼ˆå…¶ä»–æ®µè½å¾—åˆ†ä½äºè¿™ä¸¤ä¸ªï¼‰ æ®µè½åˆ°æ–‡æ¡£æ˜ å°„ï¼š pid2did = { \u0026#39;P1\u0026#39;:\u0026#39;D1\u0026#39;, \u0026#39;P2\u0026#39;:\u0026#39;D1\u0026#39;, \u0026#39;P3\u0026#39;:\u0026#39;D2\u0026#39;, \u0026#39;P4\u0026#39;:\u0026#39;D2\u0026#39;, \u0026#39;P5\u0026#39;:\u0026#39;D3\u0026#39;, \u0026#39;P6\u0026#39;:\u0026#39;D3\u0026#39;, \u0026#39;P7\u0026#39;:\u0026#39;D4\u0026#39;, \u0026#39;P8\u0026#39;:\u0026#39;D4\u0026#39;, \u0026#39;P9\u0026#39;:\u0026#39;D5\u0026#39;, \u0026#39;P10\u0026#39;:\u0026#39;D5\u0026#39; } æ®µè½æƒé‡ï¼šå‡è®¾passage_weight=0.4ï¼ˆæ–‡æ¡£æƒé‡è‡ªåŠ¨ä¸º0.6ï¼‰ è®¡ç®—è¿‡ç¨‹:\næ„å»ºå¾—åˆ†æ˜ å°„ï¼š did2score = {\u0026#39;D1\u0026#39;:0.8, \u0026#39;D2\u0026#39;:0.6} # æ–‡æ¡£çº§top2 pid2score = {\u0026#39;P3\u0026#39;:0.9, \u0026#39;P5\u0026#39;:0.7} # æ®µè½çº§top2 ä¼ æ’­æ–‡æ¡£å¾—åˆ†åˆ°æ®µè½ï¼š doc_pid2score = { \u0026#39;P3\u0026#39;: did2score[\u0026#39;D2\u0026#39;], # P3å±äºD2 â†’ 0.6 \u0026#39;P5\u0026#39;: did2score[\u0026#39;D3\u0026#39;] # ä½†D3ä¸åœ¨did2scoreä¸­(æ–‡æ¡£çº§åªè¿”å›äº†D1,D2) } å®é™…ç»“æœåªæœ‰{'P3':0.6}ï¼Œå› ä¸ºD3ä¸åœ¨æ–‡æ¡£çº§top2ä¸­\nM2C2èåˆï¼ˆå‡è®¾æ˜¯çº¿æ€§åŠ æƒï¼‰ï¼š å¯¹P3ï¼š æ–‡æ¡£å¾—åˆ†ï¼š0.6 æ®µè½å¾—åˆ†ï¼š0.9 èåˆå¾—åˆ† = 0.6*0.6 + 0.9*0.4 = 0.36 + 0.36 = 0.72 å¯¹P5ï¼š æ–‡æ¡£å¾—åˆ†ï¼šæ—  â†’ å¯èƒ½è§†ä¸º0æˆ–å¿½ç•¥ æ®µè½å¾—åˆ†ï¼š0.7 å¦‚æœå¿½ç•¥æ–‡æ¡£éƒ¨åˆ†ï¼š0.7*0.4 = 0.28 æœ€ç»ˆèåˆç»“æœï¼š fused = {\u0026#39;P3\u0026#39;:0.72, \u0026#39;P5\u0026#39;:0.28} ï¼ˆ2ï¼‰Hierarchical retrievalå±‚æ¬¡æ£€ç´¢\nç¬¬ä¸€æ­¥å…ˆBM25æ£€ç´¢æ–‡æ¡£ï¼Œç¬¬äºŒæ­¥ç¥ç»æ£€ç´¢æœç´¢æ®µè½ï¼Œå¹¶åœ¨ç¬¬äºŒæ­¥åº”ç”¨å¸¦æœ‰åˆ†æ•°å½’ä¸€åŒ–çš„æ’åèåˆã€‚\n4.2.2ä¸Šä¸‹æ–‡åŒ–çš„æ®µè½è¡¨ç¤º ï¼ˆ1ï¼‰**Prepending titlesï¼š**å°†æ–‡ç« æ ‡é¢˜æ”¾åœ¨æ¯ä¸ªæ®µè½çš„å¼€å¤´ï¼Œå¹¶ç”¨ç‰¹æ®Šæ ‡è®°åˆ†å‰²ã€‚å¯èƒ½ä¼šå‡ºç°æ–‡æ¡£æ— æ ‡é¢˜æˆ–æ ‡é¢˜æ— æ„ä¹‰ã€‚\nï¼ˆ2ï¼‰**Prepending document keyphrasesï¼š**ä½¿ç”¨TopicRankç®—æ³•ï¼ˆä¸çŸ¥é“åœ¨RAGä¸­ï¼Œå’Œå¤§æ¨¡å‹æŠ½å–å…³é”®è¯ç›¸æ¯”å¦‚ä½•ï¼‰æå–å‡ºæ–‡æ¡£çš„åä¸ªå…³é”®è¯ï¼Œæ”¾åœ¨æ¯ä¸ªæ®µè½ä¹‹å‰ã€‚\nï¼ˆ3ï¼‰**Coreference resolutionï¼ˆå…±æŒ‡æ¶ˆè§£ï¼‰ï¼š**ä½¿ç”¨SpanBERT-large modelï¼Œé‡‡ç”¨c2f-corefæ–¹æ³•ï¼Œåœ¨OntoNotesä¸Šå¾®è°ƒã€‚ç„¶åç”¨æ¨¡å‹å¯¹æ–‡æ¡£ç”Ÿæˆä»£è¯-å…ˆè¡Œè¯æ˜ å°„ã€‚å°†ä»£è¯ä¸æ–‡æ¡£ä¸­æœ€æ—©å‡ºç°çš„å…ˆè¡Œè¯å…³è”ã€‚å°†å…ˆè¡Œè¯æ”¾å…¥æ‹¬å·ï¼Œé™„åœ¨å¯¹åº”çš„ä»£è¯åé¢ã€‚æ¯”å¦‚ â€œæ›¾åœ¨è¯¥åœºåœ°ï¼ˆxxå‰§åœºï¼‰â€\n5.result 5.1æ··åˆæ£€ç´¢\nrank fusionç•¥å¥½äºhierarchicalï¼Œä½†éƒ½ä¸èƒ½è§£å†³NQ-Hardé—®é¢˜ã€‚è¯´æ˜è¿™ä¸¤ç§æ–¹æ³•éƒ½åªèƒ½æé«˜è‡ªåŒ…å«é—®é¢˜çš„è¡¨ç°ã€‚\nç»Ÿè®¡äº†æ£€ç´¢æ€§èƒ½éšèåˆæƒé‡å˜åŒ–çš„æ›²çº¿ã€‚å‘ç°NQä¸Šçš„æœ€ä½³èåˆæƒé‡ä¸èƒ½ç›´æ¥è½¬ç§»åˆ°NQ-hardä¸Šã€‚\n5.2ä¸Šä¸‹æ–‡åŒ–æ®µè½è¡¨ç¤º\næ·»åŠ æ ‡é¢˜å’Œå…³é”®è¯éƒ½ç›¸å½“äºæ·»åŠ æ‘˜è¦ï¼Œæå‡æ•ˆæœç›¸å½“ï¼›å…±æŒ‡æ¶ˆè§£è¡¨ç°æœ€å·®ã€‚\nåœ¨NQ-Hardé—®é¢˜ï¼ˆéœ€è¦è¿æ¥ä¸Šä¸‹æ–‡çš„é—®é¢˜ï¼‰çš„è¡¨ç°æ˜¾è‘—ä¼˜äºæ··åˆæ£€ç´¢ã€‚\n6.Disscution 1.ä¸ºä»€ä¹ˆæ··åˆæ£€ç´¢åœ¨Hardé—®é¢˜ä¸Šè¡¨ç°ä¸ä½³\né€šè¿‡MaxPæ–¹æ³•å°†æŸ¥è¯¢-æ®µè½çš„æŒ‡æ ‡è½¬ä¸ºæŸ¥è¯¢-æ–‡æ¡£çš„æŒ‡æ ‡ï¼Œä½œè€…å‘ç°rank fusionå’Œhierarchicalæ£€ç´¢å‡ºçš„æ–‡æ¡£å¤§éƒ½æ­£ç¡®ï¼Œè¯´æ˜å®ƒèƒ½æ‰¾åˆ°ç›¸å…³æ–‡æ¡£ï¼Œä½†æ®µè½æ’åºè¡¨ç°éå¸¸å·®ï¼Œè¯´æ˜è¿™ä¸¤ç§æ–¹æ³•ä¸èƒ½å¤Ÿæœ‰æ•ˆçš„å¯¹æ®µè½è¿›è¡Œæ’åºã€‚\nå¦å¤–ï¼Œä½œè€…æåˆ°fusion weight åœ¨ NQ-Hardå’Œæ™®é€šé—®é¢˜ä¸­çš„å˜åŒ–è¶‹åŠ¿ä¸åŒã€‚æ‰€ä»¥ä½¿ç”¨æ··åˆæ£€ç´¢ä¸èƒ½åŒæ—¶åœ¨ä¸¤ç±»é—®é¢˜ä¸Šè¾¾åˆ°æœ€ä½³è¡¨ç°ã€‚\n2.ä¸ºä»€ä¹ˆåœ¨Genomicsä¸Šä¸Šä¸‹æ–‡è¡¨ç¤ºç»“æœå˜å·®\nè®¡ç®—äº†åŠ /ä¸åŠ æ ‡é¢˜çš„æ–‡æ¡£ä¸queryçš„Jaccardç›¸ä¼¼åº¦ï¼Œåªæœ‰GenomicsåŠ æ ‡é¢˜åå€¼å‡å°ã€‚è¯´æ˜æ·»åŠ æ ‡é¢˜å¼•å…¥äº†æ›´å¤šä¸ç›¸å…³çš„å†…å®¹ï¼Œå¸®å€’å¿™ã€‚\nJaccard ç›¸ä¼¼åº¦å…¬å¼ï¼š$\\text{Jaccard}(A, B) = \\frac{|A \\cap B|}{|A \\cup B|}$\n$A $ å’Œ$B $ï¼šä¸¤ä¸ªæ–‡æœ¬çš„è¯é›†åˆï¼ˆæˆ–æ›´å¹¿ä¹‰çš„é›†åˆï¼‰ã€‚ $|A \\cap B|$: A å’Œ B ä¸­**å…±åŒè¯ï¼ˆäº¤é›†ï¼‰**çš„æ•°é‡ã€‚ $|A \\cup B| $: A å’Œ B ä¸­**æ‰€æœ‰å”¯ä¸€è¯ï¼ˆå¹¶é›†ï¼‰**çš„æ•°é‡ã€‚ å–å€¼èŒƒå›´ $[0, 1]$ï¼ˆ0 è¡¨ç¤ºæ— é‡å ï¼Œ1 è¡¨ç¤ºå®Œå…¨ä¸€è‡´ï¼‰ã€‚\nä¼˜ç‚¹ï¼š\nç®€å•ç›´è§‚ï¼Œé€‚ç”¨äºçŸ­æ–‡æœ¬æˆ–é›†åˆå‹æ•°æ® ä¸ä¾èµ–è¯åºæˆ–è¯­ä¹‰ï¼ˆä»…ç»Ÿè®¡è¯é‡å ï¼‰ ç¼ºç‚¹ï¼š\nå¿½ç•¥è¯­ä¹‰ï¼šåŒä¹‰è¯ï¼ˆå¦‚â€œç”µè„‘â€å’Œâ€œè®¡ç®—æœºâ€ï¼‰ä¼šè¢«è§†ä¸ºä¸åŒè¯ã€‚ æ•æ„Ÿäºè¯é¢‘ï¼šæœªè€ƒè™‘è¯çš„é‡è¦æ€§ï¼ˆå¦‚TF-IDFï¼‰ï¼Œå¯ä»¥ç»™è¯æ·»åŠ æƒé‡ä½œä¸ºæ”¹è¿›ã€‚ é•¿æ–‡æœ¬æ•ˆæœå·®ï¼šå¹¶é›†ä¼šæ€¥å‰§å¢å¤§ï¼Œå¯¼è‡´ç›¸ä¼¼åº¦è¢«ä½ä¼°ã€‚ 3.é”™è¯¯åˆ†æ\nåœ¨ä¸¤ç§èåˆæ£€ç´¢ã€ä¸‰ç§ä¸Šä¸‹æ–‡åŒ–çš„æ–¹æ³•ä¸‹ï¼Œå¤šè·³æ¨ç†MHRæœ€éš¾è§£å†³ï¼Œç¼©å†™æœ€æ˜“è§£å†³ã€‚ä½¿ç”¨å…±æŒ‡æ¶ˆè§£ä¸å¦‚ç›´æ¥æ·»åŠ æ ‡é¢˜ï¼Œå› ä¸ºæ ‡é¢˜å¾€å¾€å«æœ‰æ ¸å¿ƒè¯ï¼Œè€Œå…±æŒ‡æ¶ˆè§£å¤šæ¬¡åœ¨æ®µè½ä¸­æ’å…¥å†…å®¹ï¼Œåè€Œå¹²æ‰°äº†åŒ¹é…ã€‚\nè¯¥æ–‡ç« ä¸­äº†ACL2024ã€‚åœ¨è¿æ¥ä¸Šä¸‹æ–‡æ–¹é¢ä½¿ç”¨çš„æ–¹æ³•æ¯”è¾ƒæ·³æœ´ã€‚ä¸»è¦æ˜¯å®šä¹‰äº†NQ-Hardæ•°æ®é›†ï¼Œå¹¶åœ¨5ä¸ªæ•°æ®é›†ã€åŸå§‹æ–¹æ³•+2ä¸ªæ··åˆæ£€ç´¢+3ä¸ªä¸Šä¸‹æ–‡æ£€ç´¢ä¸Šåšäº†ä¸€ç³»åˆ—å®éªŒï¼Œå¹¶å¾ˆå¥½çš„è§£é‡Šäº†ç°è±¡ã€‚\nå¤ç° æŠŠREADMEé‡Œçš„loaddataå’Œevaluationçš„ä»£ç å¤åˆ¶åˆ°dapræ ¹ç›®å½•load.pyå’Œeval.pyä¸‹\npip install -r requirements.txt\næœ‰setup.pyï¼Œåœ¨æ ¹ç›®å½•ä¸‹python setup.py build python setup.py install è§£å†³module\u0026rsquo;dapr\u0026rsquo; not found\nsudo apt-get update\nConditionalQAæ•°æ®é›† ConditionalQAç»™å®šæé—®è€…ç‰¹å®šæƒ…å†µä¸‹çš„æƒ…æ™¯ï¼Œå›ç­”ä¸è‹±å›½æ”¿ç­–ç›¸å…³çš„é—®é¢˜ã€‚æ¯ä¸ªé—®ç­”å®ä¾‹éƒ½æ ‡æ³¨äº†æ¥è‡ªè‹±å›½æ”¿åºœæ”¿ç­–ç½‘é¡µçš„è¯æ®ã€‚æˆ‘ä»¬å°†åŸå§‹æ•°æ®é›†ä¸­çš„æ‰€æœ‰æ­¤ç±»ç½‘é¡µä½œä¸ºè¯­æ–™åº“ã€‚æ¯ä¸ªç½‘é¡µæœ€åˆè¢«è§£æä¸ºHTMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°†å…¶è§†ä¸ºæ®µè½ï¼Œç§»é™¤HTMLæ ‡ç­¾ï¼Œä»…ä¿ç•™çº¯è‡ªç„¶è¯­è¨€ã€‚å¯¹äºæ¯ä¸ªé—®ç­”å®ä¾‹ï¼Œæˆ‘ä»¬å°†æƒ…æ™¯å’Œé—®é¢˜è¿æ¥èµ·æ¥å½¢æˆä¸€ä¸ªæŸ¥è¯¢ï¼Œå¹¶å°†ç›¸åº”çš„è¯æ®è§†ä¸ºé»„é‡‘ç›¸å…³æ®µè½ã€‚\né¢„å¤„ç†åçš„trainï¼ˆåŸç‰ˆçš„æ•°æ®æ²¡æœ‰æ–‡ç« å’Œå¥å­çš„idï¼Œè¿™æ˜¯å¤„ç†åçš„æ•°æ®ï¼‰\n{ \u0026#34;query\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;train-0\u0026#34;, //trainæ¡ç›®ç¼–å· \u0026#34;text\u0026#34;: \u0026#34;My father, who was a widower and the owner of several large properties in Wales, died recently and apparently intestate. My paternal uncle is applying for probate, but I believe that I have a stronger claim. Do I have a greater right to probate in respect of my late father\u0026#39;s estate?\u0026#34; }, \u0026#34;judged_chunks\u0026#34;: [ //åˆ¤æ–­ç‚¹ï¼Œä¸€ä¸ªé—®é¢˜å¯èƒ½æœ‰å¤šä¸ªé»„é‡‘æ®µè½ { \u0026#34;chunk\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;74-24\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;\u0026lt;p\u0026gt;You can apply to become the estateâ€™s administrator if you are 18 or over and you are the most â€˜entitledâ€™ inheritor of the deceasedâ€™s estate. This is usually the deceasedâ€™s closest living relative.\u0026lt;/p\u0026gt;\u0026#34; }, \u0026#34;judgement\u0026#34;: 1, //éƒ½ä¸º1 \u0026#34;belonging_doc\u0026#34;: { //æ¯ä¸ªchunkéƒ½æŠŠ\u0026#34;belonging_doc\u0026#34;è¯¦ç»†å†™äº†ä¸€éï¼Œå¯¼è‡´æ–‡ä»¶å¾ˆå¤§ \u0026#34;id\u0026#34;: \u0026#34;74\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;Applying for probate\u0026#34;, \u0026#34;chunks\u0026#34;: [ { \u0026#34;id\u0026#34;: \u0026#34;74-0\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;Overview\u0026#34; }, ... { \u0026#34;id\u0026#34;: \u0026#34;74-138\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;Once you have probate you can start dealing with the estate.\u0026#34; } ], \u0026#34;candidate_chunk_ids\u0026#34;: [ \u0026#34;74-5\u0026#34;, ... \u0026#34;74-51\u0026#34; ] } } ... ] } é¢„å¤„ç†åçš„test\n{ \u0026#34;query\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;dev-0\u0026#34;, //é—®é¢˜ç¼–å· \u0026#34;text\u0026#34;: \u0026#34;My brother and his wife are in prison for carrying out a large fraud scheme. Their 7 and 8 year old children have been living with me for the last 4 years. I want to become their Special Guardian to look after them permanently How long will it be before I hear back from the court?\u0026#34; }, //å…·ä½“é—®é¢˜ \u0026#34;judged_chunks\u0026#34;: [ { \u0026#34;chunk\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;86-41\u0026#34;, //é»„é‡‘åŒ¹é…æ®µè½ \u0026#34;text\u0026#34;: \u0026#34;\u0026lt;p\u0026gt;Within 10 days of receiving your application the court will send you a case number and a date for a meeting to set out:\u0026lt;/p\u0026gt;\u0026#34; }, \u0026#34;judgement\u0026#34;: 1, //ä¸çŸ¥é“ä»€ä¹ˆæ„æ€ï¼Œå–å€¼åº”è¯¥å…¨éƒ¨ä¸º1 \u0026#34;belonging_doc\u0026#34;: { \u0026#34;id\u0026#34;: \u0026#34;86\u0026#34;, \u0026#34;title\u0026#34;: \u0026#34;Become a special guardian\u0026#34;, \u0026#34;chunks\u0026#34;: [ //chunksæ˜¯è¯¥é—®é¢˜ç›¸å…³çš„æ³•æ¡ç•Œé¢çš„æ–‡æœ¬åˆ†å‰²åçš„ç»“æœã€‚ä¸€æ®µè¯è®¾ç½®ä¸ºä¸€ä¸ªchunk { \u0026#34;id\u0026#34;: \u0026#34;86-0\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;What is a special guardian\u0026#34; }, { \u0026#34;id\u0026#34;: \u0026#34;86-1\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;You can apply to be a childâ€™s special guardian when they cannot live with their birth parents and adoption is not right for them.\u0026#34; }, ... { \u0026#34;id\u0026#34;: \u0026#34;86-62\u0026#34;, \u0026#34;text\u0026#34;: \u0026#34;You might be able to get a special guardian allowance from the childrenâ€™s services department of your local council.\u0026#34; } ], \u0026#34;candidate_chunk_ids\u0026#34;: [ //æŠŠchunkidé‡æ–°æ’äº†ä¸€éï¼Œä¸çŸ¥é“æŒ‰ç…§ä»€ä¹ˆè¦æ±‚æ’çš„ \u0026#34;86-6\u0026#34;, \u0026#34;86-52\u0026#34;, ... \u0026#34;86-57\u0026#34;, \u0026#34;86-14\u0026#34;, \u0026#34;86-2\u0026#34;, \u0026#34;86-16\u0026#34; ] } } ] } prepending_titles/bm25/CQA\nqueryæ˜¯ä¸€ä¸ªå­—å…¸ï¼ŒåŒ…æ‹¬idï¼Œcontentã€‚DAPRæŠŠæ¯å¥è¯æ‰€å±æ–‡ç« çš„æ ‡é¢˜ä¹Ÿä½œä¸ºä¸€ä¸ªtitleå­—æ®µåŠ è¿›å»äº†ã€‚æ¯”å¦‚{\u0026quot;id\u0026quot;: \u0026quot;0-0\u0026quot;, \u0026quot;title\u0026quot;: \u0026quot;Child Tax Credit\u0026quot;, \u0026quot;contents\u0026quot;: \u0026quot;Overview\u0026quot;}\nè¿™é‡Œçš„bm25ä½¿ç”¨äº†pyseriniï¼Œæ˜¯ç”¨javaå®ç°çš„ã€‚ç„¶åæŠŠcorpuså­—å…¸ä¼ ç»™javaæ¥å£å»indexã€‚åº”è¯¥æ˜¯æŠŠtitleå’Œcontentå¹¶ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚è€Œä¸”æ˜¯ä»¥ä¸€å¥è¯è€Œä¸æ˜¯ä¸€ç¯‡æ–‡ç« è¿›è¡Œçš„indexã€‚\né‚£å¯¹äºNQè¿™ç§æ²¡æœ‰æ–‡ç« æ ‡é¢˜ï¼Œåªæœ‰é›¶æ•£æ®µè½çš„æ€ä¹ˆprepending_titleså‘¢ï¼Ÿ\n","permalink":"https://Rook1eChan.github.io/posts/dapr-a-benchmark-on-document-aware-passage-retrieval/","summary":"\u003ch2 id=\"1motivation\"\u003e1.Motivation\u003c/h2\u003e\n\u003cp\u003eç°æœ‰çš„ç¥ç»æ£€ç´¢ï¼ˆneural retrievalï¼‰çš„æ–¹æ³•ä¸»è¦é›†ä¸­åœ¨çŸ­æ–‡æœ¬æ’åºï¼Œåœ¨é•¿ç¯‡æ–‡ç« ä¸­åšæ£€ç´¢æ•ˆæœå¹¶ä¸å¥½ï¼ˆç”±äºè‡ªæ³¨æ„åŠ›æœºåˆ¶tokenæ•°é‡çš„é™åˆ¶ï¼›æˆ–è€…è¿”å›çš„æ–‡æ¡£è¿‡é•¿ï¼Œä¸ä¾¿äºç”¨æˆ·ä½¿ç”¨ï¼‰ã€‚å¦å¤–ï¼Œä½œè€…å‘ç°åœ¨å…ˆè¿›æ£€ç´¢å™¨çš„æ£€ç´¢é”™è¯¯ä¸­ï¼ŒåŠæ•°é”™è¯¯ä¸ç¼ºå°‘ä¸Šä¸‹æ–‡æœ‰å…³ã€‚\u003c/p\u003e\n\u003cp\u003eæ¯”å¦‚ï¼šåœ¨Aå‰§åœºä¸­æ¼”å‡ºè¿‡çš„æ¼”å‘˜æœ‰å“ªäº›ï¼Ÿå¦‚æœåªæ£€ç´¢å…³é”®å­—â€œAå‰§åœºâ€ï¼Œå¯èƒ½æ‰¾ä¸åˆ°ç­”æ¡ˆï¼Œéœ€è¦ç»“åˆä¸Šä¸‹æ–‡æ‰¾åˆ°â€œâ€¦â€¦åœ¨è¿™é‡Œæ¼”å‡ºè¿‡â€¦â€¦â€çš„å†…å®¹æ‰æ˜¯çœŸæ­£ç­”æ¡ˆã€‚\u003c/p\u003e\n\u003cp\u003eå› æ­¤ï¼Œä½œè€…é’ˆå¯¹ä¸Šä¸‹æ–‡å¼ºå…³è”çš„ä»»åŠ¡å»ºç«‹äº†ä¸€ä¸ªæ•°æ®é›†ï¼Œä½¿ç”¨ä¸¤ç±»æ–¹æ³•ï¼ˆhybrid retrieval with BM25ã€ contextualized passage representationsï¼‰è¿›è¡Œå®éªŒï¼Œå¹¶è¯¦ç»†è§£é‡Šäº†å®éªŒç»“æœã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch2 id=\"2related-work\"\u003e2.Related work\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eDocument Question Answeringï¼ˆDocQAï¼‰\u003c/strong\u003eï¼šè¦æ±‚æ¨¡å‹å›ç­”å…³äºè¾“å…¥æ–‡æ¡£çš„é—®é¢˜ï¼Œé€šå¸¸å‡è®¾æ–‡æ¡£åœ¨æé—®å‰å°±å·²ç»™å‡ºã€‚æœ¬æ–‡æå‡ºçš„(Document-Awarepassage Retrieval, DAPR)ä¸DocQAç±»ä¼¼ï¼ŒåŒºåˆ«åœ¨äºDAPRå¸Œæœ›ç”¨æˆ·æé—®æ—¶ä¸çŸ¥é“ç›®æ ‡æ–‡æ¡£ï¼Œç”±æ¨¡å‹æ¥å¯»æ‰¾ç›®æ ‡æ–‡æ¡£ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eLong-document retrievalï¼ˆé•¿æ–‡æ¡£æ£€ç´¢ï¼‰\u003c/strong\u003eï¼šå¯¹äºé•¿æ–‡æ¡£æ£€ç´¢æœ‰ä¸€äº›ç®€å•çš„æ–¹æ³•ï¼šå°†æ–‡æ¡£ä¸­æ®µè½ç›¸å…³æ€§çš„æœ€å¤§å€¼ä½œä¸ºæ–‡æ¡£çš„ç›¸å…³æ€§ï¼ˆMaxPï¼‰ï¼›ä»…ç¼–ç æ–‡æ¡£ä¸­çš„ç¬¬ä¸€ä¸ªæ®µè½ï¼ˆFirstPï¼‰â€¦â€¦ä¸DAPRç›¸æ¯”ï¼Œæ‰€æœ‰è¿™äº›å…ˆå‰çš„å·¥ä½œéƒ½æ²¡æœ‰ç ”ç©¶å¦‚ä½•åœ¨è€ƒè™‘æ–‡æ¡£ä¸Šä¸‹æ–‡çš„æƒ…å†µä¸‹æ£€ç´¢æ®µè½ã€‚\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHybrid retrievalï¼ˆæ··åˆæ£€ç´¢ï¼‰\u003c/strong\u003eï¼šå¯¹äºä¸€ä¸ªæŸ¥è¯¢ä½¿ç”¨å¤šä¸ªæ£€ç´¢ç³»ç»Ÿï¼ˆå¸¸å¸¸æ˜¯BM25+ç¥ç»æ£€ç´¢ï¼‰\n\u003cul\u003e\n\u003cli\u003erank fusionï¼ˆæ’åèåˆï¼‰â€”â€”é€šè¿‡å‡¸ç»„åˆã€äº’é€†æ’åç­‰æ–¹æ³•å°†ä¸åŒæ£€ç´¢ç³»ç»Ÿçš„ä¸ªä½“æ’ååˆå¹¶ä¸ºä¸€ä¸ªã€‚\u003c/li\u003e\n\u003cli\u003ehierarchical retrievalï¼ˆå±‚æ¬¡æ£€ç´¢ï¼‰â€”â€”é¦–å…ˆæ£€ç´¢æ–‡æ¡£ï¼Œç„¶åä»è¿™äº›æ–‡æ¡£ä¸­æ£€ç´¢æ®µè½ã€‚åªé€‚ç”¨äºæ®µè½æœ¬èº«è¶³ä»¥å¯¹æŸ¥è¯¢åšå‡ºå“åº”çš„æƒ…å†µã€‚\u003c/li\u003e\n\u003cli\u003eæœ¬æ–‡æ¢è®¨äº†æ®µè½æ’åå’Œæ–‡æ¡£æ’åç»“åˆçš„æœ‰æ•ˆæ€§ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRelation to pre-training tasksï¼ˆå’Œé¢„è®­ç»ƒä»»åŠ¡çš„å…³ç³»ï¼‰\u003c/strong\u003eï¼šæœ‰çš„ç ”ç©¶åœ¨é¢„è®­ç»ƒä¸­åŠ å…¥ä¸Šä¸‹æ–‡ã€‚ä½†æ¨ç†æ—¶ä»ç„¶åªå…³æ³¨ç‹¬ç«‹çš„æ®µè½ã€‚\u003c/li\u003e\n\u003cli\u003eè¡¥å……ï¼š\n\u003cul\u003e\n\u003cli\u003eNQï¼šè°·æ­Œçš„ä¸€ä¸ªé—®ç­”æ•°æ®é›†\u003c/li\u003e\n\u003cli\u003eNDCGï¼šè¯„ä»·æ£€ç´¢åºåˆ—çš„ç›¸å…³æ€§å’Œä½ç½®\u003c/li\u003e\n\u003cli\u003eå…±æŒ‡ä¿¡æ¯ï¼šæè¿°æ–‡æœ¬ä¸­ä¸åŒè¡¨è¾¾å¼æŒ‡å‘åŒä¸€å®ä½“æˆ–æ¦‚å¿µçš„è¯­è¨€ç°è±¡ï¼Œå¦‚*â€œç›ä¸½æ‰“å¼€äº†é—¨ï¼Œ\u003cstrong\u003eå¥¹\u003c/strong\u003eéšåæ‹¿èµ·åŒ…ã€‚â€* â†’ â€œå¥¹â€ä¸â€œç›ä¸½â€å…±æŒ‡åŒä¸€äººã€‚\u003c/li\u003e\n\u003cli\u003eå…±æŒ‡æ¶ˆè§£ï¼ˆCoreference Resolutionï¼‰ï¼šè‡ªåŠ¨è¯†åˆ«æ–‡æœ¬ä¸­æ‰€æœ‰æŒ‡å‘åŒä¸€å®ä½“çš„è¡¨è¾¾å¼å¹¶åˆ†ç»„ã€‚\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cBR\u003e\n\u003ch2 id=\"3method\"\u003e3.Method\u003c/h2\u003e\n\u003cp\u003eDAPRä»»åŠ¡è¦æ±‚ç³»ç»Ÿæå–+æ’åºã€‚ç»™å‡ºæ®µè½é›†åˆ$C$ï¼Œæ–‡æ¡£é›†åˆ$D$ï¼Œå¯¹äºæŸ¥è¯¢é›†åˆ$q \\in Q$ï¼Œæ£€ç´¢ç³»ç»Ÿ$s$åº”è¯¥æå–å‡ºæœ€å¥½çš„$K$ä¸ªæ®µè½é›†åˆ$R$ã€‚\u003c/p\u003e\n\u003ch3 id=\"31nq-hard\"\u003e3.1NQ-Hard\u003c/h3\u003e\n\u003cp\u003eå¯¹SOTAçš„æ£€ç´¢å™¨ï¼ˆDRAGON+,SPLADEv2, and ColBERTv2)ä½¿ç”¨NQæ•°æ®é›†ï¼Œå‘ç°ä¸€åŠçš„é”™è¯¯æ¥è‡ªäºä¸äº†è§£ä¸Šä¸‹æ–‡ã€‚å°†è¿™äº›æ•°æ®å‘½åä¸º\u003cstrong\u003eNQ-hard\u003c/strong\u003eï¼Œå¹¶åˆ†ä¸º4ç±»ï¼š\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eå…±æŒ‡æ¶ˆè§£ï¼ˆCRï¼‰ï¼šå…³é”®çš„å…±æŒ‡ä¿¡æ¯éœ€è¦é€šè¿‡ç‰¹å®šæ–‡æ¡£ä¸Šä¸‹æ–‡æ¥è§£æï¼›\u003c/li\u003e\n\u003cli\u003eä¸»è¦ä¸»é¢˜ï¼ˆMTï¼‰ï¼šåªæœ‰äº†è§£æ–‡æ¡£çš„èƒŒæ™¯ä¸»é¢˜ï¼ˆé€šå¸¸æ˜¯æ ‡é¢˜ï¼‰ï¼Œæ‰èƒ½å›ç­”æŸ¥è¯¢ï¼›\u003c/li\u003e\n\u003cli\u003eå¤šè·³æ¨ç†ï¼ˆMHRï¼‰ï¼šè¿æ¥æŸ¥è¯¢å’ŒæŸ¥è¯¢ç›¸å…³æ®µè½ä¸­çš„å®ä½“çš„æ¨ç†è·¯å¾„åŒ…æ‹¬æ–‡æ¡£ä¸Šä¸‹æ–‡ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼›\u003c/li\u003e\n\u003cli\u003eç¼©å†™ï¼ˆACï¼‰ï¼šåœ¨ç›¸å…³æ®µè½ï¼ˆæˆ–æŸ¥è¯¢ï¼‰ä¸­å‡ºç°ä¸€ä¸ªç¼©å†™ï¼Œè¯¥ç¼©å†™å¯¹åº”äºæŸ¥è¯¢ï¼ˆæˆ–ç›¸å…³æ®µè½ï¼‰ä¸­çš„å…¨ç§°ï¼Œæ–‡æ¡£ä¸Šä¸‹æ–‡è§£é‡Šäº†è¿™ç§æ˜ å°„ï¼›\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cimg alt=\"nqques\" loading=\"lazy\" src=\"/DAPR/NQques.png\"\u003e\u003c/p\u003e\n\u003cBR\u003e\n\u003ch3 id=\"32datasets\"\u003e3.2Datasets\u003c/h3\u003e\n\u003cp\u003eMS MARCOã€Natural Questionsã€MIRACLã€Genomics å’Œ ConditionalQAï¼ˆå…·ä½“å¤„ç†æ–¹å¼è§é™„å½•Aï¼‰æœ‰è¯­æ–™åº“çš„ç›´æ¥ç”¨ï¼Œæ²¡æœ‰çš„æŠŠé»„é‡‘æ®µè½æ–‡æœ¬æ”¶é›†èµ·æ¥å½“è¯­æ–™åº“ã€‚ï¼ˆä¹Ÿæ˜¯å¾ˆç¥å¥‡ï¼‰\u003c/p\u003e\n\u003cBR\u003e\n\u003ch3 id=\"33evaluation\"\u003e3.3Evaluation\u003c/h3\u003e\n\u003cp\u003eä½¿ç”¨\u003cstrong\u003enDCG@10\u003c/strong\u003eå’Œrecall@100åšæŒ‡æ ‡ã€‚\u003c/p\u003e\n\u003cp\u003eå°†binary/3-scaleè½¬æ¢ä¸º0-1/0-1-2ï¼Œç„¶åä½¿ç”¨pytrec_evalè®¡ç®—æŒ‡æ ‡ã€‚\u003c/p\u003e\n\u003cp\u003eè€ƒè™‘åˆ°ç°å®ä¸–ç•Œä¸­çš„æ£€ç´¢ç³»ç»Ÿå¤šç”¨äºé›¶æ ·æœ¬ã€è·¨é¢†åŸŸçš„æƒ…æ™¯ï¼Œæœ¬æ–‡è¿›è¡Œäº†ä¸€é¡¹æµ‹è¯•ï¼šåœ¨MS MARCOè®­ç»ƒé›†è®­ç»ƒï¼Œç„¶ååœ¨MS MARCOæµ‹è¯•é›†æµ‹è¯•ï¼Œä½œä¸ºåŸŸå†…è¯„ä¼°ï¼›åœ¨å…¶å®ƒå››ä¸ªæ•°æ®é›†ä¸Šæµ‹è¯•ï¼Œä½œä¸ºåŸŸå¤–è¯„ä¼°ã€‚\u003c/p\u003e\n\u003cBR\u003e\n\u003ch2 id=\"4experiments\"\u003e4.Experiments\u003c/h2\u003e\n\u003ch3 id=\"41åŸºç¡€æ£€ç´¢å™¨\"\u003e4.1åŸºç¡€æ£€ç´¢å™¨\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eBM25ï¼ˆä½¿ç”¨PySeriniçš„é»˜è®¤é…ç½®ï¼‰\u003c/li\u003e\n\u003cli\u003eneural retrieversï¼šDRAGON+ã€SPLADEv2ã€ColBERTv2ï¼ˆåœ¨MS MARCOä¸Šè®­ç»ƒï¼‰\u003c/li\u003e\n\u003c/ul\u003e\n\u003cBR\u003e\n\u003ch3 id=\"42ä¸¤ç§å°†ä¸Šä¸‹æ–‡å¼•å…¥ç¥ç»æ£€ç´¢å™¨çš„æ–¹æ³•\"\u003e4.2ä¸¤ç§å°†ä¸Šä¸‹æ–‡å¼•å…¥ç¥ç»æ£€ç´¢å™¨çš„æ–¹æ³•\u003c/h3\u003e\n\u003ch4 id=\"421åŠ å…¥bm25çš„æ··åˆæ£€ç´¢\"\u003e4.2.1åŠ å…¥BM25çš„æ··åˆæ£€ç´¢\u003c/h4\u003e\n\u003cp\u003e\u003cstrong\u003eï¼ˆ1ï¼‰Rank fusionèåˆæ£€ç´¢\u003c/strong\u003e\u003c/p\u003e","title":"DAPR A Benchmark on Document-Aware Passage Retrieval"},{"content":"githubæä¾›ç»™æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªç½‘å€ï¼Œç”¨æˆ·å¯ä»¥å»ºç«‹è‡ªå·±çš„é™æ€ç½‘ç«™ã€‚\nä¸€ã€Hugo hugoæ˜¯ä¸€ä¸ªå¿«é€Ÿæ­å»ºç½‘ç«™çš„å·¥å…·ï¼Œç”±goè¯­è¨€ç¼–å†™ã€‚\n1.å®‰è£…hugo åˆ°hugoçš„githubæ ‡ç­¾é¡µTags Â· gohugoio/hugoé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ã€‚æ¯”å¦‚hugo_extended_withdeploy_0.147.0_windows-amd64.zipã€‚\nè§£å‹åï¼Œåœ¨æ ¹ç›®å½•æ‰“å¼€cmdï¼Œè¾“å…¥\nhugo new site YourSiteName ä¸ºä½ çš„ç½‘ç«™å»ºç«‹æ–‡ä»¶å¤¹ã€‚YourSiteNameæ›´æ”¹ä¸ºä½ çš„ç½‘ç«™çš„åå­—ã€‚ æ ¹ç›®å½•ä¼šå‡ºç°YourSiteNameæ–‡ä»¶å¤¹ã€‚\n3.å°†æ ¹ç›®å½•çš„hugo.exeå¤åˆ¶åˆ°YourSiteNameé‡Œã€‚ åœ¨YourSiteNameæ–‡ä»¶å¤¹é‡Œæ‰“å¼€cmdï¼Œè¾“å…¥\nhugo server -D ä¼šè¿”å›å¦‚ä¸‹ä¿¡æ¯ï¼š\n| EN -------------------+----- Pages | 11 Paginator pages | 0 Non-page files | 0 Static files | 0 Processed images | 0 Aliases | 2 Cleaned | 0 Built in 79 ms Environment: \u0026#34;development\u0026#34; Serving pages from disk Running in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender Web Server is available at http://localhost:1313/ (bind address 127.0.0.1) Press Ctrl+C to stop åœ¨æµè§ˆå™¨ä¸­è¾“å…¥http://localhost:1313/ï¼Œæ˜¾ç¤ºPage Not Foundï¼Œè¯´æ˜æœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯æ­¤æ—¶ç½‘ç«™è¿˜æ²¡æœ‰é¡µé¢ã€‚\n2.é€‰æ‹©ç½‘ç«™ä¸»é¢˜ åœ¨Hugo Themesé€‰æ‹©ä½ æƒ³è¦çš„themeï¼Œç„¶åæ ¹æ®themeçš„å®‰è£…è¯´æ˜æ“ä½œå°±è¡Œäº†ã€‚ åœ¨æ­¤ä»¥PaperModä¸ºä¾‹ã€‚å®˜æ–¹å®‰è£…æ•™ç¨‹ç•Œé¢ï¼šInstallation Â· adityatelange/hugo-PaperMod Wiki\nå®‰è£…PaperModï¼Œå¯ä»¥ï¼š\nåœ¨ä½ çš„ç½‘ç«™çš„themeæ–‡ä»¶å¤¹ä½¿ç”¨ï¼š\ngit clone https://github.com/adityatelange/hugo-PaperMod themes/PaperMod --depth=1 æˆ–è€…ï¼Œåœ¨Tags Â· adityatelange/hugo-PaperModé€‰æ‹©ç‰ˆæœ¬ï¼Œä¸‹è½½zipå¹¶è§£å‹åˆ°themeæ–‡ä»¶å¤¹ã€‚\nåœ¨ä½ çš„ç½‘ç«™çš„æ ¹æ–‡ä»¶å¤¹é‡Œçš„hugo.ymlæ–‡ä»¶é‡Œæ·»åŠ \ntheme: [\u0026#34;PaperMod\u0026#34;] 3.æ–°å»ºä¸€ä¸ªç¬”è®° åœ¨ä½ çš„ç½‘ç«™çš„æ ¹é¡µé¢ä¸‹ä½¿ç”¨cmdï¼š\nhugo new posts/first.md YourSiteName/content/posts/first.md å°±ä¼šå»ºç«‹ï¼Œæ‰“å¼€åï¼Œå†…å®¹ä¸ºï¼š\n--- date: \u0026#39;2025-05-01T18:41:05+08:00\u0026#39; draft: true title: \u0026#39;first\u0026#39; --- è¿™ä¸‰æ¡çŸ­çº¿å›´èµ·æ¥çš„æ˜¯è¯¥ç¬”è®°çš„å±æ€§ã€‚ç¬¬ä¸€è¡Œæ˜¯åˆ›å»ºæ—¶é—´ï¼›ç¬¬äºŒè¡Œä¸ºfalseæ—¶è¡¨ç¤ºè‰ç¨¿çŠ¶æ€ï¼Œæ”¹ä¸ºtrueæ‰ä¼šæ˜¾ç¤ºåœ¨ç½‘ç«™ä¸­ï¼›ç¬¬ä¸‰è¡Œä¸ºè¯¥ç¬”è®°çš„æ ‡é¢˜ã€‚ä¹‹åè¿˜å¯ä»¥æ·»åŠ å…¶ä»–çš„å±æ€§ã€‚\næ‰“å¼€http://localhost:1313/ï¼Œåˆ·æ–°åå°±èƒ½çœ‹åˆ°åˆšæ‰åˆ›å»ºçš„ç¬”è®°äº†ã€‚å¦‚æœæ²¡æœ‰å°±é‡æ–°hugo server -Dã€‚\nä½ å¯ä»¥é€šè¿‡cmdï¼Œæˆ–è€…ç›´æ¥æ–°å»ºmdæ–‡ä»¶æ¥æ·»åŠ ç¬”è®°ã€‚\n4.å®šåˆ¶ä¸ªäººåšå®¢ 4.1æ·»åŠ èœå• åœ¨hugo.ymlæ–‡ä»¶ä¸­æ·»åŠ ï¼š\nmenu: main: - identifier: categories name: categories url: /categories/ weight: 10 - identifier: tags name: tags url: /tags/ weight: 20 - identifier: example name: example.org url: https://example.org weight: 30 åœ¨ç½‘ç«™çš„å³ä¸Šè§’å°±èƒ½çœ‹åˆ°èœå•äº†\n4.2ç½®é¡¶å¸–å­ åœ¨ç¬”è®°çš„mdæ–‡ä»¶é‡Œæ·»åŠ ï¼š\n--- ... weight: 1 --- weightä¸ºæ­£æ•´æ•°ï¼Œè¡¨ç¤ºç¬”è®°é¡ºåºã€‚æ”¾åˆ°æœ€é¡¶ä¸Šå°±è®¾ä¸º1ã€‚\n4.3hugo.yamlçš„å¯é€‰é¡¹ hugo.yamlæ˜¯ç½‘ç«™æ ¹ç›®å½•çš„é…ç½®æ–‡ä»¶\n# åŸºç¡€é…ç½® baseURL: https://Rook1eChan.github.io # ç½‘ç«™éƒ¨ç½²çš„æ ¹URLï¼ˆGitHub Pagesåœ°å€ï¼‰ languageCode: zh-cn # ç½‘ç«™è¯­è¨€ä»£ç ï¼ˆç®€ä½“ä¸­æ–‡ï¼‰ title: Chan\u0026#39;s Blog # ç½‘ç«™æ ‡é¢˜ï¼ˆ theme: [\u0026#34;PaperMod\u0026#34;] # ä½¿ç”¨çš„ä¸»é¢˜ï¼ˆHugo PaperModä¸»é¢˜ï¼‰ buildDrafts: false # æ„å»ºæ—¶æ˜¯å¦åŒ…å«è‰ç¨¿ï¼ˆfalseè¡¨ç¤ºä¸æ„å»ºè‰ç¨¿ï¼‰ # ä¸»é¢˜å‚æ•°é…ç½® params: # å¸ƒå±€æ§åˆ¶ ShowBreadCrumbs: true # æ˜¾ç¤ºé¢åŒ…å±‘å¯¼èˆª ShowReadingTime: false # éšè—æ–‡ç« é˜…è¯»æ—¶é—´ ShowShareButtons: false # éšè—åˆ†äº«æŒ‰é’® ShowCodeCopyButtons: true # æ˜¾ç¤ºä»£ç å¤åˆ¶æŒ‰é’® # æœç´¢åŠŸèƒ½é…ç½®ï¼ˆä½¿ç”¨Fuse.jsï¼‰ fuseOpts: isCaseSensitive: false # æœç´¢ä¸åŒºåˆ†å¤§å°å†™ shouldSort: true # å¯¹æœç´¢ç»“æœæ’åº location: 0 # åŒ¹é…ä½ç½®æƒé‡ distance: 1000 # åŒ¹é…è·ç¦»é˜ˆå€¼ threshold: 0.4 # åŒ¹é…ç›¸ä¼¼åº¦é˜ˆå€¼ minMatchCharLength: 0 # æœ€å°åŒ¹é…å­—ç¬¦é•¿åº¦ keys: [\u0026#34;title\u0026#34;, \u0026#34;permalink\u0026#34;, \u0026#34;summary\u0026#34;, \u0026#34;content\u0026#34;] # æœç´¢çš„å­—æ®µèŒƒå›´ # é¦–é¡µæ¬¢è¿ä¿¡æ¯ homeInfoParams: Title: \u0026#34;ä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ°æˆ‘çš„åšå®¢ \\U0001F44B\u0026#34; # æ ‡é¢˜ Content: \u0026#34;welcome!\u0026#34; # å†…å®¹ # ç¤¾äº¤åª’ä½“å›¾æ ‡ socialIcons: - name: github # GitHubå›¾æ ‡ url: \u0026#34;https://github.com/Rook1eChan\u0026#34; # GitHubä¸ªäººä¸»é¡µ # å…¶ä»–ç¤¾äº¤å¹³å°ï¼ˆå·²æ³¨é‡Šæ‰ï¼‰ # - name: twitter # url: \u0026#34;twitter.com\u0026#34; # ç½‘ç«™å›¾æ ‡é…ç½® assets: favicon: \u0026#34;/apple-touch-icon.png\u0026#34; # faviconè·¯å¾„ # å¯¼èˆªæ å›¾æ ‡ label: icon: /apple-touch-icon.png # å¯¼èˆªæ å›¾æ ‡è·¯å¾„ iconHeight: 35 # å›¾æ ‡é«˜åº¦ï¼ˆåƒç´ ï¼‰ # è¾“å‡ºæ ¼å¼é…ç½® outputs: home: - HTML # ç”ŸæˆHTMLé¡µé¢ - RSS # ç”ŸæˆRSSè®¢é˜… - JSON # ç”ŸæˆJSONæ•°æ®ï¼ˆå¯èƒ½ç”¨äºæœç´¢ï¼‰ # å†…å®¹æ ‡è®°é…ç½® markup: highlight: codeFences: true # å¯ç”¨ä»£ç å—é«˜äº® guessSyntax: true # è‡ªåŠ¨æ£€æµ‹ä»£ç è¯­è¨€ hl_Lines: \u0026#39;\u0026#39; # é«˜äº®æŒ‡å®šè¡Œï¼ˆæœªè®¾ç½®ï¼‰ lineNos: false # ä¸æ˜¾ç¤ºè¡Œå·ï¼ˆä¸ä¸‹é¢é…ç½®å†²çªï¼‰ lineNumbersInTable: true # ç”¨è¡¨æ ¼å¸ƒå±€è¡Œå·ï¼ˆé¿å…å¤åˆ¶æ—¶å¸¦è¡Œå·ï¼‰ noClasses: false # ä½¿ç”¨CSSç±»ï¼ˆå¿…é¡»ä¸ºfalseï¼‰ style: github # ä»£ç é«˜äº®ä¸»é¢˜ï¼ˆgithubã€monokaiã€solarized-darkã€draculaï¼‰ tabWidth: 4 # ä»£ç ç¼©è¿›ç©ºæ ¼æ•° goldmark: renderer: unsafe: true # å…è®¸æ¸²æŸ“åŸå§‹HTML/LaTeX math: true # æ”¯æŒæ•°å­¦å…¬å¼ # å¯¼èˆªèœå•é…ç½® menu: main: # å·²æ³¨é‡Šçš„åˆ†ç±»å’Œæ ‡ç­¾èœå• # - identifier: categories # name: categories # url: /categories/ # weight: 10 - identifier: search # æœç´¢èœå•é¡¹ name: search # èœå•æ˜¾ç¤ºåç§°ï¼ˆè‹±æ–‡ï¼Œä¸æ ‡è¯†ä¸ä¸€è‡´ï¼‰ url: /search/ # æœç´¢é¡µé¢è·¯å¾„ weight: 25 # èœå•é¡¹æ’åºæƒé‡ baseURL: ç½‘ç«™çš„åŸºç¡€URLï¼Œè¿™é‡Œæ˜¯ \u0026ldquo;https://Rook1eChan.github.io\u0026rdquo;ï¼Œå¿…é¡»è¦å†™ï¼Œä¸ç„¶å¯¼èˆªå‡ºç°é”™è¯¯ã€‚ä¸è¦å†™example.com\nlanguageCode: ç½‘ç«™è¯­è¨€ä»£ç ï¼Œ\u0026ldquo;zh-cn\u0026rdquo; è¡¨ç¤ºç®€ä½“ä¸­æ–‡\ntitle: ç½‘ç«™æ ‡é¢˜\ntheme: ä½¿ç”¨çš„ä¸»é¢˜\nbuildDrafts: false è¡¨ç¤ºä¸è®¾ç½®è‰ç¨¿æ–‡ç« ï¼Œæ‰€æœ‰æ–‡ç« éƒ½ä¼šè¢«å±•ç¤º\næ˜¾ç¤ºç›¸å…³:\nShowBreadCrumbs: true æ˜¾ç¤ºé¢åŒ…å±‘å¯¼èˆª ShowReadingTime: false ä¸æ˜¾ç¤ºæ–‡ç« é˜…è¯»æ—¶é—´ ShowShareButtons: false ä¸æ˜¾ç¤ºåˆ†äº«æŒ‰é’® ShowCodeCopyButtons: true æ˜¾ç¤ºä»£ç å—çš„å¤åˆ¶æŒ‰é’® æœç´¢åŠŸèƒ½ (fuseOpts):\né…ç½®äº†åŸºäº Fuse.js çš„æœç´¢åŠŸèƒ½å‚æ•°ï¼ŒåŒ…æ‹¬ä¸åŒºåˆ†å¤§å°å†™ã€æ’åºæ–¹å¼ç­‰ ä¸»é¡µä¿¡æ¯ (homeInfoParams):\nTitleï¼šæ ‡é¢˜ Contentï¼šå†…å®¹ ä¸»é¡µç¤¾äº¤åª’ä½“å›¾æ ‡ (socialIcons):\nåªå¯ç”¨äº† GitHub é“¾æ¥ï¼ŒæŒ‡å‘ \u0026ldquo;https://github.com/Rook1eChan\u0026quot; Twitter å’Œ Facebook é“¾æ¥ èµ„æº (assets):\nè®¾ç½®äº†ç½‘ç«™å›¾æ ‡ (favicon) ä¸º \u0026ldquo;/apple-touch-icon.png\u0026rdquo; æ ‡ç­¾ (label):\nè®¾ç½®äº†å›¾æ ‡åŠå…¶é«˜åº¦ æŒ‡å®šäº†ä¸»é¡µçš„è¾“å‡ºæ ¼å¼ä¸º HTMLã€RSS å’Œ JSON\nä¸»èœå• (main) ä¸­åªé…ç½®äº†ä¸€ä¸ª \u0026ldquo;æœç´¢\u0026rdquo; é¡¹:\næ ‡è¯†ç¬¦: \u0026ldquo;æœç´¢\u0026rdquo; åç§°: \u0026ldquo;search\u0026rdquo; URL: \u0026ldquo;/search/\u0026rdquo; æƒé‡: 25 (ç”¨äºèœå•é¡¹æ’åº) åˆ†ç±»å’Œæ ‡ç­¾èœå•é¡¹è‡ªé€‰\n4.4æ›´æ”¹å­—ä½“ åœ¨ Hugo é¡¹ç›®ä¸‹æ–°å»º assets/css/extended/custom.css ï¼Œå†™å…¥\n/* å…¨å±€æ­£æ–‡å­—ä½“ - Noto Sans Simplified Chinese */ body, article { font-family: \u0026#34;Noto Sans SC\u0026#34;, sans-serif; } /* ä»£ç å—å­—ä½“ - ä¿æŒç­‰å®½å­—ä½“ï¼ˆå¦‚ JetBrains Mono æˆ–ç³»ç»Ÿé»˜è®¤ï¼‰ */ pre, code { font-family: \u0026#34;JetBrains Mono\u0026#34;, monospace; font-size: 0.9em; /* å¯é€‰ï¼šè°ƒæ•´ä»£ç å­—ä½“å¤§å° */ } åœ¨ themes/PaperMod/layouts/partials/head.html ä¸­æ·»åŠ  Google Fonts çš„é“¾æ¥\n\u0026lt;link href=\u0026#34;https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700\u0026amp;family=JetBrains+Mono\u0026amp;display=swap\u0026#34; rel=\u0026#34;stylesheet\u0026#34;\u0026gt; å¯ä»¥å»Browse Fonts - Google Fontsé€‰å­—ä½“ã€‚ä»£ç æ€ä¹ˆå†™é—®AIã€‚\n4.5å¯ç”¨æ•°å­¦å…¬å¼ ä»¥ä¸‹æ–¹æ³•å¯ä»¥ä½¿ç”¨$...$è¡¨ç¤ºè¡Œå†…å…¬å¼ï¼Œ$$...$$è¡¨ç¤ºè¡Œé—´å…¬å¼\nåœ¨themes\\PaperMod\\layouts\\partials\\math.html\u0026quot; é‡ŒåŠ ä¸Šï¼š\n{{ if .Page.Params.math }} \u0026lt;script\u0026gt; MathJax = { tex: { inlineMath: [[\u0026#39;$\u0026#39;, \u0026#39;$\u0026#39;], [\u0026#39;\\\\(\u0026#39;, \u0026#39;\\\\)\u0026#39;]], // è¡Œå†…å…¬å¼ï¼š$...$ æˆ– \\(...\\) displayMath: [[\u0026#39;$$\u0026#39;, \u0026#39;$$\u0026#39;], [\u0026#39;\\\\[\u0026#39;, \u0026#39;\\\\]\u0026#39;]] // å—çº§å…¬å¼ï¼š$$...$$ æˆ– \\[...\\] } }; \u0026lt;/script\u0026gt; \u0026lt;script src=\u0026#34;https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js\u0026#34;\u0026gt;\u0026lt;/script\u0026gt; {{ end }} åœ¨themes\\PaperMod\\layouts\\_default\\baseof.html\u0026quot; é‡ŒåŠ ä¸Šï¼š\n\u0026lt;head\u0026gt; ... {{ if .Param \u0026#34;math\u0026#34; }} {{ partialCached \u0026#34;math.html\u0026#34; . }} {{ end }} ... \u0026lt;/head\u0026gt; åœ¨hugo.yamlé‡ŒåŠ ä¸Šï¼š\n# å†…å®¹æ ‡è®°é…ç½® markup: goldmark: renderer: unsafe: true # å…è®¸åŸå§‹ HTMLï¼ˆæŸäº›æ•°å­¦å…¬å¼éœ€è¦ï¼‰ extensions: passthrough: enable: true delimiters: block: - [\u0026#39;$$\u0026#39;, \u0026#39;$$\u0026#39;] # å—çº§å…¬å¼ï¼š$$...$$ - [\u0026#39;\\\\[\u0026#39;, \u0026#39;\\\\]\u0026#39;] # æˆ–è€… \\[...\\] inline: - [\u0026#39;$\u0026#39;, \u0026#39;$\u0026#39;] # è¡Œå†…å…¬å¼ï¼š$...$ - [\u0026#39;\\\\(\u0026#39;, \u0026#39;\\\\)\u0026#39;] # æˆ–è€… \\(...\\) hugo.yamlä¸è¦åŠ math: trueï¼Œåœ¨æ¯ç¯‡æ–‡ç« å¼€å¤´çš„å‚æ•°é‡ŒåŠ ä¸Šï¼š\nparams: math: true 4.6ä¾§è¾¹ç›®å½• åœ¨config.ymlä¸­ï¼Œæ·»åŠ æˆ–ä¿®æ”¹paramså¯¹åº”çš„é…ç½®ä¸ºä»¥ä¸‹å†…å®¹ï¼š\nparams: ShowToc: true TocOpen: true è™½ç„¶PaperModåŸç”Ÿå°±æœ‰ç›®å½•ï¼Œä½†æ˜¯å´æ˜¯åœ¨é¡¶éƒ¨ï¼Œä¾¿æ·æ€§å‡ ä¹ä¸º0ï¼Œæ”¾åœ¨ä¾§è¾¹å°±ä¼šæ–¹ä¾¿è®¸å¤šã€‚\nåœ¨é¡¹ç›®ç›®å½•layouts/partialsä¸‹æ·»åŠ toc.htmlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n{{- $headers := findRE \u0026#34;\u0026lt;h[1-6].*?\u0026gt;(.|\\n])+?\u0026lt;/h[1-6]\u0026gt;\u0026#34; .Content -}} {{- $has_headers := ge (len $headers) 1 -}} {{- if $has_headers -}} \u0026lt;aside id=\u0026#34;toc-container\u0026#34; class=\u0026#34;toc-container wide\u0026#34;\u0026gt; \u0026lt;div class=\u0026#34;toc\u0026#34;\u0026gt; \u0026lt;details {{if (.Param \u0026#34;TocOpen\u0026#34;) }} open{{ end }}\u0026gt; \u0026lt;summary accesskey=\u0026#34;c\u0026#34; title=\u0026#34;(Alt + C)\u0026#34;\u0026gt; \u0026lt;span class=\u0026#34;details\u0026#34;\u0026gt;{{- i18n \u0026#34;toc\u0026#34; | default \u0026#34;Table of Contents\u0026#34; }}\u0026lt;/span\u0026gt; \u0026lt;/summary\u0026gt; \u0026lt;div class=\u0026#34;inner\u0026#34;\u0026gt; {{- $largest := 6 -}} {{- range $headers -}} {{- $headerLevel := index (findRE \u0026#34;[1-6]\u0026#34; . 1) 0 -}} {{- $headerLevel := len (seq $headerLevel) -}} {{- if lt $headerLevel $largest -}} {{- $largest = $headerLevel -}} {{- end -}} {{- end -}} {{- $firstHeaderLevel := len (seq (index (findRE \u0026#34;[1-6]\u0026#34; (index $headers 0) 1) 0)) -}} {{- $.Scratch.Set \u0026#34;bareul\u0026#34; slice -}} \u0026lt;ul\u0026gt; {{- range seq (sub $firstHeaderLevel $largest) -}} \u0026lt;ul\u0026gt; {{- $.Scratch.Add \u0026#34;bareul\u0026#34; (sub (add $largest .) 1) -}} {{- end -}} {{- range $i, $header := $headers -}} {{- $headerLevel := index (findRE \u0026#34;[1-6]\u0026#34; . 1) 0 -}} {{- $headerLevel := len (seq $headerLevel) -}} {{/* get id=\u0026#34;xyz\u0026#34; */}} {{- $id := index (findRE \u0026#34;(id=\\\u0026#34;(.*?)\\\u0026#34;)\u0026#34; $header 9) 0 }} {{- /* strip id=\u0026#34;\u0026#34; to leave xyz, no way to get regex capturing groups in hugo */ -}} {{- $cleanedID := replace (replace $id \u0026#34;id=\\\u0026#34;\u0026#34; \u0026#34;\u0026#34;) \u0026#34;\\\u0026#34;\u0026#34; \u0026#34;\u0026#34; }} {{- $header := replaceRE \u0026#34;\u0026lt;h[1-6].*?\u0026gt;((.|\\n])+?)\u0026lt;/h[1-6]\u0026gt;\u0026#34; \u0026#34;$1\u0026#34; $header -}} {{- if ne $i 0 -}} {{- $prevHeaderLevel := index (findRE \u0026#34;[1-6]\u0026#34; (index $headers (sub $i 1)) 1) 0 -}} {{- $prevHeaderLevel := len (seq $prevHeaderLevel) -}} {{- if gt $headerLevel $prevHeaderLevel -}} {{- range seq $prevHeaderLevel (sub $headerLevel 1) -}} \u0026lt;ul\u0026gt; {{/* the first should not be recorded */}} {{- if ne $prevHeaderLevel . -}} {{- $.Scratch.Add \u0026#34;bareul\u0026#34; . -}} {{- end -}} {{- end -}} {{- else -}} \u0026lt;/li\u0026gt; {{- if lt $headerLevel $prevHeaderLevel -}} {{- range seq (sub $prevHeaderLevel 1) -1 $headerLevel -}} {{- if in ($.Scratch.Get \u0026#34;bareul\u0026#34;) . -}} \u0026lt;/ul\u0026gt; {{/* manually do pop item */}} {{- $tmp := $.Scratch.Get \u0026#34;bareul\u0026#34; -}} {{- $.Scratch.Delete \u0026#34;bareul\u0026#34; -}} {{- $.Scratch.Set \u0026#34;bareul\u0026#34; slice}} {{- range seq (sub (len $tmp) 1) -}} {{- $.Scratch.Add \u0026#34;bareul\u0026#34; (index $tmp (sub . 1)) -}} {{- end -}} {{- else -}} \u0026lt;/ul\u0026gt; \u0026lt;/li\u0026gt; {{- end -}} {{- end -}} {{- end -}} {{- end }} \u0026lt;li\u0026gt; \u0026lt;a href=\u0026#34;#{{- $cleanedID -}}\u0026#34; aria-label=\u0026#34;{{- $header | plainify -}}\u0026#34;\u0026gt;{{- $header | safeHTML -}}\u0026lt;/a\u0026gt; {{- else }} \u0026lt;li\u0026gt; \u0026lt;a href=\u0026#34;#{{- $cleanedID -}}\u0026#34; aria-label=\u0026#34;{{- $header | plainify -}}\u0026#34;\u0026gt;{{- $header | safeHTML -}}\u0026lt;/a\u0026gt; {{- end -}} {{- end -}} \u0026lt;!-- {{- $firstHeaderLevel := len (seq (index (findRE \u0026#34;[1-6]\u0026#34; (index $headers 0) 1) 0)) -}} --\u0026gt; {{- $firstHeaderLevel := $largest }} {{- $lastHeaderLevel := len (seq (index (findRE \u0026#34;[1-6]\u0026#34; (index $headers (sub (len $headers) 1)) 1) 0)) }} \u0026lt;/li\u0026gt; {{- range seq (sub $lastHeaderLevel $firstHeaderLevel) -}} {{- if in ($.Scratch.Get \u0026#34;bareul\u0026#34;) (add . $firstHeaderLevel) }} \u0026lt;/ul\u0026gt; {{- else }} \u0026lt;/ul\u0026gt; \u0026lt;/li\u0026gt; {{- end -}} {{- end }} \u0026lt;/ul\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/details\u0026gt; \u0026lt;/div\u0026gt; \u0026lt;/aside\u0026gt; \u0026lt;script\u0026gt; let activeElement; let elements; window.addEventListener(\u0026#39;DOMContentLoaded\u0026#39;, function (event) { checkTocPosition(); elements = document.querySelectorAll(\u0026#39;h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]\u0026#39;); // Make the first header active activeElement = elements[0]; const id = encodeURI(activeElement.getAttribute(\u0026#39;id\u0026#39;)).toLowerCase(); document.querySelector(`.inner ul li a[href=\u0026#34;#${id}\u0026#34;]`).classList.add(\u0026#39;active\u0026#39;); }, false); window.addEventListener(\u0026#39;resize\u0026#39;, function(event) { checkTocPosition(); }, false); window.addEventListener(\u0026#39;scroll\u0026#39;, () =\u0026gt; { // Check if there is an object in the top half of the screen or keep the last item active activeElement = Array.from(elements).find((element) =\u0026gt; { if ((getOffsetTop(element) - window.pageYOffset) \u0026gt; 0 \u0026amp;\u0026amp; (getOffsetTop(element) - window.pageYOffset) \u0026lt; window.innerHeight/2) { return element; } }) || activeElement elements.forEach(element =\u0026gt; { const id = encodeURI(element.getAttribute(\u0026#39;id\u0026#39;)).toLowerCase(); if (element === activeElement){ document.querySelector(`.inner ul li a[href=\u0026#34;#${id}\u0026#34;]`).classList.add(\u0026#39;active\u0026#39;); } else { document.querySelector(`.inner ul li a[href=\u0026#34;#${id}\u0026#34;]`).classList.remove(\u0026#39;active\u0026#39;); } }) }, false); const main = parseInt(getComputedStyle(document.body).getPropertyValue(\u0026#39;--article-width\u0026#39;), 10); const toc = parseInt(getComputedStyle(document.body).getPropertyValue(\u0026#39;--toc-width\u0026#39;), 10); const gap = parseInt(getComputedStyle(document.body).getPropertyValue(\u0026#39;--gap\u0026#39;), 10); function checkTocPosition() { const width = document.body.scrollWidth; if (width - main - (toc * 2) - (gap * 4) \u0026gt; 0) { document.getElementById(\u0026#34;toc-container\u0026#34;).classList.add(\u0026#34;wide\u0026#34;); } else { document.getElementById(\u0026#34;toc-container\u0026#34;).classList.remove(\u0026#34;wide\u0026#34;); } } function getOffsetTop(element) { if (!element.getClientRects().length) { return 0; } let rect = element.getBoundingClientRect(); let win = element.ownerDocument.defaultView; return rect.top + win.pageYOffset; } \u0026lt;/script\u0026gt; {{- end }} åœ¨é¡¹ç›®ç›®å½•assets/css/extendedä¸‹æ·»åŠ blank.cssæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š\n:root { --nav-width: 1380px; --article-width: 650px; --toc-width: 300px; } .toc { margin: 0 2px 40px 2px; border: 1px solid var(--border); background: var(--entry); border-radius: var(--radius); padding: 0.4em; } .toc-container.wide { position: absolute; height: 100%; border-right: 1px solid var(--border); left: calc((var(--toc-width) + var(--gap)) * -1); top: calc(var(--gap) * 2); width: var(--toc-width); } .wide .toc { position: sticky; top: var(--gap); border: unset; background: unset; border-radius: unset; width: 100%; margin: 0 2px 40px 2px; } .toc details summary { cursor: zoom-in; margin-inline-start: 20px; padding: 12px 0; } .toc details[open] summary { font-weight: 500; } .toc-container.wide .toc .inner { margin: 0; } .active { font-size: 110%; font-weight: 600; } .toc ul { list-style-type: circle; } .toc .inner { margin: 0 0 0 20px; padding: 0px 15px 15px 20px; font-size: 16px; /*ç›®å½•æ˜¾ç¤ºé«˜åº¦*/ max-height: 83vh; overflow-y: auto; } .toc .inner::-webkit-scrollbar-thumb { /*æ»šåŠ¨æ¡*/ background: var(--border); border: 7px solid var(--theme); border-radius: var(--radius); } .toc li ul { margin-inline-start: calc(var(--gap) * 0.5); list-style-type: none; } .toc li { list-style: none; font-size: 0.95rem; padding-bottom: 5px; } .toc li a:hover { color: var(--secondary); } äºŒã€åœ¨GitHubPageéƒ¨ç½²ç½‘ç«™ åŸºæœ¬æ€è·¯ï¼šå»ºç«‹ä¸¤ä¸ªä»“åº“ï¼Œä¸€ä¸ªç½‘ç«™ä»“åº“è´Ÿè´£å±•ç¤ºé¡µé¢ï¼Œå¦ä¸€ä¸ªæºä»“åº“è´Ÿè´£å­˜å‚¨æºç ã€æ›´æ–°å†…å®¹å¹¶è‡ªåŠ¨æ›´æ–°åŒæ­¥åˆ°ç½‘ç«™ä»“åº“ã€‚\n1.å»ºç«‹ç½‘ç«™ä»“åº“ åœ¨Githubé¡µé¢ç‚¹å‡»æœ€ä¸Šé¢çš„åŠ å·-New repository Repository name å¡«å†™ ä½ çš„GitHubç”¨æˆ·å.github.ioï¼Œè¿™æ ·GitHubæ‰ä¼šæŠŠå®ƒè¯†åˆ«ä¸ºç½‘ç«™ä»“åº“ é€‰æ‹©Public ç‚¹å‡»ç»¿è‰²çš„Create repository\n2.å»ºç«‹æºä»“åº“ åŒä¸Šå»ºç«‹ä»“åº“ï¼Œéšä¾¿å‘½åï¼ŒPublicæˆ–Privateéƒ½è¡Œ è¿™é‡Œæˆ‘å‘½åä¸ºmywebsite\n3.GitHub ä¸ªäººè®¿é—®ä»¤ç‰Œ (Token) ç”Ÿæˆ\u0026amp;é…ç½® ç‚¹å‡»å³ä¸Šè§’ å¤´åƒ é€‰æ‹© Settings å·¦ä¾§èœå•é€‰æ‹© Developer settings é€‰æ‹© Personal access tokens â†’ Tokens (classic) ç‚¹å‡» Generate new token â†’ Generate new token (classic) è®¾ç½® Token ä¿¡æ¯ï¼š Token nameï¼šè¾“å…¥åç§°ï¼ˆå¦‚ mywebsiteï¼‰ Expirationï¼šé€‰æ‹© No expirationï¼ˆæ°¸ä¸è¿‡æœŸï¼‰ æƒé™å‹¾é€‰ï¼š âœ… repoï¼ˆå…¨ä»“åº“æƒé™ï¼‰ âœ… admin:repo_hookï¼ˆä»“åº“ç®¡ç†æƒé™ï¼‰ ç‚¹å‡»ç»¿è‰²æŒ‰é’® Generate token é‡è¦ï¼šç«‹å³å¤åˆ¶ç”Ÿæˆçš„å¯†é’¥å¹¶å¦¥å–„ä¿å­˜ï¼ˆç¦»å¼€é¡µé¢åå°†æ— æ³•å†æ¬¡æŸ¥çœ‹ï¼‰ è¿›å…¥æºä»“åº“ ç‚¹å‡»settings å·¦ä¾§Secrets and variables-Actions New repository secret å¡«å†™åˆšæ‰çš„åç§°å’Œå¯†é’¥ Add sercet 4.é…ç½®workflowè„šæœ¬ åœ¨æœ¬åœ°ç½‘ç«™æ ¹ç›®å½•æ–°å»ºæ–‡ä»¶å¤¹åŠæ–‡ä»¶.github/workflows/hugo.yaml å†™å…¥ï¼š\nname: github pages # åå­—è‡ªå– on: push: branches: - main jobs: deploy: # ä»»åŠ¡åè‡ªå– runs-on: ubuntu-latest\t# åœ¨ä»€ä¹ˆç¯å¢ƒè¿è¡Œä»»åŠ¡ steps: - uses: actions/checkout@v2\t# å¼•ç”¨actions/checkoutè¿™ä¸ªactionï¼Œä¸æ‰€åœ¨çš„githubä»“åº“åŒå with: submodules: true # Fetch Hugo themes (true OR recursive) è·å–submoduleä¸»é¢˜ fetch-depth: 0 # Fetch all history for .GitInfo and .Lastmod - name: Setup Hugo\t# æ­¥éª¤åè‡ªå– uses: peaceiris/actions-hugo@v2\t# hugoå®˜æ–¹æä¾›çš„actionï¼Œç”¨äºåœ¨ä»»åŠ¡ç¯å¢ƒä¸­è·å–hugo with: hugo-version: \u0026#39;latest\u0026#39;\t# è·å–æœ€æ–°ç‰ˆæœ¬çš„hugo extended: true - name: Build run: hugo --minify\t# ä½¿ç”¨hugoæ„å»ºé™æ€ç½‘é¡µ - name: Deploy uses: peaceiris/actions-gh-pages@v3\t# ä¸€ä¸ªè‡ªåŠ¨å‘å¸ƒgithub pagesçš„action with: # github_token: ${{ secrets.GITHUB_TOKEN }} è¯¥é¡¹é€‚ç”¨äºå‘å¸ƒåˆ°æºç ç›¸åŒrepoçš„æƒ…å†µï¼Œä¸èƒ½ç”¨äºå‘å¸ƒåˆ°å…¶ä»–repo external_repository: Rook1eChan/Rook1eChan.github.io\t# å‘å¸ƒåˆ°å“ªä¸ªrepo personal_token: ${{ secrets.MYWEBSITE2 }}\t# å‘å¸ƒåˆ°å…¶ä»–repoéœ€è¦æä¾›ä¸Šé¢ç”Ÿæˆçš„personal access token publish_dir: ./public\t# æ³¨æ„è¿™é‡ŒæŒ‡çš„æ˜¯è¦å‘å¸ƒå“ªä¸ªæ–‡ä»¶å¤¹çš„å†…å®¹ï¼Œè€Œä¸æ˜¯æŒ‡å‘å¸ƒåˆ°ç›®çš„ä»“åº“çš„ä»€ä¹ˆä½ç½®ï¼Œå› ä¸ºhugoé»˜è®¤ç”Ÿæˆé™æ€ç½‘é¡µåˆ°publicæ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥è¿™é‡Œå‘å¸ƒpublicæ–‡ä»¶å¤¹é‡Œçš„å†…å®¹ publish_branch: main\t# å‘å¸ƒåˆ°å“ªä¸ªbranch åªéœ€è¦æ›´æ”¹personal_tokenå’Œexternal_repository\n5. SSH å¯†é’¥é…ç½® æ£€æŸ¥æ˜¯å¦å·²æœ‰ SSH Key\nWindowsï¼š è¿›å…¥ C:\\Users\\ä½ çš„ç”¨æˆ·å\\.sshï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ id_rsaï¼ˆç§é’¥ï¼‰å’Œ id_rsa.pubï¼ˆå…¬é’¥ï¼‰æ–‡ä»¶ã€‚\nè‹¥æœ‰ï¼Œè¯´æ˜å·²ç”Ÿæˆè¿‡ SSH Keyï¼Œå¯ç›´æ¥ä½¿ç”¨ã€‚ è‹¥æ— ï¼Œéœ€é‡æ–°ç”Ÿæˆã€‚ Linuxï¼š\ncd ~/.ssh ls æ£€æŸ¥æ˜¯å¦å­˜åœ¨ id_rsa å’Œ id_rsa.pub æ–‡ä»¶ã€‚\nç”Ÿæˆ SSH Keyï¼ˆè‹¥æ— ï¼‰ è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼ˆæ›¿æ¢ xxx@xxx.com ä¸ºä½ çš„ GitHub æ³¨å†Œé‚®ç®±ï¼‰ï¼š\nssh-keygen -t rsa -C \u0026#34;xxx@xxx.com\u0026#34; è¿ç»­æŒ‰ 3 æ¬¡å›è½¦ï¼ˆä½¿ç”¨é»˜è®¤è·¯å¾„ï¼Œä¸è®¾å¯†ç ï¼‰ã€‚ ç”Ÿæˆçš„æ–‡ä»¶ï¼š id_rsaï¼šç§é’¥ï¼ˆåˆ‡å‹¿æ³„éœ²ï¼‰ã€‚ id_rsa.pubï¼šå…¬é’¥ï¼ˆéœ€æ·»åŠ åˆ° GitHubï¼‰ã€‚ å°†å…¬é’¥æ·»åŠ åˆ° GitHub å¤åˆ¶å…¬é’¥å†…å®¹ï¼ˆid_rsa.pubï¼‰ï¼š ç™»å½• GitHub â†’ ç‚¹å‡»å¤´åƒ â†’ Settings â†’ SSH and GPG Keys â†’ New SSH Keyã€‚ æµ‹è¯• SSH è¿æ¥ åœ¨ç»ˆç«¯è¿è¡Œï¼š ssh -T git@github.com è‹¥æ˜¾ç¤º Hi ä½ çš„ç”¨æˆ·å!ï¼Œè¯´æ˜é…ç½®æˆåŠŸã€‚ ä¹‹åcloneæˆ–pushæ—¶éƒ½é€‰æ‹©SSHåœ°å€ï¼Œè€Œä¸æ˜¯httpsåœ°å€ã€‚\n6.ä¸Šä¼  æœ¬åœ°ç½‘ç«™æ ¹ç›®å½•ä½¿ç”¨cmdï¼Œgit@github.com:XXX/mywebsite.gitæ”¹ä¸ºæºä»“åº“åœ°å€ï¼š\ngit init git add . git remote add origin git@github.com:XXX/mywebsite.git git commit -m \u0026#34;Update\u0026#34; git push -u origin main ç„¶ååœ¨æºä»“åº“çš„Actionä¸‹ï¼Œèƒ½çœ‹åˆ°æ­£åœ¨Deployï¼Œå˜ç»¿è‰²è¯´æ˜æˆåŠŸã€‚æ­¤æ—¶ç½‘ç«™ä»“åº“å·²è‡ªåŠ¨æ›´æ–°äº†å†…å®¹ã€‚\nè¿›å…¥ç½‘ç«™ä»“åº“-settings-Pages-Build and deploymenté€‰æ‹©Deploy from a branch åˆšæ‰workflowè„šæœ¬é‡Œå†™çš„æ˜¯mainï¼Œè¿™é‡Œå°±é€‰æ‹©main\nç„¶åè¿›å…¥xxx.github.ioï¼Œå°±å¯ä»¥çœ‹åˆ°ä½ çš„ç½‘ç«™äº†ï¼ğŸ‰\nä¸‰ã€å¦‚ä½•æ›´æ–°ç½‘ç«™å†…å®¹ ä¸è¦åœ¨githubå’Œæœ¬åœ°åŒæ—¶æ›´æ”¹å†…å®¹ï¼ä¸ç„¶ä¼šå¯¼è‡´å†…å®¹ä¸åŒæ­¥ï¼Œæ— æ³•pushã€‚\næœ€å¥½æ˜¯ä¸€ç›´éƒ½åœ¨æœ¬åœ°æ›´æ”¹ï¼Œç„¶åpushåˆ°æºä»“åº“ã€‚\n1.æœ¬åœ°æ›´æ”¹åï¼Œæ¯”å¦‚æ–°å»ºäº†ç¬”è®°ï¼Œåœ¨ç½‘ç«™æ ¹ç›®å½•ä½¿ç”¨cmdï¼š ä¸è¦å¤åˆ¶æ³¨é‡Šï¼\ngit init //åˆå§‹åŒ–gitæ–‡ä»¶å¤¹ git add . //æ·»åŠ å˜æ›´å†…å®¹ git remote add origin git@github.com:XXX/mywebsite.git //æœ€åä¸€é¡¹æ”¹ä¸ºæºä»“åº“çš„åœ°å€ï¼Œå¦‚æœä½¿ç”¨sshè¿æ¥çš„å°±å¤åˆ¶sshåœ°å€ git commit -m \u0026#34;new\u0026#34; //è®¾ç½®æœ¬æ¬¡æ“ä½œçš„åç§°ï¼Œnewå¯ä»¥éšä¾¿æ”¹ git push -u origin main //æŠŠæœ¬åœ°æ–‡ä»¶pushåˆ°githubä¸Šï¼Œå¢é‡æ›´æ–° å¸¸è§é—®é¢˜ï¼š\ngit push -u origin mainçš„æ—¶å€™æŠ¥é”™ï¼š error: src refspec master does not match any error: failed to push some refs to \u0026lsquo;github.com:Rook1eChan/mywebsite.git\u0026rsquo;\nä½¿ç”¨git branch -aï¼ŒæŸ¥çœ‹branchçš„åç§°æ˜¯ä¸æ˜¯mainã€‚å¦‚æœæ˜¯masterï¼Œå°±æŠŠmainæ”¹ä¸ºmasterã€‚\nTo github.com:Rook1eChan/mywebsite.git ! [rejected] main -\u0026gt; main (fetch first) error: failed to push some refs to \u0026lsquo;github.com:Rook1eChan/mywebsite.git\u0026rsquo; hint: Updates were rejected because the remote contains work that you do not\nè¯´æ˜ä½ çš„GitHubå’Œæœ¬åœ°ä¸åŒæ­¥ã€‚ä¸å»ºè®®å¼ºåˆ¶åˆå¹¶ï¼Œå¯ä»¥æŠŠGitHubæ•´ä¸ªrepo cloneåˆ°æœ¬åœ°å¦ä¸€ä¸ªæ–‡ä»¶ï¼ŒæŠŠå˜åŒ–çš„æ–‡ä»¶æ‰‹åŠ¨æ›´æ”¹ï¼Œå†æŠŠæ–°æ–‡ä»¶å¤¹pushä¸Šå»ã€‚\næ„Ÿè°¢GitHubã€Hugoå’ŒDeekseekã€‚\n","permalink":"https://Rook1eChan.github.io/posts/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%BB%BA%E7%AB%8Bgithub%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2hugopapermod/","summary":"\u003cp\u003egithubæä¾›ç»™æ¯ä¸ªç”¨æˆ·ä¸€ä¸ªç½‘å€ï¼Œç”¨æˆ·å¯ä»¥å»ºç«‹è‡ªå·±çš„é™æ€ç½‘ç«™ã€‚\u003c/p\u003e\n\u003ch2 id=\"ä¸€hugo\"\u003eä¸€ã€Hugo\u003c/h2\u003e\n\u003cp\u003ehugoæ˜¯ä¸€ä¸ªå¿«é€Ÿæ­å»ºç½‘ç«™çš„å·¥å…·ï¼Œç”±goè¯­è¨€ç¼–å†™ã€‚\u003c/p\u003e\n\u003ch3 id=\"1å®‰è£…hugo\"\u003e1.å®‰è£…hugo\u003c/h3\u003e\n\u003cp\u003eåˆ°hugoçš„githubæ ‡ç­¾é¡µ\u003ca href=\"https://github.com/gohugoio/hugo/tags\"\u003eTags Â· gohugoio/hugo\u003c/a\u003eé€‰æ‹©ä¸€ä¸ªç‰ˆæœ¬ï¼Œä¸‹è½½å¯¹åº”çš„å®‰è£…åŒ…ã€‚æ¯”å¦‚\u003ccode\u003ehugo_extended_withdeploy_0.147.0_windows-amd64.zip\u003c/code\u003eã€‚\u003c/p\u003e\n\u003cp\u003eè§£å‹åï¼Œåœ¨æ ¹ç›®å½•æ‰“å¼€cmdï¼Œè¾“å…¥\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cmd\" data-lang=\"cmd\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehugo new site YourSiteName\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä¸ºä½ çš„ç½‘ç«™å»ºç«‹æ–‡ä»¶å¤¹ã€‚\u003ccode\u003eYourSiteName\u003c/code\u003eæ›´æ”¹ä¸ºä½ çš„ç½‘ç«™çš„åå­—ã€‚\næ ¹ç›®å½•ä¼šå‡ºç°YourSiteNameæ–‡ä»¶å¤¹ã€‚\u003c/p\u003e\n\u003cp\u003e3.å°†æ ¹ç›®å½•çš„hugo.exeå¤åˆ¶åˆ°YourSiteNameé‡Œã€‚\nåœ¨YourSiteNameæ–‡ä»¶å¤¹é‡Œæ‰“å¼€cmdï¼Œè¾“å…¥\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cmd\" data-lang=\"cmd\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ehugo server -D\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eä¼šè¿”å›å¦‚ä¸‹ä¿¡æ¯ï¼š\u003c/p\u003e\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cmd\" data-lang=\"cmd\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e                   \u003cspan class=\"p\"\u003e|\u003c/span\u003e EN\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e-------------------+-----\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Pages            \u003cspan class=\"p\"\u003e|\u003c/span\u003e 11\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Paginator pages  \u003cspan class=\"p\"\u003e|\u003c/span\u003e  0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Non-page files   \u003cspan class=\"p\"\u003e|\u003c/span\u003e  0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Static files     \u003cspan class=\"p\"\u003e|\u003c/span\u003e  0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Processed images \u003cspan class=\"p\"\u003e|\u003c/span\u003e  0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Aliases          \u003cspan class=\"p\"\u003e|\u003c/span\u003e  2\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e  Cleaned          \u003cspan class=\"p\"\u003e|\u003c/span\u003e  0\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eBuilt in 79 ms\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eEnvironment: \u003cspan class=\"s2\"\u003e\u0026#34;development\u0026#34;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eServing pages from disk\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eRunning in Fast Render Mode. For full rebuilds on change: hugo server --disableFastRender\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eWeb Server is available at http://localhost:1313/ (bind address 127.0.0.1)\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003ePress Ctrl+C to stop\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003cp\u003eåœ¨æµè§ˆå™¨ä¸­è¾“å…¥\u003ccode\u003ehttp://localhost:1313/\u003c/code\u003eï¼Œæ˜¾ç¤ºPage Not Foundï¼Œè¯´æ˜æœåŠ¡å™¨æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯æ­¤æ—¶ç½‘ç«™è¿˜æ²¡æœ‰é¡µé¢ã€‚\u003c/p\u003e","title":"ä»0å¼€å§‹å»ºç«‹Githubä¸ªäººåšå®¢(hugo\u0026PaperMod)"},{"content":"åŸæ–‡ï¼šNeural-IR Models.. Neural IR(Information Retrieval) is aâ€¦ | by Muhammad Hammad Khan | Medium\nè¯‘æ–‡ï¼šã€ç¿»è¯‘ã€‘ä¸€æ–‡è¯¦è§£ç¥ç»ä¿¡æ¯æ£€ç´¢é¢†åŸŸçš„æœ€æ–°è¿›å±• - çŸ¥ä¹\nç¥ç»ä¿¡æ¯æ£€ç´¢(Neural Information Retrieval, Neural IR)æ˜¯ä¿¡æ¯æ£€ç´¢é¢†åŸŸçš„ä¸€ä¸ªé‡è¦ç ”ç©¶è¯¾é¢˜ã€‚è‡ªä»è°·æ­Œåœ¨2018å¹´å‘å¸ƒBERTä»¥æ¥ï¼Œå®ƒåœ¨11ä¸ªNLPä»»åŠ¡ä¸Šè·å¾—äº†æœ€å…ˆè¿›çš„ç»“æœï¼Œä¸€ä¸¾æ”¹å˜äº†æ•´ä¸ªNLPé¢†åŸŸçš„ç ”ç©¶èŒƒå¼ã€‚2019å¹´1æœˆï¼ŒNogueiraå’ŒChoåœ¨MS MARCO Passage Rankingæµ‹è¯•é›†ä¸Šé¦–æ¬¡ä½¿ç”¨BERTã€‚ä»é‚£æ—¶èµ·ï¼Œäººä»¬å¼€å§‹ç ”ç©¶ç¥ç»ä¿¡æ¯æ£€ç´¢çš„èŒƒå¼ï¼Œä¹Ÿæå‡ºäº†è®¸å¤šåŸºäºBERTçš„æ–‡æœ¬æ’åºæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ç”¨äºå¤šé˜¶æ®µæœç´¢æ¶æ„çš„é‡æ’é˜¶æ®µ(Re-Ranker)ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\nFigure1 å±•ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„å¤šé˜¶æ®µæœç´¢ç»“æ„ã€‚ç¬¬ä¸€æ­¥ï¼šå€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰+BM25å¾—åˆ†è¿›è¡Œæ’åºï¼Œå¾—åˆ°topKæ–‡æ¡£ï¼Œè¿™ä¸€æ­¥ä¹Ÿå«å€™é€‰é¡¹ç”Ÿæˆï¼ˆCandidates Generationï¼‰ã€‚ç¬¬äºŒæ­¥ï¼Œé€šè¿‡åŸºäºBERTçš„ä¸Šä¸‹æ–‡æ’åºæ¨¡å‹æ¥ç¡®å®šå‰Nä¸ªæ–‡æ¡£çš„æœ€ç»ˆæ’åºã€‚\nç¥ç»é‡æ’æ¨¡å‹(Neural re-ranking models)ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§ï¼Œå¦‚Figure2æ‰€ç¤ºï¼š\nåŸºäºè¡¨å¾(representation-focused) åŸºäºäº¤äº’(interaction-focused) å…¨äº¤äº’ï¼ˆä¹Ÿè¢«ç§°ä½œäº¤å‰ç¼–ç å™¨,ï¼‰(all-to-all interaction(cross encoder) ) è¿Ÿäº¤äº’(late interaction) 1.åŸºäºè¡¨å¾â€”â€”åŒå¡”æ¨¡å‹(Bi-encoder Models) åŒå¡”æ¨¡å‹å°†Queryå’ŒDocåˆ†åˆ«è¡¨å¾ä¸ºå¯†é›†çš„å‘é‡åµŒå…¥ï¼Œç”¨å‘é‡ç›¸ä¼¼åº¦åˆ†æ•°æ¥ä¼°è®¡Qå’ŒDçš„ç›¸å…³æ€§ã€‚åœ¨è®­ç»ƒæ—¶éœ€è¦æ­£è´Ÿæ ·æœ¬è¿›è¡Œå¯¹æ¯”å­¦ä¹ ï¼Œå› ä¸ºå¦‚æœåªç»™æ¨¡å‹çœ‹æ­£æ ·æœ¬ï¼Œå®ƒä¼šå·æ‡’â€”â€”æŠŠæ‰€æœ‰å‘é‡éƒ½å˜æˆä¸€æ ·çš„ï¼Œè¿™æ ·â€œç›¸ä¼¼åº¦â€æ°¸è¿œæœ€é«˜ã€‚è´Ÿæ ·æœ¬å¼ºè¿«æ¨¡å‹å­¦ä¼šåŒºåˆ†ç›¸å…³å’Œä¸ç›¸å…³çš„å†…å®¹ã€‚\nåœ¨å°†æ¨¡å‹è®­ç»ƒå¥½åï¼Œdocå’Œqueryçš„è¡¨å¾å¯ä»¥ç‹¬ç«‹è¿›è¡Œï¼Œä¸ç”¨åƒäº¤å‰ç¼–ç å™¨é‚£æ ·æ¯æ¬¡éƒ½è¦æŠŠQueryå’ŒDocæ‹¼åœ¨ä¸€èµ·é‡æ–°è®¡ç®—ã€‚\n1.1å¯†é›†æ®µè½æ£€ç´¢å™¨(Dense passage retriever, DPR) è®ºæ–‡ï¼šDense Passage Retrieval for Open-Domain Question Answering EMNLP 2020, Facebook Research Code: github.com/facebookresearch/DPR è®²è§£åšå®¢ï¼šã€IR è®ºæ–‡ã€‘DPR â€” æœ€æ—©æå‡ºä½¿ç”¨åµŒå…¥å‘é‡æ¥æ£€ç´¢æ–‡æ¡£çš„æ¨¡å‹_dpræ¨¡å‹-CSDNåšå®¢\nDPRæ˜¯ä¸€ä¸ªåº”ç”¨äºé—®ç­”é¢†åŸŸçš„åŒå¡”æ¨¡å‹ï¼Œæ—¨åœ¨æœ€å¤§é™åº¦åœ°æé«˜æŸ¥è¯¢ä¸ç›¸å…³æ–‡æ¡£çš„ç›¸ä¼¼åº¦ï¼ŒåŒæ—¶æœ€å°åŒ–ä¸éç›¸å…³æ–‡æ¡£çš„ç›¸ä¼¼åº¦ã€‚DPRæ˜¯RAGä¸­Rçš„ç»å…¸æ–¹æ¡ˆã€‚\næ­£æ ·æœ¬å¾€å¾€æ•°æ®é›†å·²ç»™å®šï¼Œè€Œè´Ÿæ ·æœ¬æ¯”è¾ƒéš¾é€‰æ‹©ã€‚ä¸ºæ­¤ï¼ŒDPRæå‡ºäº†ä¸€ç§Batchå†…è´Ÿé‡‡æ ·çš„æŠ€æœ¯ï¼Œä»åŒä¸€æ‰¹æ¬¡çš„å…¶ä»–æ ·æœ¬ä¸­é€‰æ‹©æ ·æœ¬ä½œä¸ºè´Ÿæ ·æœ¬ã€‚è¿™ç§æ–¹æ³•æ˜¯æœ‰æ•ˆä¸”é«˜æ•ˆçš„ã€‚\n1.2æœ€è¿‘é‚»è´Ÿå¯¹æ¯”ä¼°è®¡ (Approximate nearest neighbour Negative Contrastive Estimation, ANCE) è¯¥è®ºæ–‡è¯æ˜äº†å¼ºè´Ÿæ ·æœ¬èƒ½å¤ŸåŠ é€Ÿæ¨¡å‹æ”¶æ•›ï¼Œæå‡æ¨¡å‹æ€§èƒ½ã€‚è´Ÿæ ·æœ¬åˆ†ä¸ºæ˜“åŒºåˆ«çš„å’Œä¸æ˜“åŒºåˆ«çš„ï¼Œæ˜¾ç„¶ä¸æ˜“åŒºåˆ«ï¼ˆå³å¼ºè´Ÿæ ·æœ¬ï¼‰çš„å¯¹æ¨¡å‹å­¦ä¹ å¸®åŠ©æ›´å¤§ã€‚æœ¬æ–‡ä½¿ç”¨ANNå¯»æ‰¾å¼ºè´Ÿæ ·æœ¬ã€‚\nDPRå’ŒANCEçš„ç»“æœè¡¨æ˜ï¼ŒåŒå¡”ç¼–ç å™¨ä¸å¦‚äº¤å‰ç¼–ç å™¨æœ‰æ•ˆï¼Œå› ä¸ºä¸§å¤±äº†æŸ¥è¯¢ä¸æ–‡æ¡£çš„äº¤äº’ã€‚ä½†æ˜¯å¼€é”€æ›´å°ï¼Œå› ä¸ºæ–‡æ¡£å¯ä»¥å•ç‹¬é¢„å…ˆå¤„ç†ã€‚\n2.è¿Ÿäº¤äº’æ¨¡å‹ï¼ˆLate Interaction Modelsï¼‰ 2.1Contextualized Late Interaction over BERT, ColBERT v2è®ºæ–‡ï¼šColBERTv2: Effective and Efficient Retrieval via Lightweight Late Interaction ColBERT\u0026amp;ColBERTv2è®²è§£ï¼šColBERTå’ŒColBERTv2:å…¼å…·Bi-encoderå’Œcross-encoderä¼˜åŠ¿çš„å¤šå‘é‡æ’åºæ¨¡å‹-CSDNåšå®¢\nColBERTå¼•å…¥å»¶è¿Ÿäº¤äº’æœºåˆ¶ï¼Œç›¸æ¯”äº¤å‰ç¼–ç å™¨æ•ˆç‡æå‡äº†å¾ˆå¤šã€‚\nç®€å•æ¥è¯´ï¼Œå°†Queryå’ŒDocè¿›è¡Œåˆ†è¯ï¼Œæ¯ä¸ªtokenç”Ÿæˆä¸€ä¸ªåµŒå…¥å‘é‡ã€‚è®¡ç®—Queryä¸­æ¯ä¸ªè¯ä¸Docæ‰€æœ‰è¯çš„å‘é‡ç›¸ä¼¼åº¦ã€‚Queryæ¯ä¸ªè¯å–æœ€é«˜åˆ†ï¼Œæ‰€æœ‰æœ€é«˜åˆ†åŠ èµ·æ¥å¾—åˆ°Docçš„æœ€ç»ˆå¾—åˆ†ã€‚\nç‹¬ç«‹ç¼–ç ï¼š Queryå‘é‡ï¼š[å¦‚ä½•, æ²»ç–—, æ„Ÿå†’] Docå‘é‡ï¼š[æ„Ÿå†’, ç—…æ¯’, ä¼‘æ¯, ç»´ç”Ÿç´ C] è®¡ç®—MaxSimï¼š æ²»ç–— â†’ ä¸Docæ‰€æœ‰è¯ç›¸ä¼¼åº¦æœ€é«˜çš„æ˜¯ä¼‘æ¯ï¼ˆå¾—åˆ†0.7ï¼‰ã€‚ æ„Ÿå†’ â†’ åŒ¹é…Docä¸­çš„æ„Ÿå†’ï¼ˆå¾—åˆ†1.0ï¼‰ã€‚ æ€»åˆ†ï¼š0.7 + 1.0 = 1.7 ColBERTæ—¢åƒåŒå¡”æ¨¡å‹ï¼Œå¯ä»¥å•ç‹¬è®¡ç®—Docçš„å‘é‡å¹¶å­˜å‚¨ï¼›åˆåƒäº¤å‰ç¼–ç å™¨ï¼Œå®ç°tokençº§åˆ«çš„äº¤äº’ã€‚\nåŒå¡”æ¨¡å‹å°†æ•´å¥è¯è¡¨å¾ä¸ºä¸€ä¸ªå‘é‡ï¼Œè€ŒColBERTå°†æ¯ä¸ªtokenéƒ½è¡¨å¾ä¸ºä¸€ä¸ªå‘é‡ï¼Œæ˜¾ç„¶åè€…æ›´ç»†ç²’åº¦ï¼Œå¯¹è¯­ä¹‰ç†è§£æ›´æ·±ã€‚ä½†æ˜¯å­˜å‚¨Docçš„æ¯ä¸ªtokençš„å‘é‡æ‰€éœ€çš„ç©ºé—´æ¯”ä¼ ç»Ÿçš„å€’æ’ç´¢å¼•å¤§å¾—å¤šã€‚è¿™ç§å¤§å†…å­˜å ç”¨çš„ç‰¹ç‚¹ä½¿ ColBERT åœ¨å¤§å‹è¯­æ–™åº“æƒ…å½¢ä¸‹ä¸å ä¼˜åŠ¿ã€‚\nColBERTv2åœ¨ColBERTåŸºç¡€ä¸Šä½¿ç”¨æ›´å…ˆè¿›çš„è®­ç»ƒæ–¹æ³•æ¥å¾®è°ƒæ¨¡å‹ï¼Œå¹¶é€šè¿‡æ®‹å·®å‹ç¼©æ–¹æ³•å¤§å¹…å‡å°‘å­˜å‚¨æˆæœ¬ã€‚\n3.åŸºäºçŸ¥è¯†è’¸é¦çš„ç¥ç»é‡æ’æ¨¡å‹ è’¸é¦çš„ä¸»è¦ç”¨é€”æ˜¯å‡å°æ¨¡å‹å¤§å°å¹¶é™ä½æ•´ä½“æ¨ç†æˆæœ¬ã€‚\nè®ºæ–‡ï¼šImproving efficient neural ranking models with cross-architecture knowledge distillation.\nè¯¥ä½œè€…ä½¿ç”¨MSMARCOæ•°æ®é›†å¯¹æ•™å¸ˆæ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œç”¨å®ƒå¯¹æ‰€æœ‰è®­ç»ƒä¸‰å…ƒç»„æ‰“åˆ†ï¼Œæ„å»ºä¸€ä¸ªæ–°çš„æ•°æ®é›†ã€‚æœ€åï¼Œå­¦ç”Ÿæ¨¡å‹åœ¨è¿™ä¸ªæ–°æ„å»ºçš„æ•°æ®é›†ä¸Šä½¿ç”¨Margin MSE Lossè¿›è¡Œè®­ç»ƒï¼Œè¯¥æŸå¤±å‡½æ•°ä¼˜åŒ–äº†æŸ¥è¯¢ä¸éç›¸å…³æ–‡æœ¬åŠç›¸å…³æ–‡æœ¬åˆ†æ•°ä¹‹é—´çš„è¾¹è·(Margin)ã€‚\nè®ºæ–‡ï¼šEfficiently Teaching an Effective Dense Retriever with Balanced Topic Aware Sampling\nTAS-Bæ–¹æ³•ï¼Œåœ¨è®­ç»ƒæ—¶æŠŠQueryæŒ‰ç…§è¯é¢˜è¿›è¡Œèšç°‡ï¼Œæ¯ä¸ªBatchå†…å‡åŒ€é‡‡æ ·Queryï¼Œé˜²æ­¢éšæœºé‡‡æ ·å¯¼è‡´ä¸€ä¸ªBatchå†…çš„è¯é¢˜éƒ½ç›¸ä¼¼ã€‚\nå°±ç›®å‰æ¥çœ‹ï¼ŒRAGçš„æ£€ç´¢è¿œæ²¡æœ‰æ£€ç´¢é¢†åŸŸæ¥çš„å¤æ‚ï¼Œåªæ˜¯ç”¨äº†å…³é”®å­—æ£€ç´¢ï¼Œæ²¡æœ‰å¾®è°ƒã€‚\n","permalink":"https://Rook1eChan.github.io/posts/neural-ir-models/","summary":"\u003cp\u003eåŸæ–‡ï¼š\u003ca href=\"https://medium.com/@mhammadkhan/neural-re-ranking-models-c0a67278f626\"\u003eNeural-IR Models.. Neural IR(Information Retrieval) is aâ€¦ | by Muhammad Hammad Khan | Medium\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eè¯‘æ–‡ï¼š\u003ca href=\"https://zhuanlan.zhihu.com/p/545429612\"\u003eã€ç¿»è¯‘ã€‘ä¸€æ–‡è¯¦è§£ç¥ç»ä¿¡æ¯æ£€ç´¢é¢†åŸŸçš„æœ€æ–°è¿›å±• - çŸ¥ä¹\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eç¥ç»ä¿¡æ¯æ£€ç´¢(Neural Information Retrieval, Neural IR)æ˜¯ä¿¡æ¯æ£€ç´¢é¢†åŸŸçš„ä¸€ä¸ªé‡è¦ç ”ç©¶è¯¾é¢˜ã€‚è‡ªä»è°·æ­Œåœ¨2018å¹´å‘å¸ƒBERTä»¥æ¥ï¼Œå®ƒåœ¨11ä¸ªNLPä»»åŠ¡ä¸Šè·å¾—äº†æœ€å…ˆè¿›çš„ç»“æœï¼Œä¸€ä¸¾æ”¹å˜äº†æ•´ä¸ªNLPé¢†åŸŸçš„ç ”ç©¶èŒƒå¼ã€‚2019å¹´1æœˆï¼ŒNogueiraå’ŒChoåœ¨MS MARCO Passage Rankingæµ‹è¯•é›†ä¸Šé¦–æ¬¡ä½¿ç”¨BERTã€‚ä»é‚£æ—¶èµ·ï¼Œäººä»¬å¼€å§‹ç ”ç©¶ç¥ç»ä¿¡æ¯æ£€ç´¢çš„èŒƒå¼ï¼Œä¹Ÿæå‡ºäº†è®¸å¤šåŸºäºBERTçš„æ–‡æœ¬æ’åºæ–¹æ³•ã€‚è¿™äº›æ–¹æ³•ç”¨äº\u003cstrong\u003eå¤šé˜¶æ®µæœç´¢æ¶æ„çš„é‡æ’é˜¶æ®µ(Re-Ranker)\u003c/strong\u003eã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\u003c/p\u003e\n\u003cp\u003e\u003cimg alt=\"image\" loading=\"lazy\" src=\"/Neural-IR-Models-1.jpg\"\u003e\u003c/p\u003e\n\u003cp\u003eFigure1 å±•ç¤ºäº†ä¸€ä¸ªç®€åŒ–çš„å¤šé˜¶æ®µæœç´¢ç»“æ„ã€‚ç¬¬ä¸€æ­¥ï¼šå€’æ’ç´¢å¼•ï¼ˆInverted Indexï¼‰+BM25å¾—åˆ†è¿›è¡Œæ’åºï¼Œå¾—åˆ°topKæ–‡æ¡£ï¼Œè¿™ä¸€æ­¥ä¹Ÿå«å€™é€‰é¡¹ç”Ÿæˆï¼ˆCandidates Generationï¼‰ã€‚ç¬¬äºŒæ­¥ï¼Œé€šè¿‡åŸºäºBERTçš„ä¸Šä¸‹æ–‡æ’åºæ¨¡å‹æ¥ç¡®å®šå‰Nä¸ªæ–‡æ¡£çš„æœ€ç»ˆæ’åºã€‚\u003c/p\u003e\n\u003cp\u003eç¥ç»é‡æ’æ¨¡å‹(Neural re-ranking models)ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å››ç§ï¼Œå¦‚Figure2æ‰€ç¤ºï¼š\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eåŸºäºè¡¨å¾(representation-focused)\u003c/li\u003e\n\u003cli\u003eåŸºäºäº¤äº’(interaction-focused)\u003c/li\u003e\n\u003cli\u003eå…¨äº¤äº’ï¼ˆä¹Ÿè¢«ç§°ä½œäº¤å‰ç¼–ç å™¨,ï¼‰(all-to-all interaction(cross encoder) )\u003c/li\u003e\n\u003cli\u003eè¿Ÿäº¤äº’(late interaction)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg alt=\"image\" loading=\"lazy\" src=\"/Neural-IR-Models-2.jpg\"\u003e\u003c/p\u003e\n\u003ch2 id=\"1åŸºäºè¡¨å¾åŒå¡”æ¨¡å‹bi-encoder-models\"\u003e1.åŸºäºè¡¨å¾â€”â€”åŒå¡”æ¨¡å‹(Bi-encoder Models)\u003c/h2\u003e\n\u003cp\u003eåŒå¡”æ¨¡å‹å°†Queryå’ŒDocåˆ†åˆ«è¡¨å¾ä¸ºå¯†é›†çš„å‘é‡åµŒå…¥ï¼Œç”¨å‘é‡ç›¸ä¼¼åº¦åˆ†æ•°æ¥ä¼°è®¡Qå’ŒDçš„ç›¸å…³æ€§ã€‚åœ¨è®­ç»ƒæ—¶\u003cstrong\u003eéœ€è¦æ­£è´Ÿæ ·æœ¬è¿›è¡Œå¯¹æ¯”å­¦ä¹ \u003c/strong\u003eï¼Œå› ä¸ºå¦‚æœåªç»™æ¨¡å‹çœ‹æ­£æ ·æœ¬ï¼Œå®ƒä¼šå·æ‡’â€”â€”æŠŠæ‰€æœ‰å‘é‡éƒ½å˜æˆä¸€æ ·çš„ï¼Œè¿™æ ·â€œç›¸ä¼¼åº¦â€æ°¸è¿œæœ€é«˜ã€‚è´Ÿæ ·æœ¬å¼ºè¿«æ¨¡å‹å­¦ä¼šåŒºåˆ†ç›¸å…³å’Œä¸ç›¸å…³çš„å†…å®¹ã€‚\u003c/p\u003e\n\u003cp\u003eåœ¨å°†æ¨¡å‹è®­ç»ƒå¥½åï¼Œdocå’Œqueryçš„è¡¨å¾å¯ä»¥ç‹¬ç«‹è¿›è¡Œï¼Œä¸ç”¨åƒäº¤å‰ç¼–ç å™¨é‚£æ ·æ¯æ¬¡éƒ½è¦æŠŠQueryå’ŒDocæ‹¼åœ¨ä¸€èµ·é‡æ–°è®¡ç®—ã€‚\u003c/p\u003e\n\u003ch3 id=\"11å¯†é›†æ®µè½æ£€ç´¢å™¨dense-passage-retriever-dpr\"\u003e1.1å¯†é›†æ®µè½æ£€ç´¢å™¨(Dense passage retriever, DPR)\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eè®ºæ–‡ï¼š\u003ca href=\"https://aclanthology.org/2020.emnlp-main.550\"\u003eDense Passage Retrieval for Open-Domain Question Answering\u003c/a\u003e\nEMNLP 2020, Facebook Research\nCode: \u003ca href=\"https://github.com/facebookresearch/DPR\"\u003egithub.com/facebookresearch/DPR\u003c/a\u003e\nè®²è§£åšå®¢ï¼š\u003ca href=\"https://blog.csdn.net/qq_45668004/article/details/138256448\"\u003eã€IR è®ºæ–‡ã€‘DPR â€” æœ€æ—©æå‡ºä½¿ç”¨åµŒå…¥å‘é‡æ¥æ£€ç´¢æ–‡æ¡£çš„æ¨¡å‹_dpræ¨¡å‹-CSDNåšå®¢\u003c/a\u003e\u003c/p\u003e\u003c/blockquote\u003e\n\u003cp\u003eDPRæ˜¯ä¸€ä¸ªåº”ç”¨äºé—®ç­”é¢†åŸŸçš„åŒå¡”æ¨¡å‹ï¼Œæ—¨åœ¨æœ€å¤§é™åº¦åœ°æé«˜æŸ¥è¯¢ä¸ç›¸å…³æ–‡æ¡£çš„ç›¸ä¼¼åº¦ï¼ŒåŒæ—¶æœ€å°åŒ–ä¸éç›¸å…³æ–‡æ¡£çš„ç›¸ä¼¼åº¦ã€‚DPRæ˜¯RAGä¸­Rçš„ç»å…¸æ–¹æ¡ˆã€‚\u003c/p\u003e\n\u003cp\u003eæ­£æ ·æœ¬å¾€å¾€æ•°æ®é›†å·²ç»™å®šï¼Œè€Œè´Ÿæ ·æœ¬æ¯”è¾ƒéš¾é€‰æ‹©ã€‚ä¸ºæ­¤ï¼ŒDPRæå‡ºäº†ä¸€ç§Batchå†…è´Ÿé‡‡æ ·çš„æŠ€æœ¯ï¼Œä»åŒä¸€æ‰¹æ¬¡çš„å…¶ä»–æ ·æœ¬ä¸­é€‰æ‹©æ ·æœ¬ä½œä¸ºè´Ÿæ ·æœ¬ã€‚è¿™ç§æ–¹æ³•æ˜¯æœ‰æ•ˆä¸”é«˜æ•ˆçš„ã€‚\u003c/p\u003e\n\u003ch3 id=\"12æœ€è¿‘é‚»è´Ÿå¯¹æ¯”ä¼°è®¡-approximate-nearest-neighbour-negative-contrastive-estimation-ance\"\u003e1.2æœ€è¿‘é‚»è´Ÿå¯¹æ¯”ä¼°è®¡ (Approximate nearest neighbour Negative Contrastive Estimation, ANCE)\u003c/h3\u003e\n\u003cp\u003eè¯¥è®ºæ–‡è¯æ˜äº†å¼ºè´Ÿæ ·æœ¬èƒ½å¤ŸåŠ é€Ÿæ¨¡å‹æ”¶æ•›ï¼Œæå‡æ¨¡å‹æ€§èƒ½ã€‚è´Ÿæ ·æœ¬åˆ†ä¸ºæ˜“åŒºåˆ«çš„å’Œä¸æ˜“åŒºåˆ«çš„ï¼Œæ˜¾ç„¶ä¸æ˜“åŒºåˆ«ï¼ˆå³å¼ºè´Ÿæ ·æœ¬ï¼‰çš„å¯¹æ¨¡å‹å­¦ä¹ å¸®åŠ©æ›´å¤§ã€‚æœ¬æ–‡ä½¿ç”¨ANNå¯»æ‰¾å¼ºè´Ÿæ ·æœ¬ã€‚\u003c/p\u003e","title":"Neural-IR Modelsï¼ˆåšå®¢ï¼‰"}]